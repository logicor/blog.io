#神经网络续

<p>上周的课程学习了神经网络正向传播算法，这周的课程主要在于神经网络的反向更新过程。</p>



<h2 id="11-cost-function"><a name="t1"></a>1.1 Cost function</h2>

<p>我们先回忆一下逻辑回归的价值函数 <br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><mo stretchy=&quot;false&quot;>[</mo><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>m</mi></mrow></munderover><msup><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>h</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msup><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>&amp;#x2212;</mo><msup><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo stretchy=&quot;false&quot;>)</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>&amp;#x2212;</mo><msub><mi>h</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msup><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>]</mo><mo>+</mo><mfrac><mi>&amp;#x03BB;</mi><mrow><mn>2</mn><mi>m</mi></mrow></mfrac><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow></munderover><msubsup><mi>&amp;#x03B8;</mi><mi>j</mi><mn>2</mn></msubsup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 38.544em; display: inline-block;"><span style="display: inline-block; position: relative; width: 32.083em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.229em, 1032.08em, 2.895em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.078em;"></span></span><span class="mo" id="MathJax-Span-4" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-5" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="mo" id="MathJax-Span-6" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-7" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mfrac" id="MathJax-Span-8" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 0.741em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.383em, 1000.3em, 4.167em, -1000em); top: -4.418em; left: 50%; margin-left: -0.177em;"><span class="mn" id="MathJax-Span-9" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.542em, 1000.61em, 4.174em, -1000em); top: -3.666em; left: 50%; margin-left: -0.31em;"><span class="mi" id="MathJax-Span-10" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1000.74em, 1.198em, -1000em); top: -1.262em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.741em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span><span class="mo" id="MathJax-Span-11" style="font-family: MathJax_Main;">[</span><span class="munderover" id="MathJax-Span-12"><span style="display: inline-block; position: relative; width: 2.279em; height: 0px;"><span style="position: absolute; clip: rect(3.104em, 1001em, 4.417em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-13" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.542em, 1000.7em, 4.174em, -1000em); top: -4.487em; left: 1.056em;"><span class="texatom" id="MathJax-Span-14"><span class="mrow" id="MathJax-Span-15"><span class="mi" id="MathJax-Span-16" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">m</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.383em, 1001.22em, 4.174em, -1000em); top: -3.725em; left: 1.056em;"><span class="texatom" id="MathJax-Span-17"><span class="mrow" id="MathJax-Span-18"><span class="mi" id="MathJax-Span-19" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-20" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-21" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-22" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.417em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.5em, 4.372em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-23" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.548em;"><span class="texatom" id="MathJax-Span-24"><span class="mrow" id="MathJax-Span-25"><span class="mo" id="MathJax-Span-26" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-27" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-28" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mi" id="MathJax-Span-29" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-30" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-31" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-32" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-33"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.56em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-34" style="font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.856em; left: 0.576em;"><span class="mi" id="MathJax-Span-35" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-36" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-37"><span style="display: inline-block; position: relative; width: 1.441em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.52em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-38" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.572em;"><span class="texatom" id="MathJax-Span-39"><span class="mrow" id="MathJax-Span-40"><span class="mo" id="MathJax-Span-41" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-42" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-43" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-44" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-45" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-46" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mo" id="MathJax-Span-47" style="font-family: MathJax_Main; padding-left: 0.222em;">(</span><span class="mn" id="MathJax-Span-48" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-49" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-50" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.417em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.5em, 4.372em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-51" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.548em;"><span class="texatom" id="MathJax-Span-52"><span class="mrow" id="MathJax-Span-53"><span class="mo" id="MathJax-Span-54" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-55" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-56" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-57" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-58" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-59" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-60" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-61" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-62" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-63" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-64" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.56em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-65" style="font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.856em; left: 0.576em;"><span class="mi" id="MathJax-Span-66" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-67" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-68"><span style="display: inline-block; position: relative; width: 1.441em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.52em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-69" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.572em;"><span class="texatom" id="MathJax-Span-70"><span class="mrow" id="MathJax-Span-71"><span class="mo" id="MathJax-Span-72" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-73" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-74" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-75" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-76" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-77" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-78" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mfrac" id="MathJax-Span-79" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.094em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.363em, 1000.39em, 4.175em, -1000em); top: -4.427em; left: 50%; margin-left: -0.206em;"><span class="mi" id="MathJax-Span-80" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">λ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.383em, 1000.96em, 4.174em, -1000em); top: -3.632em; left: 50%; margin-left: -0.487em;"><span class="mrow" id="MathJax-Span-81"><span class="mn" id="MathJax-Span-82" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-83" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">m</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1001.09em, 1.198em, -1000em); top: -1.262em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.094em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span><span class="munderover" id="MathJax-Span-84" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 2.326em; height: 0px;"><span style="position: absolute; clip: rect(3.104em, 1001em, 4.417em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-85" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.542em, 1000.5em, 4.174em, -1000em); top: -4.487em; left: 1.056em;"><span class="texatom" id="MathJax-Span-86"><span class="mrow" id="MathJax-Span-87"><span class="mi" id="MathJax-Span-88" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.383em, 1001.27em, 4.311em, -1000em); top: -3.725em; left: 1.056em;"><span class="texatom" id="MathJax-Span-89"><span class="mrow" id="MathJax-Span-90"><span class="mi" id="MathJax-Span-91" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span class="mo" id="MathJax-Span-92" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-93" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-94" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.898em; height: 0px;"><span style="position: absolute; clip: rect(3.149em, 1000.46em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-95" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.383em, 1000.43em, 4.167em, -1000em); top: -4.355em; left: 0.469em;"><span class="mn" id="MathJax-Span-96" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.387em, 1000.37em, 4.311em, -1000em); top: -3.707em; left: 0.469em;"><span class="mi" id="MathJax-Span-97" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.599em; border-left: 0px solid; width: 0px; height: 1.75em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>J</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><mo stretchy="false">[</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>m</mi></mrow></munderover><msup><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msup><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo>+</mo><mfrac><mi>λ</mi><mrow><mn>2</mn><mi>m</mi></mrow></mfrac><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>n</mi></mrow></munderover><msubsup><mi>θ</mi><mi>j</mi><mn>2</mn></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-1">J(\theta) = \frac{1}{m}[\sum_{i=1}^{m}y^{(i)}log(h_\theta(x^{(i)})) + (1-y^{(i)})log(1-h_\theta(x^{(i)}))] + \frac{\lambda}{2m}\sum_{j=1}^{n}\theta_j^2</script></p>

<p>在神经网络中 <br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>h</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mi>&amp;#x03F5;</mi><msup><mi>R</mi><mi>K</mi></msup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-98" style="width: 5.107em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.219em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.29em, 1004.22em, 2.698em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-99"><span class="msubsup" id="MathJax-Span-100"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.56em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-101" style="font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.856em; left: 0.576em;"><span class="mi" id="MathJax-Span-102" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-103" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-104" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-105" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-106" style="font-family: MathJax_Math; font-style: italic;">ϵ</span><span class="msubsup" id="MathJax-Span-107"><span style="display: inline-block; position: relative; width: 1.463em; height: 0px;"><span style="position: absolute; clip: rect(3.171em, 1000.76em, 4.188em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-108" style="font-family: MathJax_Math; font-style: italic;">R</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.759em;"><span class="mi" id="MathJax-Span-109" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.362em; border-left: 0px solid; width: 0px; height: 1.44em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mi>ϵ</mi><msup><mi>R</mi><mi>K</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-2">h_\theta(x)\epsilon R^K</script> 　　　 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><msub><mi>h</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><msub><mo stretchy=&quot;false&quot;>)</mo><mi>i</mi></msub><mo>=</mo><msup><mi>i</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mi>h</mi></mrow></msup><mi>o</mi><mi>u</mi><mi>t</mi><mi>p</mi><mi>u</mi><mi>t</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-110" style="width: 10.471em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.698em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.282em, 1008.67em, 2.698em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-111"><span class="mo" id="MathJax-Span-112" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-113"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.56em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-114" style="font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.856em; left: 0.576em;"><span class="mi" id="MathJax-Span-115" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-116" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-117" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-118" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-119"><span style="display: inline-block; position: relative; width: 0.708em; height: 0px;"><span style="position: absolute; clip: rect(3.104em, 1000.29em, 4.417em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-120" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.389em;"><span class="mi" id="MathJax-Span-121" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-122" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-123" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.083em; height: 0px;"><span style="position: absolute; clip: rect(3.193em, 1000.3em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-124" style="font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.345em;"><span class="texatom" id="MathJax-Span-125"><span class="mrow" id="MathJax-Span-126"><span class="mi" id="MathJax-Span-127" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mi" id="MathJax-Span-128" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mi" id="MathJax-Span-129" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-130" style="font-family: MathJax_Math; font-style: italic;">u</span><span class="mi" id="MathJax-Span-131" style="font-family: MathJax_Math; font-style: italic;">t</span><span class="mi" id="MathJax-Span-132" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mi" id="MathJax-Span-133" style="font-family: MathJax_Math; font-style: italic;">u</span><span class="mi" id="MathJax-Span-134" style="font-family: MathJax_Math; font-style: italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.362em; border-left: 0px solid; width: 0px; height: 1.449em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><msub><mo stretchy="false">)</mo><mi>i</mi></msub><mo>=</mo><msup><mi>i</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mi>h</mi></mrow></msup><mi>o</mi><mi>u</mi><mi>t</mi><mi>p</mi><mi>u</mi><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-3">(h_\theta(x))_i = i^{th}output</script> <br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mo>&amp;#x2212;</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><mo stretchy=&quot;false&quot;>[</mo><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>m</mi></mrow></munderover><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>K</mi></mrow></munderover><msubsup><mi>y</mi><mi>k</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>h</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msubsup><mi>x</mi><mi>k</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>&amp;#x2212;</mo><msubsup><mi>y</mi><mi>k</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup><mo stretchy=&quot;false&quot;>)</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>&amp;#x2212;</mo><msub><mi>h</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msubsup><mi>x</mi><mi>k</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>]</mo><mo>+</mo><mfrac><mi>&amp;#x03BB;</mi><mrow><mn>2</mn><mi>m</mi></mrow></mfrac><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>l</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>L</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></munderover><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>s</mi><mi>l</mi></msub></mrow></munderover><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>l</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow></munderover><mo stretchy=&quot;false&quot;>(</mo><msubsup><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi><mi>i</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>l</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup><msup><mo stretchy=&quot;false&quot;>)</mo><mn>2</mn></msup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-135" style="width: 44.378em; display: inline-block;"><span style="display: inline-block; position: relative; width: 36.993em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(3.167em, 1036.99em, 6.85em, -1000em); top: -4.375em; left: 0em;"><span class="mrow" id="MathJax-Span-136"><span style="display: inline-block; position: relative; width: 36.993em; height: 0px;"><span style="position: absolute; clip: rect(2.803em, 1036.99em, 4.553em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-137" style="font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.078em;"></span></span><span class="mo" id="MathJax-Span-138" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-139" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="mo" id="MathJax-Span-140" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-141" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-142" style="font-family: MathJax_Main; padding-left: 0.278em;">−</span><span class="mfrac" id="MathJax-Span-143"><span style="display: inline-block; position: relative; width: 0.741em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.383em, 1000.3em, 4.167em, -1000em); top: -4.418em; left: 50%; margin-left: -0.177em;"><span class="mn" id="MathJax-Span-144" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.542em, 1000.61em, 4.174em, -1000em); top: -3.666em; left: 50%; margin-left: -0.31em;"><span class="mi" id="MathJax-Span-145" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1000.74em, 1.198em, -1000em); top: -1.262em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.741em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span><span class="mo" id="MathJax-Span-146" style="font-family: MathJax_Main;">[</span><span class="munderover" id="MathJax-Span-147"><span style="display: inline-block; position: relative; width: 2.279em; height: 0px;"><span style="position: absolute; clip: rect(3.104em, 1001em, 4.417em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-148" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.542em, 1000.7em, 4.174em, -1000em); top: -4.487em; left: 1.056em;"><span class="texatom" id="MathJax-Span-149"><span class="mrow" id="MathJax-Span-150"><span class="mi" id="MathJax-Span-151" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">m</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.383em, 1001.22em, 4.174em, -1000em); top: -3.725em; left: 1.056em;"><span class="texatom" id="MathJax-Span-152"><span class="mrow" id="MathJax-Span-153"><span class="mi" id="MathJax-Span-154" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-155" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-156" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="munderover" id="MathJax-Span-157" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 2.403em; height: 0px;"><span style="position: absolute; clip: rect(3.104em, 1001em, 4.417em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-158" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.371em, 1000.7em, 4.167em, -1000em); top: -4.487em; left: 1.056em;"><span class="texatom" id="MathJax-Span-159"><span class="mrow" id="MathJax-Span-160"><span class="mi" id="MathJax-Span-161" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.363em, 1001.35em, 4.174em, -1000em); top: -3.725em; left: 1.056em;"><span class="texatom" id="MathJax-Span-162"><span class="mrow" id="MathJax-Span-163"><span class="mi" id="MathJax-Span-164" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span class="mo" id="MathJax-Span-165" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-166" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-167" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.417em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.5em, 4.372em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-168" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.324em, 1000.87em, 4.343em, -1000em); top: -4.532em; left: 0.548em;"><span class="texatom" id="MathJax-Span-169"><span class="mrow" id="MathJax-Span-170"><span class="mo" id="MathJax-Span-171" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-172" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-173" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.363em, 1000.44em, 4.174em, -1000em); top: -3.684em; left: 0.49em;"><span class="mi" id="MathJax-Span-174" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mi" id="MathJax-Span-175" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-176" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-177" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-178" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-179"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.56em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-180" style="font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.856em; left: 0.576em;"><span class="mi" id="MathJax-Span-181" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-182" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-183"><span style="display: inline-block; position: relative; width: 1.441em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.52em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-184" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.324em, 1000.87em, 4.343em, -1000em); top: -4.532em; left: 0.572em;"><span class="texatom" id="MathJax-Span-185"><span class="mrow" id="MathJax-Span-186"><span class="mo" id="MathJax-Span-187" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-188" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-189" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.363em, 1000.44em, 4.174em, -1000em); top: -3.684em; left: 0.572em;"><span class="mi" id="MathJax-Span-190" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-191" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-192" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-193" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mo" id="MathJax-Span-194" style="font-family: MathJax_Main; padding-left: 0.222em;">(</span><span class="mn" id="MathJax-Span-195" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-196" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-197" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.417em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.5em, 4.372em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-198" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.324em, 1000.87em, 4.343em, -1000em); top: -4.532em; left: 0.548em;"><span class="texatom" id="MathJax-Span-199"><span class="mrow" id="MathJax-Span-200"><span class="mo" id="MathJax-Span-201" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-202" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-203" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.363em, 1000.44em, 4.174em, -1000em); top: -3.684em; left: 0.49em;"><span class="mi" id="MathJax-Span-204" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-205" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-206" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-207" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-208" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-209" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-210" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-211" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-212" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.56em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-213" style="font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.856em; left: 0.576em;"><span class="mi" id="MathJax-Span-214" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-215" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-216"><span style="display: inline-block; position: relative; width: 1.441em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.52em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-217" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.324em, 1000.87em, 4.343em, -1000em); top: -4.532em; left: 0.572em;"><span class="texatom" id="MathJax-Span-218"><span class="mrow" id="MathJax-Span-219"><span class="mo" id="MathJax-Span-220" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-221" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-222" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.363em, 1000.44em, 4.174em, -1000em); top: -3.684em; left: 0.572em;"><span class="mi" id="MathJax-Span-223" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-224" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-225" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-226" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-227" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mfrac" id="MathJax-Span-228" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.094em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.363em, 1000.39em, 4.175em, -1000em); top: -4.427em; left: 50%; margin-left: -0.206em;"><span class="mi" id="MathJax-Span-229" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">λ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.383em, 1000.96em, 4.174em, -1000em); top: -3.632em; left: 50%; margin-left: -0.487em;"><span class="mrow" id="MathJax-Span-230"><span class="mn" id="MathJax-Span-231" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-232" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">m</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1001.09em, 1.198em, -1000em); top: -1.262em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.094em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span><span class="munderover" id="MathJax-Span-233" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 2.516em; height: 0px;"><span style="position: absolute; clip: rect(3.104em, 1001em, 4.417em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-234" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.371em, 1001.46em, 4.225em, -1000em); top: -4.487em; left: 1.056em;"><span class="texatom" id="MathJax-Span-235"><span class="mrow" id="MathJax-Span-236"><span class="mi" id="MathJax-Span-237" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">L</span><span class="mo" id="MathJax-Span-238" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-239" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.363em, 1001.19em, 4.174em, -1000em); top: -3.725em; left: 1.056em;"><span class="texatom" id="MathJax-Span-240"><span class="mrow" id="MathJax-Span-241"><span class="mi" id="MathJax-Span-242" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">l</span><span class="mo" id="MathJax-Span-243" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-244" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="munderover" id="MathJax-Span-245" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 2.279em; height: 0px;"><span style="position: absolute; clip: rect(3.104em, 1001em, 4.417em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-246" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.542em, 1000.61em, 4.278em, -1000em); top: -4.487em; left: 1.056em;"><span class="texatom" id="MathJax-Span-247"><span class="mrow" id="MathJax-Span-248"><span class="msubsup" id="MathJax-Span-249"><span style="display: inline-block; position: relative; width: 0.534em; height: 0px;"><span style="position: absolute; clip: rect(3.542em, 1000.3em, 4.174em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-250" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.904em; left: 0.332em;"><span class="mi" id="MathJax-Span-251" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">l</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.383em, 1001.22em, 4.174em, -1000em); top: -3.725em; left: 1.056em;"><span class="texatom" id="MathJax-Span-252"><span class="mrow" id="MathJax-Span-253"><span class="mi" id="MathJax-Span-254" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-255" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-256" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(2.803em, 1004.84em, 4.617em, -1000em); top: -2.142em; left: 0em;"><span class="munderover" id="MathJax-Span-257" style=""><span style="display: inline-block; position: relative; width: 2.326em; height: 0px;"><span style="position: absolute; clip: rect(3.104em, 1001em, 4.417em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-258" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.542em, 1001.25em, 4.314em, -1000em); top: -4.502em; left: 1.056em;"><span class="texatom" id="MathJax-Span-259"><span class="mrow" id="MathJax-Span-260"><span class="msubsup" id="MathJax-Span-261"><span style="display: inline-block; position: relative; width: 1.173em; height: 0px;"><span style="position: absolute; clip: rect(3.542em, 1000.3em, 4.174em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-262" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.904em; left: 0.332em;"><span class="texatom" id="MathJax-Span-263"><span class="mrow" id="MathJax-Span-264"><span class="mi" id="MathJax-Span-265" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">l</span><span class="mo" id="MathJax-Span-266" style="font-size: 50%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-267" style="font-size: 50%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.383em, 1001.27em, 4.311em, -1000em); top: -3.704em; left: 1.056em;"><span class="texatom" id="MathJax-Span-268"><span class="mrow" id="MathJax-Span-269"><span class="mi" id="MathJax-Span-270" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span class="mo" id="MathJax-Span-271" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-272" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-273" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-274"><span style="display: inline-block; position: relative; width: 1.305em; height: 0px;"><span style="position: absolute; clip: rect(3.149em, 1000.46em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-275" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.324em, 1000.84em, 4.343em, -1000em); top: -4.532em; left: 0.469em;"><span class="texatom" id="MathJax-Span-276"><span class="mrow" id="MathJax-Span-277"><span class="mo" id="MathJax-Span-278" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-279" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">l</span><span class="mo" id="MathJax-Span-280" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.387em, 1000.61em, 4.311em, -1000em); top: -3.707em; left: 0.469em;"><span class="texatom" id="MathJax-Span-281"><span class="mrow" id="MathJax-Span-282"><span class="mi" id="MathJax-Span-283" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span class="mi" id="MathJax-Span-284" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-285"><span style="display: inline-block; position: relative; width: 0.818em; height: 0px;"><span style="position: absolute; clip: rect(3.104em, 1000.29em, 4.417em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-286" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.389em;"><span class="mn" id="MathJax-Span-287" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.375em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.846em; border-left: 0px solid; width: 0px; height: 4.17em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>J</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><mo stretchy="false">[</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>m</mi></mrow></munderover><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>K</mi></mrow></munderover><msubsup><mi>y</mi><mi>k</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msubsup><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msubsup><mi>x</mi><mi>k</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msubsup><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msubsup><mi>y</mi><mi>k</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msubsup><mo stretchy="false">)</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msubsup><mi>x</mi><mi>k</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msubsup><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo>+</mo><mfrac><mi>λ</mi><mrow><mn>2</mn><mi>m</mi></mrow></mfrac><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>l</mi><mo>=</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>L</mi><mo>−</mo><mn>1</mn></mrow></munderover><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>s</mi><mi>l</mi></msub></mrow></munderover><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>l</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow></munderover><mo stretchy="false">(</mo><msubsup><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mi>i</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>l</mi><mo stretchy="false">)</mo></mrow></msubsup><msup><mo stretchy="false">)</mo><mn>2</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-4">J(\theta) = -\frac{1}{m}[\sum_{i=1}^{m}\sum_{k=1}^{K}y^{(i)}_klog(h_\theta(x^{(i)}_k)) + (1-y_k^{(i)})log(1 - h_\theta(x_k^{(i)}))] + \frac{\lambda}{2m}\sum_{l=1}^{L-1}\sum_{i=1}^{s_l}\sum_{j=1}^{s_{l+1}}(\theta_{ji}^{(l)})^2</script> </p>



<h2 id="12-backpropagation-algorithm"><a name="t2"></a>1.2 Backpropagation algorithm</h2>

<p>使用梯度下降法求解价值函数<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3108-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-288" style="width: 2.294em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.875em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.385em, 1001.78em, 2.698em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-289"><span class="mi" id="MathJax-Span-290" style="font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.078em;"></span></span><span class="mo" id="MathJax-Span-291" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-292" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="mo" id="MathJax-Span-293" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.362em; border-left: 0px solid; width: 0px; height: 1.325em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>J</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-3108">J(\theta)</script>的最小值 <br>
我们需要知道<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3109-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mfrac><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><msubsup><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mi>j</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>l</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup></mrow></mfrac><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-294" style="width: 4.273em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.542em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.207em, 1003.45em, 3.415em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-295"><span class="mfrac" id="MathJax-Span-296"><span style="display: inline-block; position: relative; width: 1.443em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.349em, 1000.4em, 4.182em, -1000em); top: -4.434em; left: 50%; margin-left: -0.2em;"><span class="mi" id="MathJax-Span-297" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.111em, 1001.32em, 4.483em, -1000em); top: -3.359em; left: 50%; margin-left: -0.661em;"><span class="mrow" id="MathJax-Span-298"><span class="mi" id="MathJax-Span-299" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span class="msubsup" id="MathJax-Span-300"><span style="display: inline-block; position: relative; width: 0.923em; height: 0px;"><span style="position: absolute; clip: rect(3.356em, 1000.33em, 4.174em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-301" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.479em, 1000.59em, 4.292em, -1000em); top: -4.379em; left: 0.332em;"><span class="texatom" id="MathJax-Span-302"><span class="mrow" id="MathJax-Span-303"><span class="mo" id="MathJax-Span-304" style="font-size: 50%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-305" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">l</span><span class="mo" id="MathJax-Span-306" style="font-size: 50%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.524em, 1000.43em, 4.269em, -1000em); top: -3.796em; left: 0.332em;"><span class="texatom" id="MathJax-Span-307"><span class="mrow" id="MathJax-Span-308"><span class="mi" id="MathJax-Span-309" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-310" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1001.44em, 1.198em, -1000em); top: -1.262em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.443em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span><span class="mi" id="MathJax-Span-311" style="font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.078em;"></span></span><span class="mo" id="MathJax-Span-312" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-313" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="mo" id="MathJax-Span-314" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.223em; border-left: 0px solid; width: 0px; height: 2.4em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msubsup><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>l</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow></mfrac><mi>J</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-3109">\frac{\partial }{\partial \theta^{(l)}_{ij}}J(\theta)</script></p>

<p>先给出一个样本(x, y)时的正向传播过程 <br>
<img src="https://img-blog.csdn.net/20170513162511304?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjcwMDgwNzk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述" title=""> <br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3110-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>=</mo><mi>x</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-315" style="width: 4.169em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.438em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.242em, 1003.39em, 2.459em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-316"><span class="msubsup" id="MathJax-Span-317"><span style="display: inline-block; position: relative; width: 1.508em; height: 0px;"><span style="position: absolute; clip: rect(3.413em, 1000.51em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-318" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.529em;"><span class="texatom" id="MathJax-Span-319"><span class="mrow" id="MathJax-Span-320"><span class="mo" id="MathJax-Span-321" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-322" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-323" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-324" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-325" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">x</span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 1.21em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-3110">a^{(1)} = x</script>　　<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3111-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mi>d</mi><mi>d</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x3000;</mo></mrow><msubsup><mi>a</mi><mn>0</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-326" style="width: 5.628em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.688em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.084em, 1004.59em, 2.77em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-327"><span class="mo" id="MathJax-Span-328" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-329" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-330" style="font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-331" style="font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-332"><span class="mrow" id="MathJax-Span-333"><span class="mo" id="MathJax-Span-334"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">　</span></span></span></span><span class="msubsup" id="MathJax-Span-335"><span style="display: inline-block; position: relative; width: 1.508em; height: 0px;"><span style="position: absolute; clip: rect(3.413em, 1000.51em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-336" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.324em, 1000.98em, 4.343em, -1000em); top: -4.532em; left: 0.529em;"><span class="texatom" id="MathJax-Span-337"><span class="mrow" id="MathJax-Span-338"><span class="mo" id="MathJax-Span-339" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-340" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-341" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.383em, 1000.43em, 4.182em, -1000em); top: -3.704em; left: 0.529em;"><span class="mn" id="MathJax-Span-342" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-343" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.449em; border-left: 0px solid; width: 0px; height: 1.773em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>a</mi><mi>d</mi><mi>d</mi><mrow class="MJX-TeXAtom-ORD"><mo>　</mo></mrow><msubsup><mi>a</mi><mn>0</mn><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msubsup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-3111">(add　a_0^{(1)})</script> <br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3112-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>2</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>=</mo><msup><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><msup><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-344" style="width: 6.982em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.781em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.19em, 1005.78em, 2.407em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-345"><span class="msubsup" id="MathJax-Span-346"><span style="display: inline-block; position: relative; width: 1.498em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.47em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-347" style="font-family: MathJax_Math; font-style: italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.519em;"><span class="texatom" id="MathJax-Span-348"><span class="mrow" id="MathJax-Span-349"><span class="mo" id="MathJax-Span-350" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-351" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-352" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-353" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-354" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.448em; height: 0px;"><span style="position: absolute; clip: rect(3.149em, 1000.46em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-355" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.469em;"><span class="texatom" id="MathJax-Span-356"><span class="mrow" id="MathJax-Span-357"><span class="mo" id="MathJax-Span-358" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-359" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-360" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-361"><span style="display: inline-block; position: relative; width: 1.508em; height: 0px;"><span style="position: absolute; clip: rect(3.413em, 1000.51em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-362" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.529em;"><span class="texatom" id="MathJax-Span-363"><span class="mrow" id="MathJax-Span-364"><span class="mo" id="MathJax-Span-365" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-366" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-367" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 1.21em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><msup><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-3112">z^{(2)} = \theta^{(1)}a^{(1)}</script> <br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3113-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>2</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>=</mo><mi>g</mi><mo stretchy=&quot;false&quot;>(</mo><msup><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>2</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-368" style="width: 6.721em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.573em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.242em, 1005.48em, 2.698em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-369"><span class="msubsup" id="MathJax-Span-370"><span style="display: inline-block; position: relative; width: 1.508em; height: 0px;"><span style="position: absolute; clip: rect(3.413em, 1000.51em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-371" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.529em;"><span class="texatom" id="MathJax-Span-372"><span class="mrow" id="MathJax-Span-373"><span class="mo" id="MathJax-Span-374" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-375" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-376" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-377" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-378" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-379" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-380"><span style="display: inline-block; position: relative; width: 1.498em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.47em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-381" style="font-family: MathJax_Math; font-style: italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.519em;"><span class="texatom" id="MathJax-Span-382"><span class="mrow" id="MathJax-Span-383"><span class="mo" id="MathJax-Span-384" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-385" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-386" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-387" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.362em; border-left: 0px solid; width: 0px; height: 1.497em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><mi>g</mi><mo stretchy="false">(</mo><msup><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-3113">a^{(2)} = g(z^{(2)})</script>　　<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3114-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mi>d</mi><mi>d</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x3000;</mo></mrow><msubsup><mi>a</mi><mn>0</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>2</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-388" style="width: 5.628em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.688em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.084em, 1004.59em, 2.77em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-389"><span class="mo" id="MathJax-Span-390" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-391" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-392" style="font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-393" style="font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-394"><span class="mrow" id="MathJax-Span-395"><span class="mo" id="MathJax-Span-396"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">　</span></span></span></span><span class="msubsup" id="MathJax-Span-397"><span style="display: inline-block; position: relative; width: 1.508em; height: 0px;"><span style="position: absolute; clip: rect(3.413em, 1000.51em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-398" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.324em, 1000.98em, 4.343em, -1000em); top: -4.532em; left: 0.529em;"><span class="texatom" id="MathJax-Span-399"><span class="mrow" id="MathJax-Span-400"><span class="mo" id="MathJax-Span-401" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-402" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-403" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.383em, 1000.43em, 4.182em, -1000em); top: -3.704em; left: 0.529em;"><span class="mn" id="MathJax-Span-404" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-405" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.449em; border-left: 0px solid; width: 0px; height: 1.773em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>a</mi><mi>d</mi><mi>d</mi><mrow class="MJX-TeXAtom-ORD"><mo>　</mo></mrow><msubsup><mi>a</mi><mn>0</mn><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msubsup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-3114">(add　a_0^{(2)})</script> <br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3115-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>3</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>=</mo><msup><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>2</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><msup><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>2</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-406" style="width: 6.982em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.781em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.19em, 1005.78em, 2.407em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-407"><span class="msubsup" id="MathJax-Span-408"><span style="display: inline-block; position: relative; width: 1.498em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.47em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-409" style="font-family: MathJax_Math; font-style: italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.519em;"><span class="texatom" id="MathJax-Span-410"><span class="mrow" id="MathJax-Span-411"><span class="mo" id="MathJax-Span-412" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-413" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span class="mo" id="MathJax-Span-414" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-415" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-416" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.448em; height: 0px;"><span style="position: absolute; clip: rect(3.149em, 1000.46em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-417" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.469em;"><span class="texatom" id="MathJax-Span-418"><span class="mrow" id="MathJax-Span-419"><span class="mo" id="MathJax-Span-420" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-421" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-422" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-423"><span style="display: inline-block; position: relative; width: 1.508em; height: 0px;"><span style="position: absolute; clip: rect(3.413em, 1000.51em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-424" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.529em;"><span class="texatom" id="MathJax-Span-425"><span class="mrow" id="MathJax-Span-426"><span class="mo" id="MathJax-Span-427" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-428" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-429" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 1.21em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>3</mn><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><msup><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msup><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-3115">z^{(3)} = \theta^{(2)}a^{(2)}</script> <br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3116-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>3</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>=</mo><mi>g</mi><mo stretchy=&quot;false&quot;>(</mo><msup><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>3</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-430" style="width: 6.721em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.573em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.242em, 1005.48em, 2.698em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-431"><span class="msubsup" id="MathJax-Span-432"><span style="display: inline-block; position: relative; width: 1.508em; height: 0px;"><span style="position: absolute; clip: rect(3.413em, 1000.51em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-433" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.529em;"><span class="texatom" id="MathJax-Span-434"><span class="mrow" id="MathJax-Span-435"><span class="mo" id="MathJax-Span-436" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-437" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span class="mo" id="MathJax-Span-438" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-439" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-440" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-441" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-442"><span style="display: inline-block; position: relative; width: 1.498em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.47em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-443" style="font-family: MathJax_Math; font-style: italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.519em;"><span class="texatom" id="MathJax-Span-444"><span class="mrow" id="MathJax-Span-445"><span class="mo" id="MathJax-Span-446" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-447" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span class="mo" id="MathJax-Span-448" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-449" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.362em; border-left: 0px solid; width: 0px; height: 1.497em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>3</mn><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><mi>g</mi><mo stretchy="false">(</mo><msup><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>3</mn><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-3116">a^{(3)} = g(z^{(3)})</script>　　<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3117-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mi>d</mi><mi>d</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x3000;</mo></mrow><msubsup><mi>a</mi><mn>0</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>3</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-450" style="width: 5.628em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.688em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.084em, 1004.59em, 2.77em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-451"><span class="mo" id="MathJax-Span-452" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-453" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-454" style="font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-455" style="font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-456"><span class="mrow" id="MathJax-Span-457"><span class="mo" id="MathJax-Span-458"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">　</span></span></span></span><span class="msubsup" id="MathJax-Span-459"><span style="display: inline-block; position: relative; width: 1.508em; height: 0px;"><span style="position: absolute; clip: rect(3.413em, 1000.51em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-460" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.324em, 1000.98em, 4.343em, -1000em); top: -4.532em; left: 0.529em;"><span class="texatom" id="MathJax-Span-461"><span class="mrow" id="MathJax-Span-462"><span class="mo" id="MathJax-Span-463" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-464" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span class="mo" id="MathJax-Span-465" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.383em, 1000.43em, 4.182em, -1000em); top: -3.704em; left: 0.529em;"><span class="mn" id="MathJax-Span-466" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-467" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.449em; border-left: 0px solid; width: 0px; height: 1.773em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>a</mi><mi>d</mi><mi>d</mi><mrow class="MJX-TeXAtom-ORD"><mo>　</mo></mrow><msubsup><mi>a</mi><mn>0</mn><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>3</mn><mo stretchy="false">)</mo></mrow></msubsup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-3117">(add　a_0^{(3)})</script> <br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3118-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>4</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>=</mo><msup><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>3</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><msup><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>3</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-468" style="width: 6.982em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.781em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.19em, 1005.78em, 2.407em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-469"><span class="msubsup" id="MathJax-Span-470"><span style="display: inline-block; position: relative; width: 1.498em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.47em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-471" style="font-family: MathJax_Math; font-style: italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.519em;"><span class="texatom" id="MathJax-Span-472"><span class="mrow" id="MathJax-Span-473"><span class="mo" id="MathJax-Span-474" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-475" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span class="mo" id="MathJax-Span-476" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-477" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-478" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.448em; height: 0px;"><span style="position: absolute; clip: rect(3.149em, 1000.46em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-479" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.469em;"><span class="texatom" id="MathJax-Span-480"><span class="mrow" id="MathJax-Span-481"><span class="mo" id="MathJax-Span-482" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-483" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span class="mo" id="MathJax-Span-484" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-485"><span style="display: inline-block; position: relative; width: 1.508em; height: 0px;"><span style="position: absolute; clip: rect(3.413em, 1000.51em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-486" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.529em;"><span class="texatom" id="MathJax-Span-487"><span class="mrow" id="MathJax-Span-488"><span class="mo" id="MathJax-Span-489" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-490" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span class="mo" id="MathJax-Span-491" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 1.21em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>4</mn><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><msup><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>3</mn><mo stretchy="false">)</mo></mrow></msup><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>3</mn><mo stretchy="false">)</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-3118">z^{(4)} = \theta^{(3)}a^{(3)}</script> <br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3119-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>4</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>=</mo><msub><mi>h</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>g</mi><mo stretchy=&quot;false&quot;>(</mo><msup><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>4</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-492" style="width: 11.148em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.271em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.242em, 1009.18em, 2.698em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-493"><span class="msubsup" id="MathJax-Span-494"><span style="display: inline-block; position: relative; width: 1.508em; height: 0px;"><span style="position: absolute; clip: rect(3.413em, 1000.51em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-495" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.529em;"><span class="texatom" id="MathJax-Span-496"><span class="mrow" id="MathJax-Span-497"><span class="mo" id="MathJax-Span-498" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-499" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span class="mo" id="MathJax-Span-500" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-501" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-502" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.56em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-503" style="font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.856em; left: 0.576em;"><span class="mi" id="MathJax-Span-504" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-505" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-506" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-507" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-508" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-509" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-510" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-511"><span style="display: inline-block; position: relative; width: 1.498em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.47em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-512" style="font-family: MathJax_Math; font-style: italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.519em;"><span class="texatom" id="MathJax-Span-513"><span class="mrow" id="MathJax-Span-514"><span class="mo" id="MathJax-Span-515" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-516" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span class="mo" id="MathJax-Span-517" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-518" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.362em; border-left: 0px solid; width: 0px; height: 1.497em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>4</mn><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>g</mi><mo stretchy="false">(</mo><msup><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>4</mn><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-3119">a^{(4)} = h_\theta(x) = g(z^{(4)})</script></p>

<p>设置<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3120-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi>&amp;#x03B4;</mi><mi>j</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>l</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-519" style="width: 1.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.354em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.98em, 1001.35em, 2.791em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-520"><span class="msubsup" id="MathJax-Span-521"><span style="display: inline-block; position: relative; width: 1.339em; height: 0px;"><span style="position: absolute; clip: rect(3.137em, 1000.45em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-522" style="font-family: MathJax_Math; font-style: italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.324em, 1000.84em, 4.343em, -1000em); top: -4.532em; left: 0.503em;"><span class="texatom" id="MathJax-Span-523"><span class="mrow" id="MathJax-Span-524"><span class="mo" id="MathJax-Span-525" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-526" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">l</span><span class="mo" id="MathJax-Span-527" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.387em, 1000.37em, 4.311em, -1000em); top: -3.707em; left: 0.444em;"><span class="mi" id="MathJax-Span-528" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.599em; border-left: 0px solid; width: 0px; height: 1.924em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>δ</mi><mi>j</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>l</mi><mo stretchy="false">)</mo></mrow></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-3120">\delta^{(l)}_j</script>为第l层j节点的误差 <br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3121-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>&amp;#x03B4;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>4</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>=</mo><msup><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>4</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>&amp;#x2212;</mo><mi>y</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-529" style="width: 7.294em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.042em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.242em, 1006.04em, 2.653em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-530"><span class="msubsup" id="MathJax-Span-531"><span style="display: inline-block; position: relative; width: 1.482em; height: 0px;"><span style="position: absolute; clip: rect(3.137em, 1000.45em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-532" style="font-family: MathJax_Math; font-style: italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.503em;"><span class="texatom" id="MathJax-Span-533"><span class="mrow" id="MathJax-Span-534"><span class="mo" id="MathJax-Span-535" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-536" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span class="mo" id="MathJax-Span-537" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-538" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-539" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.508em; height: 0px;"><span style="position: absolute; clip: rect(3.413em, 1000.51em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-540" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.529em;"><span class="texatom" id="MathJax-Span-541"><span class="mrow" id="MathJax-Span-542"><span class="mo" id="MathJax-Span-543" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-544" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span class="mo" id="MathJax-Span-545" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-546" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-547" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.308em; border-left: 0px solid; width: 0px; height: 1.443em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>δ</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>4</mn><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>4</mn><mo stretchy="false">)</mo></mrow></msup><mo>−</mo><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-3121">\delta^{(4)} = a^{(4)} - y</script> <br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3122-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>&amp;#x03B4;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>3</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><msup><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>3</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><msup><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>T</mi></mrow></msup><msup><mi>&amp;#x03B4;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>4</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>.</mo><mo>&amp;#x2217;</mo><msup><mi>g</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi></mi><mo>&amp;#x2032;</mo></msup></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><msup><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>3</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-548" style="width: 13.336em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.094em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.184em, 1011em, 2.646em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-549"><span class="msubsup" id="MathJax-Span-550"><span style="display: inline-block; position: relative; width: 1.482em; height: 0px;"><span style="position: absolute; clip: rect(3.137em, 1000.45em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-551" style="font-family: MathJax_Math; font-style: italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.503em;"><span class="texatom" id="MathJax-Span-552"><span class="mrow" id="MathJax-Span-553"><span class="mo" id="MathJax-Span-554" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-555" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span class="mo" id="MathJax-Span-556" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-557" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-558" style="font-family: MathJax_Main; padding-left: 0.278em;">(</span><span class="msubsup" id="MathJax-Span-559"><span style="display: inline-block; position: relative; width: 1.448em; height: 0px;"><span style="position: absolute; clip: rect(3.149em, 1000.46em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-560" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.469em;"><span class="texatom" id="MathJax-Span-561"><span class="mrow" id="MathJax-Span-562"><span class="mo" id="MathJax-Span-563" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-564" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span class="mo" id="MathJax-Span-565" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-566"><span style="display: inline-block; position: relative; width: 0.962em; height: 0px;"><span style="position: absolute; clip: rect(3.104em, 1000.29em, 4.417em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-567" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.389em;"><span class="texatom" id="MathJax-Span-568"><span class="mrow" id="MathJax-Span-569"><span class="mi" id="MathJax-Span-570" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-571"><span style="display: inline-block; position: relative; width: 1.482em; height: 0px;"><span style="position: absolute; clip: rect(3.137em, 1000.45em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-572" style="font-family: MathJax_Math; font-style: italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.503em;"><span class="texatom" id="MathJax-Span-573"><span class="mrow" id="MathJax-Span-574"><span class="mo" id="MathJax-Span-575" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-576" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span class="mo" id="MathJax-Span-577" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-578" style="font-family: MathJax_Main;">.</span><span class="mo" id="MathJax-Span-579" style="font-family: MathJax_Main; padding-left: 0.167em;">∗</span><span class="msubsup" id="MathJax-Span-580"><span style="display: inline-block; position: relative; width: 0.796em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.48em, 4.372em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-581" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.531em;"><span class="texatom" id="MathJax-Span-582"><span class="mrow" id="MathJax-Span-583"><span class="msup" id="MathJax-Span-584"><span style="display: inline-block; position: relative; width: 0.191em; height: 0px;"><span style="position: absolute; clip: rect(3.854em, 1000em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-585" style="font-size: 70.7%;"></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.267em; left: 0em;"><span class="mo" id="MathJax-Span-586" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-587" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-588"><span style="display: inline-block; position: relative; width: 1.498em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.47em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-589" style="font-family: MathJax_Math; font-style: italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.519em;"><span class="texatom" id="MathJax-Span-590"><span class="mrow" id="MathJax-Span-591"><span class="mo" id="MathJax-Span-592" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-593" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span class="mo" id="MathJax-Span-594" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-595" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.362em; border-left: 0px solid; width: 0px; height: 1.504em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>δ</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>3</mn><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><mo stretchy="false">(</mo><msup><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>3</mn><mo stretchy="false">)</mo></mrow></msup><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mi>T</mi></mrow></msup><msup><mi>δ</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>4</mn><mo stretchy="false">)</mo></mrow></msup><mo>.</mo><mo>∗</mo><msup><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi></mi><mo>′</mo></msup></mrow></msup><mo stretchy="false">(</mo><msup><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>3</mn><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-3122">\delta^{(3)} = (\theta^{(3)})^{T}\delta^{(4)}.*g^{'}(z^{(3)})</script> <br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3123-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>&amp;#x03B4;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>2</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><msup><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>2</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><msup><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>T</mi></mrow></msup><msup><mi>&amp;#x03B4;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>3</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>.</mo><mo>&amp;#x2217;</mo><msup><mi>g</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi></mi><mo>&amp;#x2032;</mo></msup></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><msup><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>2</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-596" style="width: 13.336em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.094em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.184em, 1011em, 2.646em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-597"><span class="msubsup" id="MathJax-Span-598"><span style="display: inline-block; position: relative; width: 1.482em; height: 0px;"><span style="position: absolute; clip: rect(3.137em, 1000.45em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-599" style="font-family: MathJax_Math; font-style: italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.503em;"><span class="texatom" id="MathJax-Span-600"><span class="mrow" id="MathJax-Span-601"><span class="mo" id="MathJax-Span-602" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-603" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-604" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-605" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-606" style="font-family: MathJax_Main; padding-left: 0.278em;">(</span><span class="msubsup" id="MathJax-Span-607"><span style="display: inline-block; position: relative; width: 1.448em; height: 0px;"><span style="position: absolute; clip: rect(3.149em, 1000.46em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-608" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.469em;"><span class="texatom" id="MathJax-Span-609"><span class="mrow" id="MathJax-Span-610"><span class="mo" id="MathJax-Span-611" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-612" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-613" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-614"><span style="display: inline-block; position: relative; width: 0.962em; height: 0px;"><span style="position: absolute; clip: rect(3.104em, 1000.29em, 4.417em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-615" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.389em;"><span class="texatom" id="MathJax-Span-616"><span class="mrow" id="MathJax-Span-617"><span class="mi" id="MathJax-Span-618" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-619"><span style="display: inline-block; position: relative; width: 1.482em; height: 0px;"><span style="position: absolute; clip: rect(3.137em, 1000.45em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-620" style="font-family: MathJax_Math; font-style: italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.503em;"><span class="texatom" id="MathJax-Span-621"><span class="mrow" id="MathJax-Span-622"><span class="mo" id="MathJax-Span-623" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-624" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span class="mo" id="MathJax-Span-625" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-626" style="font-family: MathJax_Main;">.</span><span class="mo" id="MathJax-Span-627" style="font-family: MathJax_Main; padding-left: 0.167em;">∗</span><span class="msubsup" id="MathJax-Span-628"><span style="display: inline-block; position: relative; width: 0.796em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.48em, 4.372em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-629" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.531em;"><span class="texatom" id="MathJax-Span-630"><span class="mrow" id="MathJax-Span-631"><span class="msup" id="MathJax-Span-632"><span style="display: inline-block; position: relative; width: 0.191em; height: 0px;"><span style="position: absolute; clip: rect(3.854em, 1000em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-633" style="font-size: 70.7%;"></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.267em; left: 0em;"><span class="mo" id="MathJax-Span-634" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-635" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-636"><span style="display: inline-block; position: relative; width: 1.498em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.47em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-637" style="font-family: MathJax_Math; font-style: italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.519em;"><span class="texatom" id="MathJax-Span-638"><span class="mrow" id="MathJax-Span-639"><span class="mo" id="MathJax-Span-640" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-641" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-642" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-643" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.362em; border-left: 0px solid; width: 0px; height: 1.504em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>δ</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><mo stretchy="false">(</mo><msup><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msup><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mi>T</mi></mrow></msup><msup><mi>δ</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>3</mn><mo stretchy="false">)</mo></mrow></msup><mo>.</mo><mo>∗</mo><msup><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi></mi><mo>′</mo></msup></mrow></msup><mo stretchy="false">(</mo><msup><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-3123">\delta^{(2)} = (\theta^{(2)})^{T}\delta^{(3)}.*g^{'}(z^{(2)})</script> <br>
</p> <br>
 <br>
算法步骤如下 <br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3124-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi mathvariant=&quot;normal&quot;>&amp;#x0394;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mi>j</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>l</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup><mo>=</mo><mn>0</mn></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-644" style="width: 4.221em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.49em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.032em, 1003.45em, 2.843em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-645"><span class="msubsup" id="MathJax-Span-646"><span style="display: inline-block; position: relative; width: 1.669em; height: 0px;"><span style="position: absolute; clip: rect(3.138em, 1000.79em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-647" style="font-family: MathJax_Main;">Δ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.324em, 1000.84em, 4.343em, -1000em); top: -4.532em; left: 0.833em;"><span class="texatom" id="MathJax-Span-648"><span class="mrow" id="MathJax-Span-649"><span class="mo" id="MathJax-Span-650" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-651" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">l</span><span class="mo" id="MathJax-Span-652" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.387em, 1000.61em, 4.311em, -1000em); top: -3.707em; left: 0.833em;"><span class="texatom" id="MathJax-Span-653"><span class="mrow" id="MathJax-Span-654"><span class="mi" id="MathJax-Span-655" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-656" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-657" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-658" style="font-family: MathJax_Main; padding-left: 0.278em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.599em; border-left: 0px solid; width: 0px; height: 1.924em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi mathvariant="normal">Δ</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>l</mi><mo stretchy="false">)</mo></mrow></msubsup><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-3124">\Delta^{(l)}_{ij} = 0</script> <br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3125-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi><mi>o</mi><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x3000;</mo></mrow><mi>k</mi><mo>=</mo><mn>1</mn><mo>:</mo><mi>m</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-659" style="width: 7.711em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.406em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.335em, 1006.39em, 2.653em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-660"><span class="mi" id="MathJax-Span-661" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mi" id="MathJax-Span-662" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-663" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="texatom" id="MathJax-Span-664"><span class="mrow" id="MathJax-Span-665"><span class="mo" id="MathJax-Span-666"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">　</span></span></span></span><span class="mi" id="MathJax-Span-667" style="font-family: MathJax_Math; font-style: italic;">k</span><span class="mo" id="MathJax-Span-668" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-669" style="font-family: MathJax_Main; padding-left: 0.278em;">1</span><span class="mo" id="MathJax-Span-670" style="font-family: MathJax_Main; padding-left: 0.278em;">:</span><span class="mi" id="MathJax-Span-671" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">m</span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.308em; border-left: 0px solid; width: 0px; height: 1.331em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mi>o</mi><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><mo>　</mo></mrow><mi>k</mi><mo>=</mo><mn>1</mn><mo>:</mo><mi>m</mi></math></span></span><script type="math/tex" id="MathJax-Element-3125">for　k=1:m</script> <br>
{ <br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3126-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>=</mo><msup><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-672" style="width: 5.315em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.427em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.19em, 1004.43em, 2.407em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-673"><span class="msubsup" id="MathJax-Span-674"><span style="display: inline-block; position: relative; width: 1.508em; height: 0px;"><span style="position: absolute; clip: rect(3.413em, 1000.51em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-675" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.529em;"><span class="texatom" id="MathJax-Span-676"><span class="mrow" id="MathJax-Span-677"><span class="mo" id="MathJax-Span-678" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-679" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-680" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-681" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-682" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.566em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.52em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-683" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.572em;"><span class="texatom" id="MathJax-Span-684"><span class="mrow" id="MathJax-Span-685"><span class="mo" id="MathJax-Span-686" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-687" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span class="mo" id="MathJax-Span-688" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 1.21em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-3126">a^{(1)} = x^{(k)}</script> <br>
按正向传播算法计算<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3127-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>l</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-689" style="width: 1.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.354em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.138em, 1001.35em, 2.354em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-690"><span class="msubsup" id="MathJax-Span-691"><span style="display: inline-block; position: relative; width: 1.365em; height: 0px;"><span style="position: absolute; clip: rect(3.413em, 1000.51em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-692" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.529em;"><span class="texatom" id="MathJax-Span-693"><span class="mrow" id="MathJax-Span-694"><span class="mo" id="MathJax-Span-695" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-696" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">l</span><span class="mo" id="MathJax-Span-697" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.074em; border-left: 0px solid; width: 0px; height: 1.209em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>l</mi><mo stretchy="false">)</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-3127">a^{(l)}</script>　　<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3128-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>l</mi><mo>=</mo><mn>2</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>4</mn><mo>,</mo><mo>&amp;#x22EF;</mo><mo>,</mo><mi>L</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-698" style="width: 8.336em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.927em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.441em, 1006.89em, 2.642em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-699"><span class="mi" id="MathJax-Span-700" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mo" id="MathJax-Span-701" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-702" style="font-family: MathJax_Main; padding-left: 0.278em;">2</span><span class="mo" id="MathJax-Span-703" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-704" style="font-family: MathJax_Main; padding-left: 0.167em;">3</span><span class="mo" id="MathJax-Span-705" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-706" style="font-family: MathJax_Main; padding-left: 0.167em;">4</span><span class="mo" id="MathJax-Span-707" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-708" style="font-family: MathJax_Main; padding-left: 0.167em;">⋯</span><span class="mo" id="MathJax-Span-709" style="font-family: MathJax_Main; padding-left: 0.167em;">,</span><span class="mi" id="MathJax-Span-710" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">L</span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.295em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mo>=</mo><mn>2</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>4</mn><mo>,</mo><mo>⋯</mo><mo>,</mo><mi>L</mi></math></span></span><script type="math/tex" id="MathJax-Element-3128">l=2, 3, 4,\cdots,L</script> <br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3129-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>&amp;#x03B4;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>L</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>=</mo><msup><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>L</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>&amp;#x2212;</mo><mi>y</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-711" style="width: 7.607em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.302em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.242em, 1006.3em, 2.653em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-712"><span class="msubsup" id="MathJax-Span-713"><span style="display: inline-block; position: relative; width: 1.61em; height: 0px;"><span style="position: absolute; clip: rect(3.137em, 1000.45em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-714" style="font-family: MathJax_Math; font-style: italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.503em;"><span class="texatom" id="MathJax-Span-715"><span class="mrow" id="MathJax-Span-716"><span class="mo" id="MathJax-Span-717" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-718" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">L</span><span class="mo" id="MathJax-Span-719" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-720" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-721" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.636em; height: 0px;"><span style="position: absolute; clip: rect(3.413em, 1000.51em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-722" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.529em;"><span class="texatom" id="MathJax-Span-723"><span class="mrow" id="MathJax-Span-724"><span class="mo" id="MathJax-Span-725" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-726" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">L</span><span class="mo" id="MathJax-Span-727" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-728" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-729" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.308em; border-left: 0px solid; width: 0px; height: 1.443em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>δ</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>L</mi><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>L</mi><mo stretchy="false">)</mo></mrow></msup><mo>−</mo><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-3129">\delta^{(L)} = a^{(L)} - y</script> <br>
按反向传播算法计算<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3130-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>&amp;#x03B4;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>l</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-730" style="width: 1.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.354em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.138em, 1001.35em, 2.354em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-731"><span class="msubsup" id="MathJax-Span-732"><span style="display: inline-block; position: relative; width: 1.339em; height: 0px;"><span style="position: absolute; clip: rect(3.137em, 1000.45em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-733" style="font-family: MathJax_Math; font-style: italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.503em;"><span class="texatom" id="MathJax-Span-734"><span class="mrow" id="MathJax-Span-735"><span class="mo" id="MathJax-Span-736" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-737" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">l</span><span class="mo" id="MathJax-Span-738" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.074em; border-left: 0px solid; width: 0px; height: 1.209em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>δ</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>l</mi><mo stretchy="false">)</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-3130">\delta^{(l)}</script>　　<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3131-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>l</mi><mo>=</mo><mi>L</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo>,</mo><mi>L</mi><mo>&amp;#x2212;</mo><mn>2</mn><mo>,</mo><mi>L</mi><mo>&amp;#x2212;</mo><mn>3</mn><mo>,</mo><mo>&amp;#x22EF;</mo><mo>,</mo><mn>2</mn></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-739" style="width: 14.951em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.448em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.441em, 1012.4em, 2.642em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-740"><span class="mi" id="MathJax-Span-741" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mo" id="MathJax-Span-742" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-743" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">L</span><span class="mo" id="MathJax-Span-744" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mn" id="MathJax-Span-745" style="font-family: MathJax_Main; padding-left: 0.222em;">1</span><span class="mo" id="MathJax-Span-746" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-747" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">L</span><span class="mo" id="MathJax-Span-748" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mn" id="MathJax-Span-749" style="font-family: MathJax_Main; padding-left: 0.222em;">2</span><span class="mo" id="MathJax-Span-750" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-751" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">L</span><span class="mo" id="MathJax-Span-752" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mn" id="MathJax-Span-753" style="font-family: MathJax_Main; padding-left: 0.222em;">3</span><span class="mo" id="MathJax-Span-754" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-755" style="font-family: MathJax_Main; padding-left: 0.167em;">⋯</span><span class="mo" id="MathJax-Span-756" style="font-family: MathJax_Main; padding-left: 0.167em;">,</span><span class="mn" id="MathJax-Span-757" style="font-family: MathJax_Main; padding-left: 0.167em;">2</span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.295em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mo>=</mo><mi>L</mi><mo>−</mo><mn>1</mn><mo>,</mo><mi>L</mi><mo>−</mo><mn>2</mn><mo>,</mo><mi>L</mi><mo>−</mo><mn>3</mn><mo>,</mo><mo>⋯</mo><mo>,</mo><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-3131">l=L-1, L-2, L-3,\cdots,2</script> <br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3132-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi mathvariant=&quot;normal&quot;>&amp;#x0394;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>l</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>=</mo><msup><mi mathvariant=&quot;normal&quot;>&amp;#x0394;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>l</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>+</mo><msup><mi>&amp;#x03B4;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>l</mi><mo>+</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><msup><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>l</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><msup><mo stretchy=&quot;false&quot;>)</mo><mi>T</mi></msup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-758" style="width: 13.023em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.833em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.19em, 1010.83em, 2.646em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-759"><span class="msubsup" id="MathJax-Span-760"><span style="display: inline-block; position: relative; width: 1.669em; height: 0px;"><span style="position: absolute; clip: rect(3.138em, 1000.79em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-761" style="font-family: MathJax_Main;">Δ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.833em;"><span class="texatom" id="MathJax-Span-762"><span class="mrow" id="MathJax-Span-763"><span class="mo" id="MathJax-Span-764" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-765" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">l</span><span class="mo" id="MathJax-Span-766" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-767" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-768" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.669em; height: 0px;"><span style="position: absolute; clip: rect(3.138em, 1000.79em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-769" style="font-family: MathJax_Main;">Δ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.833em;"><span class="texatom" id="MathJax-Span-770"><span class="mrow" id="MathJax-Span-771"><span class="mo" id="MathJax-Span-772" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-773" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">l</span><span class="mo" id="MathJax-Span-774" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-775" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msubsup" id="MathJax-Span-776" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 2.243em; height: 0px;"><span style="position: absolute; clip: rect(3.137em, 1000.45em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-777" style="font-family: MathJax_Math; font-style: italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.503em;"><span class="texatom" id="MathJax-Span-778"><span class="mrow" id="MathJax-Span-779"><span class="mo" id="MathJax-Span-780" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-781" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">l</span><span class="mo" id="MathJax-Span-782" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-783" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-784" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-785" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-786"><span style="display: inline-block; position: relative; width: 1.365em; height: 0px;"><span style="position: absolute; clip: rect(3.413em, 1000.51em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-787" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.529em;"><span class="texatom" id="MathJax-Span-788"><span class="mrow" id="MathJax-Span-789"><span class="mo" id="MathJax-Span-790" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-791" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">l</span><span class="mo" id="MathJax-Span-792" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-793"><span style="display: inline-block; position: relative; width: 0.962em; height: 0px;"><span style="position: absolute; clip: rect(3.104em, 1000.29em, 4.417em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-794" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.389em;"><span class="mi" id="MathJax-Span-795" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.362em; border-left: 0px solid; width: 0px; height: 1.497em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi mathvariant="normal">Δ</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>l</mi><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><msup><mi mathvariant="normal">Δ</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>l</mi><mo stretchy="false">)</mo></mrow></msup><mo>+</mo><msup><mi>δ</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>l</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">(</mo><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>l</mi><mo stretchy="false">)</mo></mrow></msup><msup><mo stretchy="false">)</mo><mi>T</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-3132">\Delta^{(l)} = \Delta^{(l)} + \delta^{(l+1)}(a^{(l)})^T</script>　　<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3133-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>l</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>4</mn><mo>,</mo><mo>&amp;#x22EF;</mo><mo>,</mo><mi>L</mi><mo>&amp;#x2212;</mo><mn>1</mn></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-796" style="width: 11.513em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.583em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.441em, 1009.51em, 2.642em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-797"><span class="mi" id="MathJax-Span-798" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mo" id="MathJax-Span-799" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-800" style="font-family: MathJax_Main; padding-left: 0.278em;">1</span><span class="mo" id="MathJax-Span-801" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-802" style="font-family: MathJax_Main; padding-left: 0.167em;">2</span><span class="mo" id="MathJax-Span-803" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-804" style="font-family: MathJax_Main; padding-left: 0.167em;">3</span><span class="mo" id="MathJax-Span-805" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-806" style="font-family: MathJax_Main; padding-left: 0.167em;">4</span><span class="mo" id="MathJax-Span-807" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-808" style="font-family: MathJax_Main; padding-left: 0.167em;">⋯</span><span class="mo" id="MathJax-Span-809" style="font-family: MathJax_Main; padding-left: 0.167em;">,</span><span class="mi" id="MathJax-Span-810" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">L</span><span class="mo" id="MathJax-Span-811" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mn" id="MathJax-Span-812" style="font-family: MathJax_Main; padding-left: 0.222em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.295em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>4</mn><mo>,</mo><mo>⋯</mo><mo>,</mo><mi>L</mi><mo>−</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-3133">l=1,2, 3, 4,\cdots,L-1</script> <br>
} <br>
别忘了加上正则化项。 <br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3134-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mfrac><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><msubsup><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mi>j</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>l</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup></mrow></mfrac><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msubsup><mi>D</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mi>j</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>l</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup><mo>=</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><msubsup><mi mathvariant=&quot;normal&quot;>&amp;#x0394;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mi>j</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>l</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-813" style="width: 12.659em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.521em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.084em, 1010.52em, 3.415em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-814"><span class="mfrac" id="MathJax-Span-815"><span style="display: inline-block; position: relative; width: 1.443em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.349em, 1000.4em, 4.182em, -1000em); top: -4.434em; left: 50%; margin-left: -0.2em;"><span class="mi" id="MathJax-Span-816" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.111em, 1001.32em, 4.483em, -1000em); top: -3.359em; left: 50%; margin-left: -0.661em;"><span class="mrow" id="MathJax-Span-817"><span class="mi" id="MathJax-Span-818" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span class="msubsup" id="MathJax-Span-819"><span style="display: inline-block; position: relative; width: 0.923em; height: 0px;"><span style="position: absolute; clip: rect(3.356em, 1000.33em, 4.174em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-820" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.479em, 1000.59em, 4.292em, -1000em); top: -4.379em; left: 0.332em;"><span class="texatom" id="MathJax-Span-821"><span class="mrow" id="MathJax-Span-822"><span class="mo" id="MathJax-Span-823" style="font-size: 50%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-824" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">l</span><span class="mo" id="MathJax-Span-825" style="font-size: 50%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.524em, 1000.43em, 4.269em, -1000em); top: -3.796em; left: 0.332em;"><span class="texatom" id="MathJax-Span-826"><span class="mrow" id="MathJax-Span-827"><span class="mi" id="MathJax-Span-828" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-829" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1001.44em, 1.198em, -1000em); top: -1.262em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.443em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span><span class="mi" id="MathJax-Span-830" style="font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.078em;"></span></span><span class="mo" id="MathJax-Span-831" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-832" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="mo" id="MathJax-Span-833" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-834" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-835" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.664em; height: 0px;"><span style="position: absolute; clip: rect(3.171em, 1000.8em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-836" style="font-family: MathJax_Math; font-style: italic;">D</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.324em, 1000.84em, 4.343em, -1000em); top: -4.532em; left: 0.828em;"><span class="texatom" id="MathJax-Span-837"><span class="mrow" id="MathJax-Span-838"><span class="mo" id="MathJax-Span-839" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-840" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">l</span><span class="mo" id="MathJax-Span-841" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.387em, 1000.61em, 4.311em, -1000em); top: -3.707em; left: 0.828em;"><span class="texatom" id="MathJax-Span-842"><span class="mrow" id="MathJax-Span-843"><span class="mi" id="MathJax-Span-844" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-845" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-846" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mfrac" id="MathJax-Span-847" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 0.741em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.383em, 1000.3em, 4.167em, -1000em); top: -4.418em; left: 50%; margin-left: -0.177em;"><span class="mn" id="MathJax-Span-848" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.542em, 1000.61em, 4.174em, -1000em); top: -3.666em; left: 50%; margin-left: -0.31em;"><span class="mi" id="MathJax-Span-849" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1000.74em, 1.198em, -1000em); top: -1.262em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.741em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-850"><span style="display: inline-block; position: relative; width: 1.669em; height: 0px;"><span style="position: absolute; clip: rect(3.138em, 1000.79em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-851" style="font-family: MathJax_Main;">Δ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.324em, 1000.84em, 4.343em, -1000em); top: -4.532em; left: 0.833em;"><span class="texatom" id="MathJax-Span-852"><span class="mrow" id="MathJax-Span-853"><span class="mo" id="MathJax-Span-854" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-855" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">l</span><span class="mo" id="MathJax-Span-856" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.387em, 1000.61em, 4.311em, -1000em); top: -3.707em; left: 0.833em;"><span class="texatom" id="MathJax-Span-857"><span class="mrow" id="MathJax-Span-858"><span class="mi" id="MathJax-Span-859" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-860" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.223em; border-left: 0px solid; width: 0px; height: 2.548em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msubsup><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>l</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow></mfrac><mi>J</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>=</mo><msubsup><mi>D</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>l</mi><mo stretchy="false">)</mo></mrow></msubsup><mo>=</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><msubsup><mi mathvariant="normal">Δ</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>l</mi><mo stretchy="false">)</mo></mrow></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-3134">\frac{\partial}{\partial \theta^{(l)}_{ij} }J(\theta) = D_{ij}^{(l)} = \frac{1}{m}\Delta^{(l)}_{ij}</script>　　　　　　　　　<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3135-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>j</mi><mo>=</mo><mn>0</mn></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-861" style="width: 2.711em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.24em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.469em, 1002.2em, 2.652em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-862"><span class="mi" id="MathJax-Span-863" style="font-family: MathJax_Math; font-style: italic;">j</span><span class="mo" id="MathJax-Span-864" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-865" style="font-family: MathJax_Main; padding-left: 0.278em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.307em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-3135">j=0</script> <br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3136-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mfrac><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><msubsup><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mi>j</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>l</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup></mrow></mfrac><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msubsup><mi>D</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mi>j</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>l</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup><mo>=</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><msubsup><mi mathvariant=&quot;normal&quot;>&amp;#x0394;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mi>j</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>l</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup><mo>+</mo><mfrac><mi>&amp;#x03BB;</mi><mi>m</mi></mfrac><msubsup><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mi>j</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>l</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-866" style="width: 16.878em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.063em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.084em, 1014.06em, 3.415em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-867"><span class="mfrac" id="MathJax-Span-868"><span style="display: inline-block; position: relative; width: 1.443em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.349em, 1000.4em, 4.182em, -1000em); top: -4.434em; left: 50%; margin-left: -0.2em;"><span class="mi" id="MathJax-Span-869" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.111em, 1001.32em, 4.483em, -1000em); top: -3.359em; left: 50%; margin-left: -0.661em;"><span class="mrow" id="MathJax-Span-870"><span class="mi" id="MathJax-Span-871" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span class="msubsup" id="MathJax-Span-872"><span style="display: inline-block; position: relative; width: 0.923em; height: 0px;"><span style="position: absolute; clip: rect(3.356em, 1000.33em, 4.174em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-873" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.479em, 1000.59em, 4.292em, -1000em); top: -4.379em; left: 0.332em;"><span class="texatom" id="MathJax-Span-874"><span class="mrow" id="MathJax-Span-875"><span class="mo" id="MathJax-Span-876" style="font-size: 50%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-877" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">l</span><span class="mo" id="MathJax-Span-878" style="font-size: 50%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.524em, 1000.43em, 4.269em, -1000em); top: -3.796em; left: 0.332em;"><span class="texatom" id="MathJax-Span-879"><span class="mrow" id="MathJax-Span-880"><span class="mi" id="MathJax-Span-881" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-882" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1001.44em, 1.198em, -1000em); top: -1.262em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.443em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span><span class="mi" id="MathJax-Span-883" style="font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.078em;"></span></span><span class="mo" id="MathJax-Span-884" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-885" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="mo" id="MathJax-Span-886" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-887" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-888" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.664em; height: 0px;"><span style="position: absolute; clip: rect(3.171em, 1000.8em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-889" style="font-family: MathJax_Math; font-style: italic;">D</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.324em, 1000.84em, 4.343em, -1000em); top: -4.532em; left: 0.828em;"><span class="texatom" id="MathJax-Span-890"><span class="mrow" id="MathJax-Span-891"><span class="mo" id="MathJax-Span-892" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-893" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">l</span><span class="mo" id="MathJax-Span-894" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.387em, 1000.61em, 4.311em, -1000em); top: -3.707em; left: 0.828em;"><span class="texatom" id="MathJax-Span-895"><span class="mrow" id="MathJax-Span-896"><span class="mi" id="MathJax-Span-897" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-898" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-899" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mfrac" id="MathJax-Span-900" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 0.741em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.383em, 1000.3em, 4.167em, -1000em); top: -4.418em; left: 50%; margin-left: -0.177em;"><span class="mn" id="MathJax-Span-901" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.542em, 1000.61em, 4.174em, -1000em); top: -3.666em; left: 50%; margin-left: -0.31em;"><span class="mi" id="MathJax-Span-902" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1000.74em, 1.198em, -1000em); top: -1.262em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.741em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-903"><span style="display: inline-block; position: relative; width: 1.669em; height: 0px;"><span style="position: absolute; clip: rect(3.138em, 1000.79em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-904" style="font-family: MathJax_Main;">Δ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.324em, 1000.84em, 4.343em, -1000em); top: -4.532em; left: 0.833em;"><span class="texatom" id="MathJax-Span-905"><span class="mrow" id="MathJax-Span-906"><span class="mo" id="MathJax-Span-907" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-908" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">l</span><span class="mo" id="MathJax-Span-909" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.387em, 1000.61em, 4.311em, -1000em); top: -3.707em; left: 0.833em;"><span class="texatom" id="MathJax-Span-910"><span class="mrow" id="MathJax-Span-911"><span class="mi" id="MathJax-Span-912" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-913" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-914" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mfrac" id="MathJax-Span-915" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.741em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.363em, 1000.39em, 4.175em, -1000em); top: -4.427em; left: 50%; margin-left: -0.206em;"><span class="mi" id="MathJax-Span-916" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">λ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.542em, 1000.61em, 4.174em, -1000em); top: -3.666em; left: 50%; margin-left: -0.31em;"><span class="mi" id="MathJax-Span-917" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1000.74em, 1.198em, -1000em); top: -1.262em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.741em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-918"><span style="display: inline-block; position: relative; width: 1.305em; height: 0px;"><span style="position: absolute; clip: rect(3.149em, 1000.46em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-919" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.324em, 1000.84em, 4.343em, -1000em); top: -4.532em; left: 0.469em;"><span class="texatom" id="MathJax-Span-920"><span class="mrow" id="MathJax-Span-921"><span class="mo" id="MathJax-Span-922" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-923" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">l</span><span class="mo" id="MathJax-Span-924" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.387em, 1000.61em, 4.311em, -1000em); top: -3.707em; left: 0.469em;"><span class="texatom" id="MathJax-Span-925"><span class="mrow" id="MathJax-Span-926"><span class="mi" id="MathJax-Span-927" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-928" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.223em; border-left: 0px solid; width: 0px; height: 2.548em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msubsup><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>l</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow></mfrac><mi>J</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>=</mo><msubsup><mi>D</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>l</mi><mo stretchy="false">)</mo></mrow></msubsup><mo>=</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><msubsup><mi mathvariant="normal">Δ</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>l</mi><mo stretchy="false">)</mo></mrow></msubsup><mo>+</mo><mfrac><mi>λ</mi><mi>m</mi></mfrac><msubsup><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>l</mi><mo stretchy="false">)</mo></mrow></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-3136">\frac{\partial}{\partial \theta^{(l)}_{ij} }J(\theta) = D_{ij}^{(l)} = \frac{1}{m}\Delta^{(l)}_{ij} + \frac{\lambda}{m} \theta^{(l)}_{ij}</script>　　　　<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3137-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>j</mi><mo>&amp;gt;=</mo><mn>1</mn></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-929" style="width: 3.648em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.021em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.469em, 1002.95em, 2.652em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-930"><span class="mi" id="MathJax-Span-931" style="font-family: MathJax_Math; font-style: italic;">j</span><span class="mo" id="MathJax-Span-932" style="font-family: MathJax_Main; padding-left: 0.278em;">&gt;<span style="font-family: MathJax_Main; font-style: normal; font-weight: normal;">=</span></span><span class="mn" id="MathJax-Span-933" style="font-family: MathJax_Main; padding-left: 0.278em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.307em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mo>&gt;=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-3137">j>=1</script> <br>
 <br>




<h2 id="13-unrolling-parameters"><a name="t3"></a>1.3 Unrolling parameters</h2>

<p><img src="https://img-blog.csdn.net/20170514174949461?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjcwMDgwNzk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述" title=""> <br>
在上面的函数中，我们需要传递的参数为向量 <br>
而事实上，在我们上面的推理中可以发现<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3210-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B8;</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-934" style="width: 0.576em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.469em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.43em, 1000.46em, 2.458em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-935"><span class="mi" id="MathJax-Span-936" style="font-family: MathJax_Math; font-style: italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.074em; border-left: 0px solid; width: 0px; height: 0.983em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-3210">\theta</script>和梯度都为矩阵形式， <br>
所以我们需要把矩阵换为向量传递，在函数中将向量转换为矩阵使用。</p>

<p>下面举一个例子 <br>
<img src="https://img-blog.csdn.net/20170514175416869?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjcwMDgwNzk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述" title=""> <br>
</p> <br>


<h2 id="14-gradient-checking"><a name="t4"></a>1.4 Gradient checking</h2>

<p>因为梯度计算方式的复杂，下面给出一种检测计算的方式。 <br>
我们学习过导数的几何意义如下。 <br>
<img src="https://img-blog.csdn.net/20170514175812762?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjcwMDgwNzk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述" title=""> <br>
由此我们可以想到一种检测梯度的方式 <br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3964-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B8;</mi><mo>=</mo><mo stretchy=&quot;false&quot;>[</mo><msub><mi>&amp;#x03B8;</mi><mn>1</mn></msub><mo>,</mo><msub><mi>&amp;#x03B8;</mi><mn>2</mn></msub><mo>,</mo><msub><mi>&amp;#x03B8;</mi><mn>3</mn></msub><mo>,</mo><msub><mi>&amp;#x03B8;</mi><mn>4</mn></msub><mo>,</mo><mo>&amp;#x22EF;</mo><mo>,</mo><msub><mi>&amp;#x03B8;</mi><mi>n</mi></msub><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-937" style="width: 12.607em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.469em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.385em, 1010.35em, 2.698em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-938"><span class="mi" id="MathJax-Span-939" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="mo" id="MathJax-Span-940" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-941" style="font-family: MathJax_Main; padding-left: 0.278em;">[</span><span class="msubsup" id="MathJax-Span-942"><span style="display: inline-block; position: relative; width: 0.898em; height: 0px;"><span style="position: absolute; clip: rect(3.149em, 1000.46em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-943" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.469em;"><span class="mn" id="MathJax-Span-944" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-945" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-946" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.898em; height: 0px;"><span style="position: absolute; clip: rect(3.149em, 1000.46em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-947" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.469em;"><span class="mn" id="MathJax-Span-948" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-949" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-950" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.898em; height: 0px;"><span style="position: absolute; clip: rect(3.149em, 1000.46em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-951" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.469em;"><span class="mn" id="MathJax-Span-952" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-953" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-954" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.898em; height: 0px;"><span style="position: absolute; clip: rect(3.149em, 1000.46em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-955" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.469em;"><span class="mn" id="MathJax-Span-956" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-957" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-958" style="font-family: MathJax_Main; padding-left: 0.167em;">⋯</span><span class="mo" id="MathJax-Span-959" style="font-family: MathJax_Main; padding-left: 0.167em;">,</span><span class="msubsup" id="MathJax-Span-960" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(3.149em, 1000.46em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-961" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.469em;"><span class="mi" id="MathJax-Span-962" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-963" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.362em; border-left: 0px solid; width: 0px; height: 1.325em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi><mo>=</mo><mo stretchy="false">[</mo><msub><mi>θ</mi><mn>1</mn></msub><mo>,</mo><msub><mi>θ</mi><mn>2</mn></msub><mo>,</mo><msub><mi>θ</mi><mn>3</mn></msub><mo>,</mo><msub><mi>θ</mi><mn>4</mn></msub><mo>,</mo><mo>⋯</mo><mo>,</mo><msub><mi>θ</mi><mi>n</mi></msub><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-3964">\theta = [\theta_1, \theta_2, \theta_3, \theta_4, \cdots, \theta_n]</script> <br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3965-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mfrac><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><msub><mi>&amp;#x03B8;</mi><mn>1</mn></msub></mrow></mfrac><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2248;</mo><mfrac><mrow><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>&amp;#x03B8;</mi><mn>1</mn></msub><mo>+</mo><mi>&amp;#x03B5;</mi><mo>,</mo><msub><mi>&amp;#x03B8;</mi><mn>2</mn></msub><mo>,</mo><msub><mi>&amp;#x03B8;</mi><mn>3</mn></msub><mo>,</mo><mo>&amp;#x22EF;</mo><mo>,</mo><msub><mi>&amp;#x03B8;</mi><mi>n</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>&amp;#x03B8;</mi><mn>1</mn></msub><mo>&amp;#x2212;</mo><mi>&amp;#x03B5;</mi><mo>,</mo><msub><mi>&amp;#x03B8;</mi><mn>2</mn></msub><mo>,</mo><msub><mi>&amp;#x03B8;</mi><mn>3</mn></msub><mo>,</mo><mo>&amp;#x22EF;</mo><mo>,</mo><msub><mi>&amp;#x03B8;</mi><mi>n</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><mn>2</mn><mi>&amp;#x03B5;</mi></mrow></mfrac></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-964" style="width: 21.201em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.656em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.021em, 1017.66em, 2.967em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-965"><span class="mfrac" id="MathJax-Span-966"><span style="display: inline-block; position: relative; width: 1.155em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.349em, 1000.4em, 4.182em, -1000em); top: -4.434em; left: 50%; margin-left: -0.2em;"><span class="mi" id="MathJax-Span-967" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.349em, 1001.04em, 4.273em, -1000em); top: -3.597em; left: 50%; margin-left: -0.517em;"><span class="mrow" id="MathJax-Span-968"><span class="mi" id="MathJax-Span-969" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span class="msubsup" id="MathJax-Span-970"><span style="display: inline-block; position: relative; width: 0.635em; height: 0px;"><span style="position: absolute; clip: rect(3.356em, 1000.33em, 4.174em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-971" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.904em; left: 0.332em;"><span class="mn" id="MathJax-Span-972" style="font-size: 50%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1001.16em, 1.198em, -1000em); top: -1.262em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.155em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span><span class="mi" id="MathJax-Span-973" style="font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.078em;"></span></span><span class="mo" id="MathJax-Span-974" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-975" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="mo" id="MathJax-Span-976" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-977" style="font-family: MathJax_Main; padding-left: 0.278em;">≈</span><span class="mfrac" id="MathJax-Span-978" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 12.832em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.324em, 1012.65em, 4.343em, -1000em); top: -4.595em; left: 50%; margin-left: -6.356em;"><span class="mrow" id="MathJax-Span-979"><span class="mi" id="MathJax-Span-980" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span class="mo" id="MathJax-Span-981" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-982"><span style="display: inline-block; position: relative; width: 0.635em; height: 0px;"><span style="position: absolute; clip: rect(3.356em, 1000.33em, 4.174em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-983" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.904em; left: 0.332em;"><span class="mn" id="MathJax-Span-984" style="font-size: 50%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-985" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-986" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">ε</span><span class="mo" id="MathJax-Span-987" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-988"><span style="display: inline-block; position: relative; width: 0.635em; height: 0px;"><span style="position: absolute; clip: rect(3.356em, 1000.33em, 4.174em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-989" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.904em; left: 0.332em;"><span class="mn" id="MathJax-Span-990" style="font-size: 50%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-991" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-992"><span style="display: inline-block; position: relative; width: 0.635em; height: 0px;"><span style="position: absolute; clip: rect(3.356em, 1000.33em, 4.174em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-993" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.904em; left: 0.332em;"><span class="mn" id="MathJax-Span-994" style="font-size: 50%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-995" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-996" style="font-size: 70.7%; font-family: MathJax_Main;">⋯</span><span class="mo" id="MathJax-Span-997" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-998"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; clip: rect(3.356em, 1000.33em, 4.174em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-999" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.904em; left: 0.332em;"><span class="mi" id="MathJax-Span-1000" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-1001" style="font-size: 70.7%; font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1002" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-1003" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span class="mo" id="MathJax-Span-1004" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1005"><span style="display: inline-block; position: relative; width: 0.635em; height: 0px;"><span style="position: absolute; clip: rect(3.356em, 1000.33em, 4.174em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-1006" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.904em; left: 0.332em;"><span class="mn" id="MathJax-Span-1007" style="font-size: 50%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-1008" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-1009" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">ε</span><span class="mo" id="MathJax-Span-1010" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1011"><span style="display: inline-block; position: relative; width: 0.635em; height: 0px;"><span style="position: absolute; clip: rect(3.356em, 1000.33em, 4.174em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-1012" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.904em; left: 0.332em;"><span class="mn" id="MathJax-Span-1013" style="font-size: 50%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-1014" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1015"><span style="display: inline-block; position: relative; width: 0.635em; height: 0px;"><span style="position: absolute; clip: rect(3.356em, 1000.33em, 4.174em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-1016" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.904em; left: 0.332em;"><span class="mn" id="MathJax-Span-1017" style="font-size: 50%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-1018" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-1019" style="font-size: 70.7%; font-family: MathJax_Main;">⋯</span><span class="mo" id="MathJax-Span-1020" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1021"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; clip: rect(3.356em, 1000.33em, 4.174em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-1022" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.904em; left: 0.332em;"><span class="mi" id="MathJax-Span-1023" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-1024" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.383em, 1000.66em, 4.182em, -1000em); top: -3.632em; left: 50%; margin-left: -0.342em;"><span class="mrow" id="MathJax-Span-1025"><span class="mn" id="MathJax-Span-1026" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-1027" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">ε</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1012.83em, 1.198em, -1000em); top: -1.262em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 12.832em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.686em; border-left: 0px solid; width: 0px; height: 2.086em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msub><mi>θ</mi><mn>1</mn></msub></mrow></mfrac><mi>J</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>≈</mo><mfrac><mrow><mi>J</mi><mo stretchy="false">(</mo><msub><mi>θ</mi><mn>1</mn></msub><mo>+</mo><mi>ε</mi><mo>,</mo><msub><mi>θ</mi><mn>2</mn></msub><mo>,</mo><msub><mi>θ</mi><mn>3</mn></msub><mo>,</mo><mo>⋯</mo><mo>,</mo><msub><mi>θ</mi><mi>n</mi></msub><mo stretchy="false">)</mo><mo>−</mo><mi>J</mi><mo stretchy="false">(</mo><msub><mi>θ</mi><mn>1</mn></msub><mo>−</mo><mi>ε</mi><mo>,</mo><msub><mi>θ</mi><mn>2</mn></msub><mo>,</mo><msub><mi>θ</mi><mn>3</mn></msub><mo>,</mo><mo>⋯</mo><mo>,</mo><msub><mi>θ</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow><mrow><mn>2</mn><mi>ε</mi></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-3965">\frac{\partial}{\partial \theta_1}J(\theta) \approx \frac{J(\theta_1 + \varepsilon, \theta_2, \theta_3, \cdots, \theta_n) - J(\theta_1 - \varepsilon, \theta_2, \theta_3, \cdots, \theta_n)}{2\varepsilon}</script> <br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3966-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mfrac><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><msub><mi>&amp;#x03B8;</mi><mn>2</mn></msub></mrow></mfrac><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2248;</mo><mfrac><mrow><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>&amp;#x03B8;</mi><mn>1</mn></msub><mo>,</mo><msub><mi>&amp;#x03B8;</mi><mn>2</mn></msub><mo>+</mo><mi>&amp;#x03B5;</mi><mo>,</mo><msub><mi>&amp;#x03B8;</mi><mn>3</mn></msub><mo>,</mo><mo>&amp;#x22EF;</mo><mo>,</mo><msub><mi>&amp;#x03B8;</mi><mi>n</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>&amp;#x03B8;</mi><mn>1</mn></msub><mo>,</mo><msub><mi>&amp;#x03B8;</mi><mn>2</mn></msub><mo>&amp;#x2212;</mo><mi>&amp;#x03B5;</mi><mo>,</mo><msub><mi>&amp;#x03B8;</mi><mn>3</mn></msub><mo>,</mo><mo>&amp;#x22EF;</mo><mo>,</mo><msub><mi>&amp;#x03B8;</mi><mi>n</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><mn>2</mn><mi>&amp;#x03B5;</mi></mrow></mfrac></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1028" style="width: 21.201em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.656em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.021em, 1017.66em, 2.967em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-1029"><span class="mfrac" id="MathJax-Span-1030"><span style="display: inline-block; position: relative; width: 1.155em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.349em, 1000.4em, 4.182em, -1000em); top: -4.434em; left: 50%; margin-left: -0.2em;"><span class="mi" id="MathJax-Span-1031" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.349em, 1001.04em, 4.273em, -1000em); top: -3.597em; left: 50%; margin-left: -0.517em;"><span class="mrow" id="MathJax-Span-1032"><span class="mi" id="MathJax-Span-1033" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span class="msubsup" id="MathJax-Span-1034"><span style="display: inline-block; position: relative; width: 0.635em; height: 0px;"><span style="position: absolute; clip: rect(3.356em, 1000.33em, 4.174em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-1035" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.904em; left: 0.332em;"><span class="mn" id="MathJax-Span-1036" style="font-size: 50%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1001.16em, 1.198em, -1000em); top: -1.262em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.155em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span><span class="mi" id="MathJax-Span-1037" style="font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.078em;"></span></span><span class="mo" id="MathJax-Span-1038" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1039" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="mo" id="MathJax-Span-1040" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1041" style="font-family: MathJax_Main; padding-left: 0.278em;">≈</span><span class="mfrac" id="MathJax-Span-1042" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 12.832em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.324em, 1012.65em, 4.343em, -1000em); top: -4.595em; left: 50%; margin-left: -6.356em;"><span class="mrow" id="MathJax-Span-1043"><span class="mi" id="MathJax-Span-1044" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span class="mo" id="MathJax-Span-1045" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1046"><span style="display: inline-block; position: relative; width: 0.635em; height: 0px;"><span style="position: absolute; clip: rect(3.356em, 1000.33em, 4.174em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-1047" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.904em; left: 0.332em;"><span class="mn" id="MathJax-Span-1048" style="font-size: 50%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-1049" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1050"><span style="display: inline-block; position: relative; width: 0.635em; height: 0px;"><span style="position: absolute; clip: rect(3.356em, 1000.33em, 4.174em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-1051" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.904em; left: 0.332em;"><span class="mn" id="MathJax-Span-1052" style="font-size: 50%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-1053" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-1054" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">ε</span><span class="mo" id="MathJax-Span-1055" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1056"><span style="display: inline-block; position: relative; width: 0.635em; height: 0px;"><span style="position: absolute; clip: rect(3.356em, 1000.33em, 4.174em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-1057" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.904em; left: 0.332em;"><span class="mn" id="MathJax-Span-1058" style="font-size: 50%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-1059" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-1060" style="font-size: 70.7%; font-family: MathJax_Main;">⋯</span><span class="mo" id="MathJax-Span-1061" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1062"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; clip: rect(3.356em, 1000.33em, 4.174em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-1063" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.904em; left: 0.332em;"><span class="mi" id="MathJax-Span-1064" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-1065" style="font-size: 70.7%; font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1066" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-1067" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span class="mo" id="MathJax-Span-1068" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1069"><span style="display: inline-block; position: relative; width: 0.635em; height: 0px;"><span style="position: absolute; clip: rect(3.356em, 1000.33em, 4.174em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-1070" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.904em; left: 0.332em;"><span class="mn" id="MathJax-Span-1071" style="font-size: 50%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-1072" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1073"><span style="display: inline-block; position: relative; width: 0.635em; height: 0px;"><span style="position: absolute; clip: rect(3.356em, 1000.33em, 4.174em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-1074" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.904em; left: 0.332em;"><span class="mn" id="MathJax-Span-1075" style="font-size: 50%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-1076" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-1077" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">ε</span><span class="mo" id="MathJax-Span-1078" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1079"><span style="display: inline-block; position: relative; width: 0.635em; height: 0px;"><span style="position: absolute; clip: rect(3.356em, 1000.33em, 4.174em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-1080" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.904em; left: 0.332em;"><span class="mn" id="MathJax-Span-1081" style="font-size: 50%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-1082" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-1083" style="font-size: 70.7%; font-family: MathJax_Main;">⋯</span><span class="mo" id="MathJax-Span-1084" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1085"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; clip: rect(3.356em, 1000.33em, 4.174em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-1086" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.904em; left: 0.332em;"><span class="mi" id="MathJax-Span-1087" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-1088" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.383em, 1000.66em, 4.182em, -1000em); top: -3.632em; left: 50%; margin-left: -0.342em;"><span class="mrow" id="MathJax-Span-1089"><span class="mn" id="MathJax-Span-1090" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-1091" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">ε</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1012.83em, 1.198em, -1000em); top: -1.262em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 12.832em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.686em; border-left: 0px solid; width: 0px; height: 2.086em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msub><mi>θ</mi><mn>2</mn></msub></mrow></mfrac><mi>J</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>≈</mo><mfrac><mrow><mi>J</mi><mo stretchy="false">(</mo><msub><mi>θ</mi><mn>1</mn></msub><mo>,</mo><msub><mi>θ</mi><mn>2</mn></msub><mo>+</mo><mi>ε</mi><mo>,</mo><msub><mi>θ</mi><mn>3</mn></msub><mo>,</mo><mo>⋯</mo><mo>,</mo><msub><mi>θ</mi><mi>n</mi></msub><mo stretchy="false">)</mo><mo>−</mo><mi>J</mi><mo stretchy="false">(</mo><msub><mi>θ</mi><mn>1</mn></msub><mo>,</mo><msub><mi>θ</mi><mn>2</mn></msub><mo>−</mo><mi>ε</mi><mo>,</mo><msub><mi>θ</mi><mn>3</mn></msub><mo>,</mo><mo>⋯</mo><mo>,</mo><msub><mi>θ</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow><mrow><mn>2</mn><mi>ε</mi></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-3966">\frac{\partial}{\partial \theta_2}J(\theta) \approx \frac{J(\theta_1, \theta_2 + \varepsilon, \theta_3, \cdots, \theta_n) - J(\theta_1, \theta_2 - \varepsilon, \theta_3, \cdots, \theta_n)}{2\varepsilon}</script> <br>
　<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3967-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo>&amp;#x22EE;</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1092" style="width: 0.315em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.26em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.783em, 1000.18em, 2.426em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-1093"><span class="mo" id="MathJax-Span-1094" style="font-family: MathJax_Main;">⋮</span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.099em; border-left: 0px solid; width: 0px; height: 1.721em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>⋮</mo></math></span></span><script type="math/tex" id="MathJax-Element-3967">\vdots</script> <br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3968-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mfrac><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><msub><mi>&amp;#x03B8;</mi><mn>2</mn></msub></mrow></mfrac><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2248;</mo><mfrac><mrow><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>&amp;#x03B8;</mi><mn>1</mn></msub><mo>,</mo><msub><mi>&amp;#x03B8;</mi><mn>2</mn></msub><mo>,</mo><msub><mi>&amp;#x03B8;</mi><mn>3</mn></msub><mo>,</mo><mo>&amp;#x22EF;</mo><mo>,</mo><msub><mi>&amp;#x03B8;</mi><mi>n</mi></msub><mo>+</mo><mi>&amp;#x03B5;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>&amp;#x03B8;</mi><mn>1</mn></msub><mo>,</mo><msub><mi>&amp;#x03B8;</mi><mn>2</mn></msub><mo>,</mo><msub><mi>&amp;#x03B8;</mi><mn>3</mn></msub><mo>,</mo><mo>&amp;#x22EF;</mo><mo>,</mo><msub><mi>&amp;#x03B8;</mi><mi>n</mi></msub><mo>&amp;#x2212;</mo><mi>&amp;#x03B5;</mi><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><mn>2</mn><mi>&amp;#x03B5;</mi></mrow></mfrac></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1095" style="width: 21.201em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.656em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.021em, 1017.66em, 2.967em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-1096"><span class="mfrac" id="MathJax-Span-1097"><span style="display: inline-block; position: relative; width: 1.155em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.349em, 1000.4em, 4.182em, -1000em); top: -4.434em; left: 50%; margin-left: -0.2em;"><span class="mi" id="MathJax-Span-1098" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.349em, 1001.04em, 4.273em, -1000em); top: -3.597em; left: 50%; margin-left: -0.517em;"><span class="mrow" id="MathJax-Span-1099"><span class="mi" id="MathJax-Span-1100" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span class="msubsup" id="MathJax-Span-1101"><span style="display: inline-block; position: relative; width: 0.635em; height: 0px;"><span style="position: absolute; clip: rect(3.356em, 1000.33em, 4.174em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-1102" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.904em; left: 0.332em;"><span class="mn" id="MathJax-Span-1103" style="font-size: 50%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1001.16em, 1.198em, -1000em); top: -1.262em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.155em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span><span class="mi" id="MathJax-Span-1104" style="font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.078em;"></span></span><span class="mo" id="MathJax-Span-1105" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1106" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="mo" id="MathJax-Span-1107" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1108" style="font-family: MathJax_Main; padding-left: 0.278em;">≈</span><span class="mfrac" id="MathJax-Span-1109" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 12.832em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.324em, 1012.65em, 4.343em, -1000em); top: -4.595em; left: 50%; margin-left: -6.356em;"><span class="mrow" id="MathJax-Span-1110"><span class="mi" id="MathJax-Span-1111" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span class="mo" id="MathJax-Span-1112" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1113"><span style="display: inline-block; position: relative; width: 0.635em; height: 0px;"><span style="position: absolute; clip: rect(3.356em, 1000.33em, 4.174em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-1114" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.904em; left: 0.332em;"><span class="mn" id="MathJax-Span-1115" style="font-size: 50%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-1116" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1117"><span style="display: inline-block; position: relative; width: 0.635em; height: 0px;"><span style="position: absolute; clip: rect(3.356em, 1000.33em, 4.174em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-1118" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.904em; left: 0.332em;"><span class="mn" id="MathJax-Span-1119" style="font-size: 50%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-1120" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1121"><span style="display: inline-block; position: relative; width: 0.635em; height: 0px;"><span style="position: absolute; clip: rect(3.356em, 1000.33em, 4.174em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-1122" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.904em; left: 0.332em;"><span class="mn" id="MathJax-Span-1123" style="font-size: 50%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-1124" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-1125" style="font-size: 70.7%; font-family: MathJax_Main;">⋯</span><span class="mo" id="MathJax-Span-1126" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1127"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; clip: rect(3.356em, 1000.33em, 4.174em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-1128" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.904em; left: 0.332em;"><span class="mi" id="MathJax-Span-1129" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-1130" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-1131" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">ε</span><span class="mo" id="MathJax-Span-1132" style="font-size: 70.7%; font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1133" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-1134" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span class="mo" id="MathJax-Span-1135" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1136"><span style="display: inline-block; position: relative; width: 0.635em; height: 0px;"><span style="position: absolute; clip: rect(3.356em, 1000.33em, 4.174em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-1137" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.904em; left: 0.332em;"><span class="mn" id="MathJax-Span-1138" style="font-size: 50%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-1139" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1140"><span style="display: inline-block; position: relative; width: 0.635em; height: 0px;"><span style="position: absolute; clip: rect(3.356em, 1000.33em, 4.174em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-1141" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.904em; left: 0.332em;"><span class="mn" id="MathJax-Span-1142" style="font-size: 50%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-1143" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1144"><span style="display: inline-block; position: relative; width: 0.635em; height: 0px;"><span style="position: absolute; clip: rect(3.356em, 1000.33em, 4.174em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-1145" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.904em; left: 0.332em;"><span class="mn" id="MathJax-Span-1146" style="font-size: 50%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-1147" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-1148" style="font-size: 70.7%; font-family: MathJax_Main;">⋯</span><span class="mo" id="MathJax-Span-1149" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1150"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; clip: rect(3.356em, 1000.33em, 4.174em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-1151" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.904em; left: 0.332em;"><span class="mi" id="MathJax-Span-1152" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-1153" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-1154" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">ε</span><span class="mo" id="MathJax-Span-1155" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.383em, 1000.66em, 4.182em, -1000em); top: -3.632em; left: 50%; margin-left: -0.342em;"><span class="mrow" id="MathJax-Span-1156"><span class="mn" id="MathJax-Span-1157" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-1158" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">ε</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1012.83em, 1.198em, -1000em); top: -1.262em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 12.832em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.686em; border-left: 0px solid; width: 0px; height: 2.086em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msub><mi>θ</mi><mn>2</mn></msub></mrow></mfrac><mi>J</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>≈</mo><mfrac><mrow><mi>J</mi><mo stretchy="false">(</mo><msub><mi>θ</mi><mn>1</mn></msub><mo>,</mo><msub><mi>θ</mi><mn>2</mn></msub><mo>,</mo><msub><mi>θ</mi><mn>3</mn></msub><mo>,</mo><mo>⋯</mo><mo>,</mo><msub><mi>θ</mi><mi>n</mi></msub><mo>+</mo><mi>ε</mi><mo stretchy="false">)</mo><mo>−</mo><mi>J</mi><mo stretchy="false">(</mo><msub><mi>θ</mi><mn>1</mn></msub><mo>,</mo><msub><mi>θ</mi><mn>2</mn></msub><mo>,</mo><msub><mi>θ</mi><mn>3</mn></msub><mo>,</mo><mo>⋯</mo><mo>,</mo><msub><mi>θ</mi><mi>n</mi></msub><mo>−</mo><mi>ε</mi><mo stretchy="false">)</mo></mrow><mrow><mn>2</mn><mi>ε</mi></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-3968">\frac{\partial}{\partial \theta_2}J(\theta) \approx \frac{J(\theta_1, \theta_2, \theta_3, \cdots, \theta_n + \varepsilon) - J(\theta_1, \theta_2, \theta_3, \cdots, \theta_n - \varepsilon)}{2\varepsilon}</script></p>

<p>给出伪代码形式如下 <br>
<img src="https://img-blog.csdn.net/20170514181822414?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjcwMDgwNzk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述" title=""> <br>
记住检测梯度的代码检测后要删去，不能用来训练数据集，会很慢。</p>

<p></p> <br>


<h2 id="15-random-initalization"><a name="t5"></a>1.5 Random initalization</h2>

<p>在调用梯度下降法和先进的优化算法时，我们需要给出初始值 <br>
想一想，我们能和以往一样给初始值设为全0吗？</p>

<p>不行，根据正向传播算法，如果初始值都一样，则每层的单元值<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3802-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi>a</mi><mi>i</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>l</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1159" style="width: 1.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.354em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.98em, 1001.35em, 2.654em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-1160"><span class="msubsup" id="MathJax-Span-1161"><span style="display: inline-block; position: relative; width: 1.365em; height: 0px;"><span style="position: absolute; clip: rect(3.413em, 1000.51em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-1162" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.324em, 1000.84em, 4.343em, -1000em); top: -4.532em; left: 0.529em;"><span class="texatom" id="MathJax-Span-1163"><span class="mrow" id="MathJax-Span-1164"><span class="mo" id="MathJax-Span-1165" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1166" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">l</span><span class="mo" id="MathJax-Span-1167" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.387em, 1000.32em, 4.174em, -1000em); top: -3.707em; left: 0.529em;"><span class="mi" id="MathJax-Span-1168" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.435em; border-left: 0px solid; width: 0px; height: 1.76em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>a</mi><mi>i</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>l</mi><mo stretchy="false">)</mo></mrow></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-3802">a^{(l)}_i</script>会相同 <br>
同样，根据反向传播算法，每个<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3803-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi>&amp;#x03B4;</mi><mi>i</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>l</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1169" style="width: 1.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.354em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.98em, 1001.35em, 2.654em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-1170"><span class="msubsup" id="MathJax-Span-1171"><span style="display: inline-block; position: relative; width: 1.339em; height: 0px;"><span style="position: absolute; clip: rect(3.137em, 1000.45em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-1172" style="font-family: MathJax_Math; font-style: italic;">δ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.324em, 1000.84em, 4.343em, -1000em); top: -4.532em; left: 0.503em;"><span class="texatom" id="MathJax-Span-1173"><span class="mrow" id="MathJax-Span-1174"><span class="mo" id="MathJax-Span-1175" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1176" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">l</span><span class="mo" id="MathJax-Span-1177" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.387em, 1000.32em, 4.174em, -1000em); top: -3.707em; left: 0.444em;"><span class="mi" id="MathJax-Span-1178" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.435em; border-left: 0px solid; width: 0px; height: 1.76em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>δ</mi><mi>i</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>l</mi><mo stretchy="false">)</mo></mrow></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-3803">\delta^{(l)}_i</script>会相同</p>

<p>如此一来，每次更新后，输入到每层的各个单元值相同。</p>

<p><strong>采用随机初始化</strong> <br>
<img src="https://img-blog.csdn.net/20170514195422879?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjcwMDgwNzk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述" title=""> <br>
初始化<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3804-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mi>j</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>l</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1179" style="width: 1.565em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.302em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.98em, 1001.3em, 2.791em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-1180"><span class="msubsup" id="MathJax-Span-1181"><span style="display: inline-block; position: relative; width: 1.305em; height: 0px;"><span style="position: absolute; clip: rect(3.149em, 1000.46em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-1182" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.324em, 1000.84em, 4.343em, -1000em); top: -4.532em; left: 0.469em;"><span class="texatom" id="MathJax-Span-1183"><span class="mrow" id="MathJax-Span-1184"><span class="mo" id="MathJax-Span-1185" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1186" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">l</span><span class="mo" id="MathJax-Span-1187" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.387em, 1000.61em, 4.311em, -1000em); top: -3.707em; left: 0.469em;"><span class="texatom" id="MathJax-Span-1188"><span class="mrow" id="MathJax-Span-1189"><span class="mi" id="MathJax-Span-1190" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-1191" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.599em; border-left: 0px solid; width: 0px; height: 1.924em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>l</mi><mo stretchy="false">)</mo></mrow></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-3804">\theta^{(l)}_{ij}</script>范围为<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3805-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>[</mo><mo>&amp;#x2212;</mo><mi>&amp;#x03B5;</mi><mo>,</mo><mo>+</mo><mi>&amp;#x03B5;</mi><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1192" style="width: 4.221em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.49em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.385em, 1003.37em, 2.698em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-1193"><span class="mo" id="MathJax-Span-1194" style="font-family: MathJax_Main;">[</span><span class="mo" id="MathJax-Span-1195" style="font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-1196" style="font-family: MathJax_Math; font-style: italic;">ε</span><span class="mo" id="MathJax-Span-1197" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-1198" style="font-family: MathJax_Main; padding-left: 0.167em;">+</span><span class="mi" id="MathJax-Span-1199" style="font-family: MathJax_Math; font-style: italic;">ε</span><span class="mo" id="MathJax-Span-1200" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.362em; border-left: 0px solid; width: 0px; height: 1.325em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mo>−</mo><mi>ε</mi><mo>,</mo><mo>+</mo><mi>ε</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-3805">[-\varepsilon, +\varepsilon]</script></p>



<h2 id="2-程序代码"><a name="t6"></a>2. 程序代码</h2>

<p>这次的程序和上周目的一致，都是手写数字识别，不过这周的代码要求自己训练出<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3973-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B8;</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1201" style="width: 0.576em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.469em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.43em, 1000.46em, 2.458em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-1202"><span class="mi" id="MathJax-Span-1203" style="font-family: MathJax_Math; font-style: italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.074em; border-left: 0px solid; width: 0px; height: 0.983em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-3973">\theta</script>值</p>

<p><strong>ex4.m</strong></p>

<pre class="prettyprint"><code class="language-matlab hljs  has-numbering"><span class="hljs-comment">%% Machine Learning Online Class - Exercise 4 Neural Network Learning</span>

<span class="hljs-comment">%  Instructions</span>
<span class="hljs-comment">%  ------------</span>
<span class="hljs-comment">% </span>
<span class="hljs-comment">%  This file contains code that helps you get started on the</span>
<span class="hljs-comment">%  linear exercise. You will need to complete the following functions </span>
<span class="hljs-comment">%  in this exericse:</span>
<span class="hljs-comment">%</span>
<span class="hljs-comment">%     sigmoidGradient.m</span>
<span class="hljs-comment">%     randInitializeWeights.m</span>
<span class="hljs-comment">%     nnCostFunction.m</span>
<span class="hljs-comment">%</span>
<span class="hljs-comment">%  For this exercise, you will not need to change any code in this file,</span>
<span class="hljs-comment">%  or any other files other than those mentioned above.</span>
<span class="hljs-comment">%</span>

<span class="hljs-comment">%% Initialization</span>
clear ; close all; clc

<span class="hljs-comment">%% Setup the parameters you will use for this exercise</span>
input_layer_size  = <span class="hljs-number">400</span>;  <span class="hljs-comment">% 20x20 Input Images of Digits</span>
hidden_layer_size = <span class="hljs-number">25</span>;   <span class="hljs-comment">% 25 hidden units</span>
num_labels = <span class="hljs-number">10</span>;          <span class="hljs-comment">% 10 labels, from 1 to 10   </span>
                          <span class="hljs-comment">% (note that we have mapped "0" to label 10)</span>

<span class="hljs-comment">%% =========== Part 1: Loading and Visualizing Data =============</span>
<span class="hljs-comment">%  We start the exercise by first loading and visualizing the dataset. </span>
<span class="hljs-comment">%  You will be working with a dataset that contains handwritten digits.</span>
<span class="hljs-comment">%</span>

<span class="hljs-comment">% Load Training Data</span>
fprintf(<span class="hljs-string">'Loading and Visualizing Data ...\n'</span>)

load(<span class="hljs-string">'ex4data1.mat'</span>);
m = <span class="hljs-built_in">size</span>(X, <span class="hljs-number">1</span>);

<span class="hljs-comment">% Randomly select 100 data points to display</span>
sel = randperm(<span class="hljs-built_in">size</span>(X, <span class="hljs-number">1</span>));
sel = sel(<span class="hljs-number">1</span>:<span class="hljs-number">100</span>);

displayData(X(sel, :));

fprintf(<span class="hljs-string">'Program paused. Press enter to continue.\n'</span>);
pause;


<span class="hljs-comment">%% ================ Part 2: Loading Parameters ================</span>
<span class="hljs-comment">% In this part of the exercise, we load some pre-initialized </span>
<span class="hljs-comment">% neural network parameters.</span>

fprintf(<span class="hljs-string">'\nLoading Saved Neural Network Parameters ...\n'</span>)

<span class="hljs-comment">% Load the weights into variables Theta1 and Theta2</span>
load(<span class="hljs-string">'ex4weights.mat'</span>);

<span class="hljs-comment">% Unroll parameters </span>
nn_params = <span class="hljs-matrix">[Theta1(:) ; Theta2(:)]</span>;

<span class="hljs-comment">%% ================ Part 3: Compute Cost (Feedforward) ================</span>
<span class="hljs-comment">%  To the neural network, you should first start by implementing the</span>
<span class="hljs-comment">%  feedforward part of the neural network that returns the cost only. You</span>
<span class="hljs-comment">%  should complete the code in nnCostFunction.m to return cost. After</span>
<span class="hljs-comment">%  implementing the feedforward to compute the cost, you can verify that</span>
<span class="hljs-comment">%  your implementation is correct by verifying that you get the same cost</span>
<span class="hljs-comment">%  as us for the fixed debugging parameters.</span>
<span class="hljs-comment">%</span>
<span class="hljs-comment">%  We suggest implementing the feedforward cost *without* regularization</span>
<span class="hljs-comment">%  first so that it will be easier for you to debug. Later, in part 4, you</span>
<span class="hljs-comment">%  will get to implement the regularized cost.</span>
<span class="hljs-comment">%</span>
fprintf(<span class="hljs-string">'\nFeedforward Using Neural Network ...\n'</span>)

<span class="hljs-comment">% Weight regularization parameter (we set this to 0 here).</span>
lambda = <span class="hljs-number">0</span>;

J = nnCostFunction(nn_params, input_layer_size, hidden_layer_size, ...
                   num_labels, X, y, lambda);

fprintf(<span class="hljs-matrix">[<span class="hljs-string">'Cost at parameters (loaded from ex4weights): %f '</span>...
         <span class="hljs-string">'\n(this value should be about 0.287629)\n'</span>]</span>, J);

fprintf(<span class="hljs-string">'\nProgram paused. Press enter to continue.\n'</span>);
pause;

<span class="hljs-comment">%% =============== Part 4: Implement Regularization ===============</span>
<span class="hljs-comment">%  Once your cost function implementation is correct, you should now</span>
<span class="hljs-comment">%  continue to implement the regularization with the cost.</span>
<span class="hljs-comment">%</span>

fprintf(<span class="hljs-string">'\nChecking Cost Function (w/ Regularization) ... \n'</span>)

<span class="hljs-comment">% Weight regularization parameter (we set this to 1 here).</span>
lambda = <span class="hljs-number">1</span>;

J = nnCostFunction(nn_params, input_layer_size, hidden_layer_size, ...
                   num_labels, X, y, lambda);

fprintf(<span class="hljs-matrix">[<span class="hljs-string">'Cost at parameters (loaded from ex4weights): %f '</span>...
         <span class="hljs-string">'\n(this value should be about 0.383770)\n'</span>]</span>, J);

fprintf(<span class="hljs-string">'Program paused. Press enter to continue.\n'</span>);
pause;


<span class="hljs-comment">%% ================ Part 5: Sigmoid Gradient  ================</span>
<span class="hljs-comment">%  Before you start implementing the neural network, you will first</span>
<span class="hljs-comment">%  implement the gradient for the sigmoid function. You should complete the</span>
<span class="hljs-comment">%  code in the sigmoidGradient.m file.</span>
<span class="hljs-comment">%</span>

fprintf(<span class="hljs-string">'\nEvaluating sigmoid gradient...\n'</span>)

g = sigmoidGradient(<span class="hljs-matrix">[-<span class="hljs-number">1</span> -<span class="hljs-number">0.5</span> <span class="hljs-number">0</span> <span class="hljs-number">0.5</span> <span class="hljs-number">1</span>]</span>);
fprintf(<span class="hljs-string">'Sigmoid gradient evaluated at [-1 -0.5 0 0.5 1]:\n  '</span>);
fprintf(<span class="hljs-string">'%f '</span>, g);
fprintf(<span class="hljs-string">'\n\n'</span>);

fprintf(<span class="hljs-string">'Program paused. Press enter to continue.\n'</span>);
pause;


<span class="hljs-comment">%% ================ Part 6: Initializing Pameters ================</span>
<span class="hljs-comment">%  In this part of the exercise, you will be starting to implment a two</span>
<span class="hljs-comment">%  layer neural network that classifies digits. You will start by</span>
<span class="hljs-comment">%  implementing a function to initialize the weights of the neural network</span>
<span class="hljs-comment">%  (randInitializeWeights.m)</span>

fprintf(<span class="hljs-string">'\nInitializing Neural Network Parameters ...\n'</span>)

initial_Theta1 = randInitializeWeights(input_layer_size, hidden_layer_size);
initial_Theta2 = randInitializeWeights(hidden_layer_size, num_labels);

<span class="hljs-comment">% Unroll parameters</span>
initial_nn_params = <span class="hljs-matrix">[initial_Theta1(:) ; initial_Theta2(:)]</span>;


<span class="hljs-comment">%% =============== Part 7: Implement Backpropagation ===============</span>
<span class="hljs-comment">%  Once your cost matches up with ours, you should proceed to implement the</span>
<span class="hljs-comment">%  backpropagation algorithm for the neural network. You should add to the</span>
<span class="hljs-comment">%  code you've written in nnCostFunction.m to return the partial</span>
<span class="hljs-comment">%  derivatives of the parameters.</span>
<span class="hljs-comment">%</span>
fprintf(<span class="hljs-string">'\nChecking Backpropagation... \n'</span>);

<span class="hljs-comment">%  Check gradients by running checkNNGradients</span>
checkNNGradients;

fprintf(<span class="hljs-string">'\nProgram paused. Press enter to continue.\n'</span>);
pause;


<span class="hljs-comment">%% =============== Part 8: Implement Regularization ===============</span>
<span class="hljs-comment">%  Once your backpropagation implementation is correct, you should now</span>
<span class="hljs-comment">%  continue to implement the regularization with the cost and gradient.</span>
<span class="hljs-comment">%</span>

fprintf(<span class="hljs-string">'\nChecking Backpropagation (w/ Regularization) ... \n'</span>)

<span class="hljs-comment">%  Check gradients by running checkNNGradients</span>
lambda = <span class="hljs-number">3</span>;
checkNNGradients(lambda);

<span class="hljs-comment">% Also output the costFunction debugging values</span>
debug_J  = nnCostFunction(nn_params, input_layer_size, ...
                          hidden_layer_size, num_labels, X, y, lambda);

fprintf(<span class="hljs-matrix">[<span class="hljs-string">'\n\nCost at (fixed) debugging parameters (w/ lambda = %f): %f '</span> ...
         <span class="hljs-string">'\n(for lambda = 3, this value should be about 0.576051)\n\n'</span>]</span>, lambda, debug_J);

fprintf(<span class="hljs-string">'Program paused. Press enter to continue.\n'</span>);
pause;


<span class="hljs-comment">%% =================== Part 8: Training NN ===================</span>
<span class="hljs-comment">%  You have now implemented all the code necessary to train a neural </span>
<span class="hljs-comment">%  network. To train your neural network, we will now use "fmincg", which</span>
<span class="hljs-comment">%  is a function which works similarly to "fminunc". Recall that these</span>
<span class="hljs-comment">%  advanced optimizers are able to train our cost functions efficiently as</span>
<span class="hljs-comment">%  long as we provide them with the gradient computations.</span>
<span class="hljs-comment">%</span>
fprintf(<span class="hljs-string">'\nTraining Neural Network... \n'</span>)

<span class="hljs-comment">%  After you have completed the assignment, change the MaxIter to a larger</span>
<span class="hljs-comment">%  value to see how more training helps.</span>
options = optimset(<span class="hljs-string">'MaxIter'</span>, <span class="hljs-number">50</span>);

<span class="hljs-comment">%  You should also try different values of lambda</span>
lambda = <span class="hljs-number">1</span>;

<span class="hljs-comment">% Create "short hand" for the cost function to be minimized</span>
costFunction = @(p) nnCostFunction(p, ...
                                   input_layer_size, ...
                                   hidden_layer_size, ...
                                   num_labels, X, y, lambda);

<span class="hljs-comment">% Now, costFunction is a function that takes in only one argument (the</span>
<span class="hljs-comment">% neural network parameters)</span>
<span class="hljs-matrix">[nn_params, cost]</span> = fmincg(costFunction, initial_nn_params, options);

<span class="hljs-comment">% Obtain Theta1 and Theta2 back from nn_params</span>
Theta1 = <span class="hljs-built_in">reshape</span>(nn_params(<span class="hljs-number">1</span>:hidden_layer_size * (input_layer_size + <span class="hljs-number">1</span>)), ...
                 hidden_layer_size, (input_layer_size + <span class="hljs-number">1</span>));

Theta2 = <span class="hljs-built_in">reshape</span>(nn_params((<span class="hljs-number">1</span> + (hidden_layer_size * (input_layer_size + <span class="hljs-number">1</span>))):<span class="hljs-keyword">end</span>), ...
                 num_labels, (hidden_layer_size + <span class="hljs-number">1</span>));

fprintf(<span class="hljs-string">'Program paused. Press enter to continue.\n'</span>);
pause;


<span class="hljs-comment">%% ================= Part 9: Visualize Weights =================</span>
<span class="hljs-comment">%  You can now "visualize" what the neural network is learning by </span>
<span class="hljs-comment">%  displaying the hidden units to see what features they are capturing in </span>
<span class="hljs-comment">%  the data.</span>

fprintf(<span class="hljs-string">'\nVisualizing Neural Network... \n'</span>)

displayData(Theta1(:, <span class="hljs-number">2</span>:<span class="hljs-keyword">end</span>));

fprintf(<span class="hljs-string">'\nProgram paused. Press enter to continue.\n'</span>);
pause;

<span class="hljs-comment">%% ================= Part 10: Implement Predict =================</span>
<span class="hljs-comment">%  After training the neural network, we would like to use it to predict</span>
<span class="hljs-comment">%  the labels. You will now implement the "predict" function to use the</span>
<span class="hljs-comment">%  neural network to predict the labels of the training set. This lets</span>
<span class="hljs-comment">%  you compute the training set accuracy.</span>

pred = predict(Theta1, Theta2, X);

fprintf(<span class="hljs-string">'\nTraining Set Accuracy: %f\n'</span>, mean(double(pred == y)) * <span class="hljs-number">100</span>);</code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li><li style="color: rgb(153, 153, 153);">2</li><li style="color: rgb(153, 153, 153);">3</li><li style="color: rgb(153, 153, 153);">4</li><li style="color: rgb(153, 153, 153);">5</li><li style="color: rgb(153, 153, 153);">6</li><li style="color: rgb(153, 153, 153);">7</li><li style="color: rgb(153, 153, 153);">8</li><li style="color: rgb(153, 153, 153);">9</li><li style="color: rgb(153, 153, 153);">10</li><li style="color: rgb(153, 153, 153);">11</li><li style="color: rgb(153, 153, 153);">12</li><li style="color: rgb(153, 153, 153);">13</li><li style="color: rgb(153, 153, 153);">14</li><li style="color: rgb(153, 153, 153);">15</li><li style="color: rgb(153, 153, 153);">16</li><li style="color: rgb(153, 153, 153);">17</li><li style="color: rgb(153, 153, 153);">18</li><li style="color: rgb(153, 153, 153);">19</li><li style="color: rgb(153, 153, 153);">20</li><li style="color: rgb(153, 153, 153);">21</li><li style="color: rgb(153, 153, 153);">22</li><li style="color: rgb(153, 153, 153);">23</li><li style="color: rgb(153, 153, 153);">24</li><li style="color: rgb(153, 153, 153);">25</li><li style="color: rgb(153, 153, 153);">26</li><li style="color: rgb(153, 153, 153);">27</li><li style="color: rgb(153, 153, 153);">28</li><li style="color: rgb(153, 153, 153);">29</li><li style="color: rgb(153, 153, 153);">30</li><li style="color: rgb(153, 153, 153);">31</li><li style="color: rgb(153, 153, 153);">32</li><li style="color: rgb(153, 153, 153);">33</li><li style="color: rgb(153, 153, 153);">34</li><li style="color: rgb(153, 153, 153);">35</li><li style="color: rgb(153, 153, 153);">36</li><li style="color: rgb(153, 153, 153);">37</li><li style="color: rgb(153, 153, 153);">38</li><li style="color: rgb(153, 153, 153);">39</li><li style="color: rgb(153, 153, 153);">40</li><li style="color: rgb(153, 153, 153);">41</li><li style="color: rgb(153, 153, 153);">42</li><li style="color: rgb(153, 153, 153);">43</li><li style="color: rgb(153, 153, 153);">44</li><li style="color: rgb(153, 153, 153);">45</li><li style="color: rgb(153, 153, 153);">46</li><li style="color: rgb(153, 153, 153);">47</li><li style="color: rgb(153, 153, 153);">48</li><li style="color: rgb(153, 153, 153);">49</li><li style="color: rgb(153, 153, 153);">50</li><li style="color: rgb(153, 153, 153);">51</li><li style="color: rgb(153, 153, 153);">52</li><li style="color: rgb(153, 153, 153);">53</li><li style="color: rgb(153, 153, 153);">54</li><li style="color: rgb(153, 153, 153);">55</li><li style="color: rgb(153, 153, 153);">56</li><li style="color: rgb(153, 153, 153);">57</li><li style="color: rgb(153, 153, 153);">58</li><li style="color: rgb(153, 153, 153);">59</li><li style="color: rgb(153, 153, 153);">60</li><li style="color: rgb(153, 153, 153);">61</li><li style="color: rgb(153, 153, 153);">62</li><li style="color: rgb(153, 153, 153);">63</li><li style="color: rgb(153, 153, 153);">64</li><li style="color: rgb(153, 153, 153);">65</li><li style="color: rgb(153, 153, 153);">66</li><li style="color: rgb(153, 153, 153);">67</li><li style="color: rgb(153, 153, 153);">68</li><li style="color: rgb(153, 153, 153);">69</li><li style="color: rgb(153, 153, 153);">70</li><li style="color: rgb(153, 153, 153);">71</li><li style="color: rgb(153, 153, 153);">72</li><li style="color: rgb(153, 153, 153);">73</li><li style="color: rgb(153, 153, 153);">74</li><li style="color: rgb(153, 153, 153);">75</li><li style="color: rgb(153, 153, 153);">76</li><li style="color: rgb(153, 153, 153);">77</li><li style="color: rgb(153, 153, 153);">78</li><li style="color: rgb(153, 153, 153);">79</li><li style="color: rgb(153, 153, 153);">80</li><li style="color: rgb(153, 153, 153);">81</li><li style="color: rgb(153, 153, 153);">82</li><li style="color: rgb(153, 153, 153);">83</li><li style="color: rgb(153, 153, 153);">84</li><li style="color: rgb(153, 153, 153);">85</li><li style="color: rgb(153, 153, 153);">86</li><li style="color: rgb(153, 153, 153);">87</li><li style="color: rgb(153, 153, 153);">88</li><li style="color: rgb(153, 153, 153);">89</li><li style="color: rgb(153, 153, 153);">90</li><li style="color: rgb(153, 153, 153);">91</li><li style="color: rgb(153, 153, 153);">92</li><li style="color: rgb(153, 153, 153);">93</li><li style="color: rgb(153, 153, 153);">94</li><li style="color: rgb(153, 153, 153);">95</li><li style="color: rgb(153, 153, 153);">96</li><li style="color: rgb(153, 153, 153);">97</li><li style="color: rgb(153, 153, 153);">98</li><li style="color: rgb(153, 153, 153);">99</li><li style="color: rgb(153, 153, 153);">100</li><li style="color: rgb(153, 153, 153);">101</li><li style="color: rgb(153, 153, 153);">102</li><li style="color: rgb(153, 153, 153);">103</li><li style="color: rgb(153, 153, 153);">104</li><li style="color: rgb(153, 153, 153);">105</li><li style="color: rgb(153, 153, 153);">106</li><li style="color: rgb(153, 153, 153);">107</li><li style="color: rgb(153, 153, 153);">108</li><li style="color: rgb(153, 153, 153);">109</li><li style="color: rgb(153, 153, 153);">110</li><li style="color: rgb(153, 153, 153);">111</li><li style="color: rgb(153, 153, 153);">112</li><li style="color: rgb(153, 153, 153);">113</li><li style="color: rgb(153, 153, 153);">114</li><li style="color: rgb(153, 153, 153);">115</li><li style="color: rgb(153, 153, 153);">116</li><li style="color: rgb(153, 153, 153);">117</li><li style="color: rgb(153, 153, 153);">118</li><li style="color: rgb(153, 153, 153);">119</li><li style="color: rgb(153, 153, 153);">120</li><li style="color: rgb(153, 153, 153);">121</li><li style="color: rgb(153, 153, 153);">122</li><li style="color: rgb(153, 153, 153);">123</li><li style="color: rgb(153, 153, 153);">124</li><li style="color: rgb(153, 153, 153);">125</li><li style="color: rgb(153, 153, 153);">126</li><li style="color: rgb(153, 153, 153);">127</li><li style="color: rgb(153, 153, 153);">128</li><li style="color: rgb(153, 153, 153);">129</li><li style="color: rgb(153, 153, 153);">130</li><li style="color: rgb(153, 153, 153);">131</li><li style="color: rgb(153, 153, 153);">132</li><li style="color: rgb(153, 153, 153);">133</li><li style="color: rgb(153, 153, 153);">134</li><li style="color: rgb(153, 153, 153);">135</li><li style="color: rgb(153, 153, 153);">136</li><li style="color: rgb(153, 153, 153);">137</li><li style="color: rgb(153, 153, 153);">138</li><li style="color: rgb(153, 153, 153);">139</li><li style="color: rgb(153, 153, 153);">140</li><li style="color: rgb(153, 153, 153);">141</li><li style="color: rgb(153, 153, 153);">142</li><li style="color: rgb(153, 153, 153);">143</li><li style="color: rgb(153, 153, 153);">144</li><li style="color: rgb(153, 153, 153);">145</li><li style="color: rgb(153, 153, 153);">146</li><li style="color: rgb(153, 153, 153);">147</li><li style="color: rgb(153, 153, 153);">148</li><li style="color: rgb(153, 153, 153);">149</li><li style="color: rgb(153, 153, 153);">150</li><li style="color: rgb(153, 153, 153);">151</li><li style="color: rgb(153, 153, 153);">152</li><li style="color: rgb(153, 153, 153);">153</li><li style="color: rgb(153, 153, 153);">154</li><li style="color: rgb(153, 153, 153);">155</li><li style="color: rgb(153, 153, 153);">156</li><li style="color: rgb(153, 153, 153);">157</li><li style="color: rgb(153, 153, 153);">158</li><li style="color: rgb(153, 153, 153);">159</li><li style="color: rgb(153, 153, 153);">160</li><li style="color: rgb(153, 153, 153);">161</li><li style="color: rgb(153, 153, 153);">162</li><li style="color: rgb(153, 153, 153);">163</li><li style="color: rgb(153, 153, 153);">164</li><li style="color: rgb(153, 153, 153);">165</li><li style="color: rgb(153, 153, 153);">166</li><li style="color: rgb(153, 153, 153);">167</li><li style="color: rgb(153, 153, 153);">168</li><li style="color: rgb(153, 153, 153);">169</li><li style="color: rgb(153, 153, 153);">170</li><li style="color: rgb(153, 153, 153);">171</li><li style="color: rgb(153, 153, 153);">172</li><li style="color: rgb(153, 153, 153);">173</li><li style="color: rgb(153, 153, 153);">174</li><li style="color: rgb(153, 153, 153);">175</li><li style="color: rgb(153, 153, 153);">176</li><li style="color: rgb(153, 153, 153);">177</li><li style="color: rgb(153, 153, 153);">178</li><li style="color: rgb(153, 153, 153);">179</li><li style="color: rgb(153, 153, 153);">180</li><li style="color: rgb(153, 153, 153);">181</li><li style="color: rgb(153, 153, 153);">182</li><li style="color: rgb(153, 153, 153);">183</li><li style="color: rgb(153, 153, 153);">184</li><li style="color: rgb(153, 153, 153);">185</li><li style="color: rgb(153, 153, 153);">186</li><li style="color: rgb(153, 153, 153);">187</li><li style="color: rgb(153, 153, 153);">188</li><li style="color: rgb(153, 153, 153);">189</li><li style="color: rgb(153, 153, 153);">190</li><li style="color: rgb(153, 153, 153);">191</li><li style="color: rgb(153, 153, 153);">192</li><li style="color: rgb(153, 153, 153);">193</li><li style="color: rgb(153, 153, 153);">194</li><li style="color: rgb(153, 153, 153);">195</li><li style="color: rgb(153, 153, 153);">196</li><li style="color: rgb(153, 153, 153);">197</li><li style="color: rgb(153, 153, 153);">198</li><li style="color: rgb(153, 153, 153);">199</li><li style="color: rgb(153, 153, 153);">200</li><li style="color: rgb(153, 153, 153);">201</li><li style="color: rgb(153, 153, 153);">202</li><li style="color: rgb(153, 153, 153);">203</li><li style="color: rgb(153, 153, 153);">204</li><li style="color: rgb(153, 153, 153);">205</li><li style="color: rgb(153, 153, 153);">206</li><li style="color: rgb(153, 153, 153);">207</li><li style="color: rgb(153, 153, 153);">208</li><li style="color: rgb(153, 153, 153);">209</li><li style="color: rgb(153, 153, 153);">210</li><li style="color: rgb(153, 153, 153);">211</li><li style="color: rgb(153, 153, 153);">212</li><li style="color: rgb(153, 153, 153);">213</li><li style="color: rgb(153, 153, 153);">214</li><li style="color: rgb(153, 153, 153);">215</li><li style="color: rgb(153, 153, 153);">216</li><li style="color: rgb(153, 153, 153);">217</li><li style="color: rgb(153, 153, 153);">218</li><li style="color: rgb(153, 153, 153);">219</li><li style="color: rgb(153, 153, 153);">220</li><li style="color: rgb(153, 153, 153);">221</li><li style="color: rgb(153, 153, 153);">222</li><li style="color: rgb(153, 153, 153);">223</li><li style="color: rgb(153, 153, 153);">224</li><li style="color: rgb(153, 153, 153);">225</li><li style="color: rgb(153, 153, 153);">226</li><li style="color: rgb(153, 153, 153);">227</li><li style="color: rgb(153, 153, 153);">228</li><li style="color: rgb(153, 153, 153);">229</li><li style="color: rgb(153, 153, 153);">230</li><li style="color: rgb(153, 153, 153);">231</li><li style="color: rgb(153, 153, 153);">232</li></ul></pre>

<p><strong>nnCostFunction.m</strong></p>

<pre class="prettyprint"><code class="language-matlab hljs  has-numbering"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">[J grad]</span> = <span class="hljs-title">nnCostFunction</span><span class="hljs-params">(nn_params, ...
                                   input_layer_size, ...
                                   hidden_layer_size, ...
                                   num_labels, ...
                                   X, y, lambda)</span></span>
<span class="hljs-comment">%NNCOSTFUNCTION Implements the neural network cost function for a two layer</span>
<span class="hljs-comment">%neural network which performs classification</span>
<span class="hljs-comment">%   [J grad] = NNCOSTFUNCTON(nn_params, hidden_layer_size, num_labels, ...</span>
<span class="hljs-comment">%   X, y, lambda) computes the cost and gradient of the neural network. The</span>
<span class="hljs-comment">%   parameters for the neural network are "unrolled" into the vector</span>
<span class="hljs-comment">%   nn_params and need to be converted back into the weight matrices. </span>
<span class="hljs-comment">% </span>
<span class="hljs-comment">%   The returned parameter grad should be a "unrolled" vector of the</span>
<span class="hljs-comment">%   partial derivatives of the neural network.</span>
<span class="hljs-comment">%</span>

<span class="hljs-comment">% Reshape nn_params back into the parameters Theta1 and Theta2, the weight matrices</span>
<span class="hljs-comment">% for our 2 layer neural network</span>
Theta1 = <span class="hljs-built_in">reshape</span>(nn_params(<span class="hljs-number">1</span>:hidden_layer_size * (input_layer_size + <span class="hljs-number">1</span>)), ...
                 hidden_layer_size, (input_layer_size + <span class="hljs-number">1</span>));

Theta2 = <span class="hljs-built_in">reshape</span>(nn_params((<span class="hljs-number">1</span> + (hidden_layer_size * (input_layer_size + <span class="hljs-number">1</span>))):<span class="hljs-keyword">end</span>), ...
                 num_labels, (hidden_layer_size + <span class="hljs-number">1</span>));

<span class="hljs-comment">% Setup some useful variables</span>
m = <span class="hljs-built_in">size</span>(X, <span class="hljs-number">1</span>);

<span class="hljs-comment">% You need to return the following variables correctly </span>
J = <span class="hljs-number">0</span>;
Theta1_grad = <span class="hljs-built_in">zeros</span>(<span class="hljs-built_in">size</span>(Theta1));
Theta2_grad = <span class="hljs-built_in">zeros</span>(<span class="hljs-built_in">size</span>(Theta2));

<span class="hljs-comment">% ====================== YOUR CODE HERE ======================</span>
<span class="hljs-comment">% Instructions: You should complete the code by working through the</span>
<span class="hljs-comment">%               following parts.</span>
<span class="hljs-comment">%</span>
<span class="hljs-comment">% Part 1: Feedforward the neural network and return the cost in the</span>
<span class="hljs-comment">%         variable J. After implementing Part 1, you can verify that your</span>
<span class="hljs-comment">%         cost function computation is correct by verifying the cost</span>
<span class="hljs-comment">%         computed in ex4.m</span>
<span class="hljs-comment">%</span>
<span class="hljs-comment">% Part 2: Implement the backpropagation algorithm to compute the gradients</span>
<span class="hljs-comment">%         Theta1_grad and Theta2_grad. You should return the partial derivatives of</span>
<span class="hljs-comment">%         the cost function with respect to Theta1 and Theta2 in Theta1_grad and</span>
<span class="hljs-comment">%         Theta2_grad, respectively. After implementing Part 2, you can check</span>
<span class="hljs-comment">%         that your implementation is correct by running checkNNGradients</span>
<span class="hljs-comment">%</span>
<span class="hljs-comment">%         Note: The vector y passed into the function is a vector of labels</span>
<span class="hljs-comment">%               containing values from 1..K. You need to map this vector into a </span>
<span class="hljs-comment">%               binary vector of 1's and 0's to be used with the neural network</span>
<span class="hljs-comment">%               cost function.</span>
<span class="hljs-comment">%</span>
<span class="hljs-comment">%         Hint: We recommend implementing backpropagation using a for-loop</span>
<span class="hljs-comment">%               over the training examples if you are implementing it for the </span>
<span class="hljs-comment">%               first time.</span>
<span class="hljs-comment">%</span>
<span class="hljs-comment">% Part 3: Implement regularization with the cost function and gradients.</span>
<span class="hljs-comment">%</span>
<span class="hljs-comment">%         Hint: You can implement this around the code for</span>
<span class="hljs-comment">%               backpropagation. That is, you can compute the gradients for</span>
<span class="hljs-comment">%               the regularization separately and then add them to Theta1_grad</span>
<span class="hljs-comment">%               and Theta2_grad from Part 2.</span>
<span class="hljs-comment">%</span>
X = <span class="hljs-matrix">[ones(m, <span class="hljs-number">1</span>) X]</span>;
ylabel = <span class="hljs-built_in">zeros</span>(num_labels, m);
<span class="hljs-keyword">for</span> <span class="hljs-built_in">i</span>=<span class="hljs-number">1</span>:m
    ylabel(y(<span class="hljs-built_in">i</span>), <span class="hljs-built_in">i</span>) = <span class="hljs-number">1</span>;
<span class="hljs-keyword">end</span>

z2 = X*<span class="hljs-transposed_variable">Theta1'</span>;
z2 = <span class="hljs-matrix">[ones(m, <span class="hljs-number">1</span>) z2]</span>;
a2 = sigmoid(X*<span class="hljs-transposed_variable">Theta1'</span>);
a2 = <span class="hljs-matrix">[ones(m, <span class="hljs-number">1</span>) a2]</span>;
a3 = sigmoid(a2*<span class="hljs-transposed_variable">Theta2'</span>);

<span class="hljs-keyword">for</span> <span class="hljs-built_in">i</span>=<span class="hljs-number">1</span>:m
    J = J - <span class="hljs-built_in">log</span>(a3(<span class="hljs-built_in">i</span>, :))*ylabel(:, <span class="hljs-built_in">i</span>) - (<span class="hljs-built_in">log</span>(<span class="hljs-number">1</span> - a3(<span class="hljs-built_in">i</span>, :)) * (<span class="hljs-number">1</span> - ylabel(:, <span class="hljs-built_in">i</span>)));
<span class="hljs-keyword">end</span>
J = J/m;

J = J + lambda/<span class="hljs-number">2</span>/m * (sum(sum(Theta1(:, <span class="hljs-number">2</span>:<span class="hljs-keyword">end</span>).^<span class="hljs-number">2</span>)) + sum(sum(Theta2(:, <span class="hljs-number">2</span>:<span class="hljs-keyword">end</span>).^<span class="hljs-number">2</span>)));

Delta1 = <span class="hljs-built_in">zeros</span>(<span class="hljs-built_in">size</span>(Theta1));
Delta2 = <span class="hljs-built_in">zeros</span>(<span class="hljs-built_in">size</span>(Theta2));
<span class="hljs-keyword">for</span> t = <span class="hljs-number">1</span>:m
    delta3 = a3(t, :)<span class="hljs-string">' - ylabel(:, t);
    delta2 = Theta2'</span>*delta3 .* sigmoidGradient(z2(t, :)<span class="hljs-string">');

    Delta1 = Delta1 + delta2(2:end) * X(t, :);
    Delta2 = Delta2 + delta3 * a2(t, :);
end

Theta1_grad = Delta1 / m;
Theta1_grad(:, 2:end) = Theta1_grad(:, 2:end) + lambda/m*Theta1(:, 2:end);
Theta2_grad = Delta2 / m;
Theta2_grad(:, 2:end) = Theta2_grad(:, 2:end) + lambda/m*Theta2(:, 2:end);
% -------------------------------------------------------------

% =========================================================================

% Unroll gradients

grad = [Theta1_grad(:) ; Theta2_grad(:)];

end
</span></code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li><li style="color: rgb(153, 153, 153);">2</li><li style="color: rgb(153, 153, 153);">3</li><li style="color: rgb(153, 153, 153);">4</li><li style="color: rgb(153, 153, 153);">5</li><li style="color: rgb(153, 153, 153);">6</li><li style="color: rgb(153, 153, 153);">7</li><li style="color: rgb(153, 153, 153);">8</li><li style="color: rgb(153, 153, 153);">9</li><li style="color: rgb(153, 153, 153);">10</li><li style="color: rgb(153, 153, 153);">11</li><li style="color: rgb(153, 153, 153);">12</li><li style="color: rgb(153, 153, 153);">13</li><li style="color: rgb(153, 153, 153);">14</li><li style="color: rgb(153, 153, 153);">15</li><li style="color: rgb(153, 153, 153);">16</li><li style="color: rgb(153, 153, 153);">17</li><li style="color: rgb(153, 153, 153);">18</li><li style="color: rgb(153, 153, 153);">19</li><li style="color: rgb(153, 153, 153);">20</li><li style="color: rgb(153, 153, 153);">21</li><li style="color: rgb(153, 153, 153);">22</li><li style="color: rgb(153, 153, 153);">23</li><li style="color: rgb(153, 153, 153);">24</li><li style="color: rgb(153, 153, 153);">25</li><li style="color: rgb(153, 153, 153);">26</li><li style="color: rgb(153, 153, 153);">27</li><li style="color: rgb(153, 153, 153);">28</li><li style="color: rgb(153, 153, 153);">29</li><li style="color: rgb(153, 153, 153);">30</li><li style="color: rgb(153, 153, 153);">31</li><li style="color: rgb(153, 153, 153);">32</li><li style="color: rgb(153, 153, 153);">33</li><li style="color: rgb(153, 153, 153);">34</li><li style="color: rgb(153, 153, 153);">35</li><li style="color: rgb(153, 153, 153);">36</li><li style="color: rgb(153, 153, 153);">37</li><li style="color: rgb(153, 153, 153);">38</li><li style="color: rgb(153, 153, 153);">39</li><li style="color: rgb(153, 153, 153);">40</li><li style="color: rgb(153, 153, 153);">41</li><li style="color: rgb(153, 153, 153);">42</li><li style="color: rgb(153, 153, 153);">43</li><li style="color: rgb(153, 153, 153);">44</li><li style="color: rgb(153, 153, 153);">45</li><li style="color: rgb(153, 153, 153);">46</li><li style="color: rgb(153, 153, 153);">47</li><li style="color: rgb(153, 153, 153);">48</li><li style="color: rgb(153, 153, 153);">49</li><li style="color: rgb(153, 153, 153);">50</li><li style="color: rgb(153, 153, 153);">51</li><li style="color: rgb(153, 153, 153);">52</li><li style="color: rgb(153, 153, 153);">53</li><li style="color: rgb(153, 153, 153);">54</li><li style="color: rgb(153, 153, 153);">55</li><li style="color: rgb(153, 153, 153);">56</li><li style="color: rgb(153, 153, 153);">57</li><li style="color: rgb(153, 153, 153);">58</li><li style="color: rgb(153, 153, 153);">59</li><li style="color: rgb(153, 153, 153);">60</li><li style="color: rgb(153, 153, 153);">61</li><li style="color: rgb(153, 153, 153);">62</li><li style="color: rgb(153, 153, 153);">63</li><li style="color: rgb(153, 153, 153);">64</li><li style="color: rgb(153, 153, 153);">65</li><li style="color: rgb(153, 153, 153);">66</li><li style="color: rgb(153, 153, 153);">67</li><li style="color: rgb(153, 153, 153);">68</li><li style="color: rgb(153, 153, 153);">69</li><li style="color: rgb(153, 153, 153);">70</li><li style="color: rgb(153, 153, 153);">71</li><li style="color: rgb(153, 153, 153);">72</li><li style="color: rgb(153, 153, 153);">73</li><li style="color: rgb(153, 153, 153);">74</li><li style="color: rgb(153, 153, 153);">75</li><li style="color: rgb(153, 153, 153);">76</li><li style="color: rgb(153, 153, 153);">77</li><li style="color: rgb(153, 153, 153);">78</li><li style="color: rgb(153, 153, 153);">79</li><li style="color: rgb(153, 153, 153);">80</li><li style="color: rgb(153, 153, 153);">81</li><li style="color: rgb(153, 153, 153);">82</li><li style="color: rgb(153, 153, 153);">83</li><li style="color: rgb(153, 153, 153);">84</li><li style="color: rgb(153, 153, 153);">85</li><li style="color: rgb(153, 153, 153);">86</li><li style="color: rgb(153, 153, 153);">87</li><li style="color: rgb(153, 153, 153);">88</li><li style="color: rgb(153, 153, 153);">89</li><li style="color: rgb(153, 153, 153);">90</li><li style="color: rgb(153, 153, 153);">91</li><li style="color: rgb(153, 153, 153);">92</li><li style="color: rgb(153, 153, 153);">93</li><li style="color: rgb(153, 153, 153);">94</li><li style="color: rgb(153, 153, 153);">95</li><li style="color: rgb(153, 153, 153);">96</li><li style="color: rgb(153, 153, 153);">97</li><li style="color: rgb(153, 153, 153);">98</li><li style="color: rgb(153, 153, 153);">99</li><li style="color: rgb(153, 153, 153);">100</li><li style="color: rgb(153, 153, 153);">101</li><li style="color: rgb(153, 153, 153);">102</li><li style="color: rgb(153, 153, 153);">103</li><li style="color: rgb(153, 153, 153);">104</li><li style="color: rgb(153, 153, 153);">105</li><li style="color: rgb(153, 153, 153);">106</li></ul></pre>

<p><strong>sigmoidGradient.m</strong></p>



<pre class="prettyprint"><code class="language-matlab hljs  has-numbering"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">g</span> = <span class="hljs-title">sigmoidGradient</span><span class="hljs-params">(z)</span></span>
<span class="hljs-comment">%SIGMOIDGRADIENT returns the gradient of the sigmoid function</span>
<span class="hljs-comment">%evaluated at z</span>
<span class="hljs-comment">%   g = SIGMOIDGRADIENT(z) computes the gradient of the sigmoid function</span>
<span class="hljs-comment">%   evaluated at z. This should work regardless if z is a matrix or a</span>
<span class="hljs-comment">%   vector. In particular, if z is a vector or matrix, you should return</span>
<span class="hljs-comment">%   the gradient for each element.</span>

g = <span class="hljs-built_in">zeros</span>(<span class="hljs-built_in">size</span>(z));

<span class="hljs-comment">% ====================== YOUR CODE HERE ======================</span>
<span class="hljs-comment">% Instructions: Compute the gradient of the sigmoid function evaluated at</span>
<span class="hljs-comment">%               each value of z (z can be a matrix, vector or scalar).</span>


g = sigmoid(z).*(<span class="hljs-number">1</span> - sigmoid(z));
<span class="hljs-comment">% =============================================================</span>

<span class="hljs-keyword">end</span>
</code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li><li style="color: rgb(153, 153, 153);">2</li><li style="color: rgb(153, 153, 153);">3</li><li style="color: rgb(153, 153, 153);">4</li><li style="color: rgb(153, 153, 153);">5</li><li style="color: rgb(153, 153, 153);">6</li><li style="color: rgb(153, 153, 153);">7</li><li style="color: rgb(153, 153, 153);">8</li><li style="color: rgb(153, 153, 153);">9</li><li style="color: rgb(153, 153, 153);">10</li><li style="color: rgb(153, 153, 153);">11</li><li style="color: rgb(153, 153, 153);">12</li><li style="color: rgb(153, 153, 153);">13</li><li style="color: rgb(153, 153, 153);">14</li><li style="color: rgb(153, 153, 153);">15</li><li style="color: rgb(153, 153, 153);">16</li><li style="color: rgb(153, 153, 153);">17</li><li style="color: rgb(153, 153, 153);">18</li><li style="color: rgb(153, 153, 153);">19</li><li style="color: rgb(153, 153, 153);">20</li></ul></pre>

<p><strong>randInitializeWeights.m</strong></p>

<pre class="prettyprint"><code class="language-matlab hljs  has-numbering"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">W</span> = <span class="hljs-title">randInitializeWeights</span><span class="hljs-params">(L_in, L_out)</span></span>
<span class="hljs-comment">%RANDINITIALIZEWEIGHTS Randomly initialize the weights of a layer with L_in</span>
<span class="hljs-comment">%incoming connections and L_out outgoing connections</span>
<span class="hljs-comment">%   W = RANDINITIALIZEWEIGHTS(L_in, L_out) randomly initializes the weights </span>
<span class="hljs-comment">%   of a layer with L_in incoming connections and L_out outgoing </span>
<span class="hljs-comment">%   connections. </span>
<span class="hljs-comment">%</span>
<span class="hljs-comment">%   Note that W should be set to a matrix of size(L_out, 1 + L_in) as</span>
<span class="hljs-comment">%   the first column of W handles the "bias" terms</span>
<span class="hljs-comment">%</span>

<span class="hljs-comment">% You need to return the following variables correctly </span>
W = <span class="hljs-built_in">zeros</span>(L_out, <span class="hljs-number">1</span> + L_in);

<span class="hljs-comment">% ====================== YOUR CODE HERE ======================</span>
<span class="hljs-comment">% Instructions: Initialize W randomly so that we break the symmetry while</span>
<span class="hljs-comment">%               training the neural network.</span>
<span class="hljs-comment">%</span>
<span class="hljs-comment">% Note: The first column of W corresponds to the parameters for the bias unit</span>
<span class="hljs-comment">%</span>

epsilon = <span class="hljs-number">0.12</span>;
W = <span class="hljs-built_in">rand</span>(L_out, <span class="hljs-number">1</span>+L_in)*<span class="hljs-number">2</span>*epsilon - epsilon;


<span class="hljs-comment">% =========================================================================</span>

<span class="hljs-keyword">end</span>
</code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li><li style="color: rgb(153, 153, 153);">2</li><li style="color: rgb(153, 153, 153);">3</li><li style="color: rgb(153, 153, 153);">4</li><li style="color: rgb(153, 153, 153);">5</li><li style="color: rgb(153, 153, 153);">6</li><li style="color: rgb(153, 153, 153);">7</li><li style="color: rgb(153, 153, 153);">8</li><li style="color: rgb(153, 153, 153);">9</li><li style="color: rgb(153, 153, 153);">10</li><li style="color: rgb(153, 153, 153);">11</li><li style="color: rgb(153, 153, 153);">12</li><li style="color: rgb(153, 153, 153);">13</li><li style="color: rgb(153, 153, 153);">14</li><li style="color: rgb(153, 153, 153);">15</li><li style="color: rgb(153, 153, 153);">16</li><li style="color: rgb(153, 153, 153);">17</li><li style="color: rgb(153, 153, 153);">18</li><li style="color: rgb(153, 153, 153);">19</li><li style="color: rgb(153, 153, 153);">20</li><li style="color: rgb(153, 153, 153);">21</li><li style="color: rgb(153, 153, 153);">22</li><li style="color: rgb(153, 153, 153);">23</li><li style="color: rgb(153, 153, 153);">24</li><li style="color: rgb(153, 153, 153);">25</li><li style="color: rgb(153, 153, 153);">26</li><li style="color: rgb(153, 153, 153);">27</li><li style="color: rgb(153, 153, 153);">28</li><li style="color: rgb(153, 153, 153);">29</li></ul></pre>

<p><img src="https://img-blog.csdn.net/20170514211837870?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjcwMDgwNzk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述" title=""></p>

<p><img src="https://img-blog.csdn.net/20170514211855699?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjcwMDgwNzk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述" title=""></p>                