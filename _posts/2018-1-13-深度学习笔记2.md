#深度学习笔记2


<h3 id="word-embeddings词嵌入"><a name="t1"></a>Word embeddings词嵌入</h3>

<p>让算法自动理解同类词。 <br>
之前我们将对词的表示用的是one-shot，这种方法简单，这种表示方法的一个缺点就是，它把每个词都孤立起来了，使得其对相关词的泛化能力不强，因为任意两个one-shot向量内积都为0 ，也就是任意两个词间的距离是一样的，没有词类的概念。 <br>
举个例子，若已经学习了I want a glass of orange juice“”很可能是一个句子，但再看到“I want a glass of apple __”的时候，因为不知道orange和Apple的相近关系，所以很难从已经学习到的句子学习到 orange juice和Apple juice都是和常见的词组</p>

<p><strong>词的特征化的表示：</strong> <br>
就是列举所有可能的特征，用这些特征的值来表示一个词。 <br>
<img src="https://img-blog.csdn.net/20180303172112456?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd2VpeGluXzQxMDQzMjQw/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述" title=""> <br>
如果学习了300维的特征，然后表示到2D空间可视化显示，可以看出如下效果： <br>
<img src="https://img-blog.csdn.net/20180303172119596?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd2VpeGluXzQxMDQzMjQw/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述" title=""> <br>
类似的词距离比较近，不同类的词距离比较远。</p>



<h1 id="2-using-word-embeddings"><a name="t2"></a>2. Using word embeddings</h1>

<p>以人名实体识别为例，给出一句话：Sally Johnson is an orange farmer。我们知道Sally Johnson应该是一个人名而不是公司名之类的，因为farmer必须为一个人。如果用一个基于词嵌入训练的模型，遇到另外一句Robert Lin is an apple farmer，因为知道橘子和苹果属于一类，那么就很容易推断出Robert Lin也是一个人名，一个比较有意思的情况，如果遇到很少见的词如Robert Lin is a durian cultivator，durian cultivator这两个词都是比较少见的，如果训练集里面没有这两个词，那么预测就会很困难，但是如果有一个学习好的词嵌入，它告诉我们durian属于水果，cultivator和farmer属于一类，那么就很容易能够判断出Robert Lin是一个人名。 <br>
词嵌入能达到这样的效果，是因为学习词嵌入的算法通常会考察非常大量的无标签文本库，如1亿甚至百亿单词，其来源可以是互联网文本，通常也是可以免费下载的，所以可以利用迁移学习使用词嵌入。</p>



<h3 id="基于词嵌入的迁移学习"><a name="t3"></a>基于词嵌入的迁移学习</h3>

<p>（1）从一个很大的文本集中学习词嵌入或从网上下载学习好的词嵌入； <br>
（2）将学习好的词嵌入应用到只有小量带标签的训练集的新任务当中； <br>
（3）可选步，决定是否根据新任务的训练集对词嵌入进行微调，当新任务的训练集较小的时候，不推荐花费精力调整词嵌入。 <br>
迁移学习对于训练集较小的任务比较有意义，所以目前词嵌入广泛应用于NLP，如名称识别、文本摘要、文本解析、parsing等标准的NLP任务，在语言模型、机器翻译等领域应用较少，因为这些任务中有大量的数据。</p>



<h3 id="词嵌入word-embadding和人脸编码face-encoding"><a name="t4"></a>词嵌入Word embadding和人脸编码face encoding</h3>

<p>Word embadding学习的是词的编码，而face encoding学习的是人脸或图像的编码，术语embedding和encoding是可以互换的，那么区别在哪里呢？ <br>
<strong>不同：</strong> <br>
face encoding学习的编码/特征没有范围限定，也就是预先不需要设置编码，所以任何输入都能学习他的编码； <br>
Word embadding则有一个固定的词汇表，所以学习的编码也是固定的。</p>



<h1 id="3-properties-of-word-embedding词嵌入的特性"><a name="t5"></a>3. Properties of word embedding词嵌入的特性</h1>

<p>词嵌入可以帮助实现类比推理。 <br>
<img src="https://img-blog.csdn.net/20180303215517666?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd2VpeGluXzQxMDQzMjQw/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述" title=""> <br>
上图是用词嵌入学习特征表示的几个词，man如果对应woman，那么king对应谁？如何让算法学习到这种推理关系？ <br>
（1）用编码向量表示各个词<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>m</mi><mi>a</mi><mi>n</mi></mrow></msub><mo>,</mo><msub><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>w</mi><mi>o</mi><mi>m</mi><mi>a</mi><mi>n</mi></mrow></msub><mo>,</mo><msub><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mi>i</mi><mi>n</mi><mi>g</mi></mrow></msub><mo>,</mo><msub><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>q</mi><mi>u</mi><mi>e</mi><mi>e</mi><mi>n</mi></mrow></msub><mo>.</mo><mo>.</mo><mo>.</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 13.909em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.563em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.641em, 1011.48em, 2.691em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="msubsup" id="MathJax-Span-3"><span style="display: inline-block; position: relative; width: 1.96em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-4" style="font-family: MathJax_Math; font-style: italic;">e</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.466em;"><span class="texatom" id="MathJax-Span-5"><span class="mrow" id="MathJax-Span-6"><span class="mi" id="MathJax-Span-7" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">m</span><span class="mi" id="MathJax-Span-8" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-9" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-10" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-11" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 2.809em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-12" style="font-family: MathJax_Math; font-style: italic;">e</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.466em;"><span class="texatom" id="MathJax-Span-13"><span class="mrow" id="MathJax-Span-14"><span class="mi" id="MathJax-Span-15" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">w</span><span class="mi" id="MathJax-Span-16" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-17" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">m</span><span class="mi" id="MathJax-Span-18" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-19" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-20" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-21" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.917em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-22" style="font-family: MathJax_Math; font-style: italic;">e</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.466em;"><span class="texatom" id="MathJax-Span-23"><span class="mrow" id="MathJax-Span-24"><span class="mi" id="MathJax-Span-25" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span class="mi" id="MathJax-Span-26" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-27" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-28" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-29" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-30" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 2.354em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-31" style="font-family: MathJax_Math; font-style: italic;">e</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.466em;"><span class="texatom" id="MathJax-Span-32"><span class="mrow" id="MathJax-Span-33"><span class="mi" id="MathJax-Span-34" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span class="mi" id="MathJax-Span-35" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">u</span><span class="mi" id="MathJax-Span-36" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-37" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-38" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-39" style="font-family: MathJax_Main;">.</span><span class="mo" id="MathJax-Span-40" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-41" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.416em; border-left: 0px solid; width: 0px; height: 1.009em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mi>a</mi><mi>n</mi></mrow></msub><mo>,</mo><msub><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mi>w</mi><mi>o</mi><mi>m</mi><mi>a</mi><mi>n</mi></mrow></msub><mo>,</mo><msub><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mi>i</mi><mi>n</mi><mi>g</mi></mrow></msub><mo>,</mo><msub><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mi>q</mi><mi>u</mi><mi>e</mi><mi>e</mi><mi>n</mi></mrow></msub><mo>.</mo><mo>.</mo><mo>.</mo></math></span></span><script type="math/tex" id="MathJax-Element-1">e_{man},e_{woman},e_{king},e_{queen}...</script>，注意man(5391)中5391标示的是man这个词在词汇表中的位置，向量是man的特征编码； <br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span></p><div class="MathJax_Display" style="text-align: center;"></div><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>m</mi><mi>a</mi><mi>n</mi></mrow></msub><mo>=</mo><mo stretchy=&quot;false&quot;>[</mo><mo>&amp;#x2212;</mo><mn>1</mn><mo>,</mo><mn>0.01</mn><mo>,</mo><mn>0.03</mn><mo>,</mo><mn>0.09</mn><msup><mo stretchy=&quot;false&quot;>]</mo><mi>T</mi></msup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-42" style="width: 14.846em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.344em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.192em, 1012.34em, 2.646em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-43"><span class="msubsup" id="MathJax-Span-44"><span style="display: inline-block; position: relative; width: 1.96em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-45" style="font-family: MathJax_Math; font-style: italic;">e</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.466em;"><span class="texatom" id="MathJax-Span-46"><span class="mrow" id="MathJax-Span-47"><span class="mi" id="MathJax-Span-48" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">m</span><span class="mi" id="MathJax-Span-49" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-50" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-51" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-52" style="font-family: MathJax_Main; padding-left: 0.278em;">[</span><span class="mo" id="MathJax-Span-53" style="font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-54" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-55" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-56" style="font-family: MathJax_Main; padding-left: 0.167em;">0.01</span><span class="mo" id="MathJax-Span-57" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-58" style="font-family: MathJax_Main; padding-left: 0.167em;">0.03</span><span class="mo" id="MathJax-Span-59" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-60" style="font-family: MathJax_Main; padding-left: 0.167em;">0.09</span><span class="msubsup" id="MathJax-Span-61"><span style="display: inline-block; position: relative; width: 0.851em; height: 0px;"><span style="position: absolute; clip: rect(3.104em, 1000.16em, 4.417em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-62" style="font-family: MathJax_Main;">]</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.423em; left: 0.278em;"><span class="mi" id="MathJax-Span-63" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.362em; border-left: 0px solid; width: 0px; height: 1.495em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mi>a</mi><mi>n</mi></mrow></msub><mo>=</mo><mo stretchy="false">[</mo><mo>−</mo><mn>1</mn><mo>,</mo><mn>0.01</mn><mo>,</mo><mn>0.03</mn><mo>,</mo><mn>0.09</mn><msup><mo stretchy="false">]</mo><mi>T</mi></msup></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-2">e_{man}=[-1,0.01,0.03,0.09]^T</script> <br>
（2）通过编码向量找到与<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mi>i</mi><mi>n</mi><mi>g</mi></mrow></msub><mo>&amp;#x2212;</mo><msub><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>m</mi><mi>a</mi><mi>n</mi></mrow></msub><mo>+</mo><msub><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>w</mi><mi>o</mi><mi>m</mi><mi>a</mi><mi>n</mi></mrow></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-64" style="width: 10.94em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.115em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.5em, 1009.12em, 2.691em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-65"><span class="msubsup" id="MathJax-Span-66"><span style="display: inline-block; position: relative; width: 1.917em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-67" style="font-family: MathJax_Math; font-style: italic;">e</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.466em;"><span class="texatom" id="MathJax-Span-68"><span class="mrow" id="MathJax-Span-69"><span class="mi" id="MathJax-Span-70" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span class="mi" id="MathJax-Span-71" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-72" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-73" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-74" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-75" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.96em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-76" style="font-family: MathJax_Math; font-style: italic;">e</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.466em;"><span class="texatom" id="MathJax-Span-77"><span class="mrow" id="MathJax-Span-78"><span class="mi" id="MathJax-Span-79" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">m</span><span class="mi" id="MathJax-Span-80" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-81" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-82" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msubsup" id="MathJax-Span-83" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 2.809em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-84" style="font-family: MathJax_Math; font-style: italic;">e</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.466em;"><span class="texatom" id="MathJax-Span-85"><span class="mrow" id="MathJax-Span-86"><span class="mi" id="MathJax-Span-87" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">w</span><span class="mi" id="MathJax-Span-88" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-89" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">m</span><span class="mi" id="MathJax-Span-90" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-91" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.416em; border-left: 0px solid; width: 0px; height: 1.179em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mi>i</mi><mi>n</mi><mi>g</mi></mrow></msub><mo>−</mo><msub><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mi>a</mi><mi>n</mi></mrow></msub><mo>+</mo><msub><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mi>w</mi><mi>o</mi><mi>m</mi><mi>a</mi><mi>n</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-3">e_{king}-e_{man}+e_{woman}</script>相似性最高的词，也就是所找词<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>w</mi></mrow></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-92" style="width: 1.253em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.042em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.589em, 1001.04em, 2.502em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-93"><span class="msubsup" id="MathJax-Span-94"><span style="display: inline-block; position: relative; width: 1.047em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-95" style="font-family: MathJax_Math; font-style: italic;">e</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.466em;"><span class="texatom" id="MathJax-Span-96"><span class="mrow" id="MathJax-Span-97"><span class="mi" id="MathJax-Span-98" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">w</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.252em; border-left: 0px solid; width: 0px; height: 0.845em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mi>w</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-4">e_{w}</script>计算方法如下：<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>w</mi></mrow></msub><mo>=</mo><mrow><mrow class=&quot;MJX-TeXAtom-OPEN&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>(</mo></mrow><mfrac linethickness=&quot;0&quot;><mrow><mi>a</mi><mi>r</mi><mi>g</mi><mi>m</mi><mi>a</mi><mi>x</mi></mrow><mi>w</mi></mfrac><mrow class=&quot;MJX-TeXAtom-CLOSE&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>)</mo></mrow></mrow><mi>s</mi><mi>i</mi><mi>m</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>w</mi></mrow></msub><mo>,</mo><msub><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mi>i</mi><mi>n</mi><mi>g</mi></mrow></msub><mo>&amp;#x2212;</mo><msub><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>m</mi><mi>a</mi><mi>n</mi></mrow></msub><mo>+</mo><msub><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>w</mi><mi>o</mi><mi>m</mi><mi>a</mi><mi>n</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-99" style="width: 22.607em; display: inline-block;"><span style="display: inline-block; position: relative; width: 18.802em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.286em, 1018.71em, 2.801em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-100"><span class="msubsup" id="MathJax-Span-101"><span style="display: inline-block; position: relative; width: 1.047em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-102" style="font-family: MathJax_Math; font-style: italic;">e</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.466em;"><span class="texatom" id="MathJax-Span-103"><span class="mrow" id="MathJax-Span-104"><span class="mi" id="MathJax-Span-105" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">w</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-106" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mrow" id="MathJax-Span-107" style="padding-left: 0.278em;"><span class="TeXmathchoice" id="MathJax-Span-108"><span class="texatom" id="MathJax-Span-109"><span class="mrow" id="MathJax-Span-110"><span class="mo" id="MathJax-Span-111" style="vertical-align: 0em;"><span style="font-family: MathJax_Size1;">(</span></span></span></span></span><span class="mfrac" id="MathJax-Span-112"><span style="display: inline-block; position: relative; width: 2.432em; height: 0px;"><span style="position: absolute; clip: rect(3.542em, 1002.4em, 4.312em, -1000em); top: -4.454em; left: 50%; margin-left: -1.216em;"><span class="mrow" id="MathJax-Span-113"><span class="mi" id="MathJax-Span-114" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-115" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-116" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-117" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">m</span><span class="mi" id="MathJax-Span-118" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-119" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">x</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.541em, 1000.49em, 4.174em, -1000em); top: -3.666em; left: 50%; margin-left: -0.253em;"><span class="mi" id="MathJax-Span-120" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-121"><span class="texatom" id="MathJax-Span-122"><span class="mrow" id="MathJax-Span-123"><span class="mo" id="MathJax-Span-124" style="vertical-align: 0em;"><span style="font-family: MathJax_Size1;">)</span></span></span></span></span></span><span class="mi" id="MathJax-Span-125" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mi" id="MathJax-Span-126" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-127" style="font-family: MathJax_Math; font-style: italic;">m</span><span class="mo" id="MathJax-Span-128" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-129"><span style="display: inline-block; position: relative; width: 1.047em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-130" style="font-family: MathJax_Math; font-style: italic;">e</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.466em;"><span class="texatom" id="MathJax-Span-131"><span class="mrow" id="MathJax-Span-132"><span class="mi" id="MathJax-Span-133" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">w</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-134" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-135" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.917em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-136" style="font-family: MathJax_Math; font-style: italic;">e</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.466em;"><span class="texatom" id="MathJax-Span-137"><span class="mrow" id="MathJax-Span-138"><span class="mi" id="MathJax-Span-139" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span class="mi" id="MathJax-Span-140" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-141" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-142" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-143" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-144" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.96em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-145" style="font-family: MathJax_Math; font-style: italic;">e</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.466em;"><span class="texatom" id="MathJax-Span-146"><span class="mrow" id="MathJax-Span-147"><span class="mi" id="MathJax-Span-148" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">m</span><span class="mi" id="MathJax-Span-149" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-150" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-151" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msubsup" id="MathJax-Span-152" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 2.809em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-153" style="font-family: MathJax_Math; font-style: italic;">e</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.466em;"><span class="texatom" id="MathJax-Span-154"><span class="mrow" id="MathJax-Span-155"><span class="mi" id="MathJax-Span-156" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">w</span><span class="mi" id="MathJax-Span-157" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-158" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">m</span><span class="mi" id="MathJax-Span-159" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-160" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-161" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.486em; border-left: 0px solid; width: 0px; height: 1.568em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mi>w</mi></mrow></msub><mo>=</mo><mrow><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="1.2em" minsize="1.2em">(</mo></mrow><mfrac linethickness="0"><mrow><mi>a</mi><mi>r</mi><mi>g</mi><mi>m</mi><mi>a</mi><mi>x</mi></mrow><mi>w</mi></mfrac><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="1.2em" minsize="1.2em">)</mo></mrow></mrow><mi>s</mi><mi>i</mi><mi>m</mi><mo stretchy="false">(</mo><msub><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mi>w</mi></mrow></msub><mo>,</mo><msub><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mi>i</mi><mi>n</mi><mi>g</mi></mrow></msub><mo>−</mo><msub><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mi>a</mi><mi>n</mi></mrow></msub><mo>+</mo><msub><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mi>w</mi><mi>o</mi><mi>m</mi><mi>a</mi><mi>n</mi></mrow></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-5">e_{w}=\binom{argmax}{w} sim(e_{w},e_{king}-e_{man}+e_{woman})</script> <br>
计算编码差发现： <br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"></div><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>m</mi><mi>a</mi><mi>n</mi></mrow></msub><mo>&amp;#x2212;</mo><msub><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>w</mi><mi>o</mi><mi>m</mi><mi>a</mi><mi>n</mi></mrow></msub><mo>&amp;#x2248;</mo><mo stretchy=&quot;false&quot;>[</mo><mo>&amp;#x2212;</mo><mn>2</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><msup><mo stretchy=&quot;false&quot;>]</mo><mi>T</mi></msup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-162" style="width: 15.107em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.552em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.192em, 1012.55em, 2.646em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-163"><span class="msubsup" id="MathJax-Span-164"><span style="display: inline-block; position: relative; width: 1.96em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-165" style="font-family: MathJax_Math; font-style: italic;">e</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.466em;"><span class="texatom" id="MathJax-Span-166"><span class="mrow" id="MathJax-Span-167"><span class="mi" id="MathJax-Span-168" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">m</span><span class="mi" id="MathJax-Span-169" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-170" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-171" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-172" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 2.809em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-173" style="font-family: MathJax_Math; font-style: italic;">e</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.466em;"><span class="texatom" id="MathJax-Span-174"><span class="mrow" id="MathJax-Span-175"><span class="mi" id="MathJax-Span-176" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">w</span><span class="mi" id="MathJax-Span-177" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-178" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">m</span><span class="mi" id="MathJax-Span-179" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-180" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-181" style="font-family: MathJax_Main; padding-left: 0.278em;">≈</span><span class="mo" id="MathJax-Span-182" style="font-family: MathJax_Main; padding-left: 0.278em;">[</span><span class="mo" id="MathJax-Span-183" style="font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-184" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-185" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-186" style="font-family: MathJax_Main; padding-left: 0.167em;">0</span><span class="mo" id="MathJax-Span-187" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-188" style="font-family: MathJax_Main; padding-left: 0.167em;">0</span><span class="mo" id="MathJax-Span-189" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-190" style="font-family: MathJax_Main; padding-left: 0.167em;">0</span><span class="msubsup" id="MathJax-Span-191"><span style="display: inline-block; position: relative; width: 0.851em; height: 0px;"><span style="position: absolute; clip: rect(3.104em, 1000.16em, 4.417em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-192" style="font-family: MathJax_Main;">]</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.423em; left: 0.278em;"><span class="mi" id="MathJax-Span-193" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.362em; border-left: 0px solid; width: 0px; height: 1.495em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mi>a</mi><mi>n</mi></mrow></msub><mo>−</mo><msub><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mi>w</mi><mi>o</mi><mi>m</mi><mi>a</mi><mi>n</mi></mrow></msub><mo>≈</mo><mo stretchy="false">[</mo><mo>−</mo><mn>2</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><msup><mo stretchy="false">]</mo><mi>T</mi></msup></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-6">e_{man}-e_{woman} \approx [ -2,0,0,0]^T</script> <br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"></div><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mi>i</mi><mi>n</mi><mi>g</mi></mrow></msub><mo>&amp;#x2212;</mo><msub><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>q</mi><mi>u</mi><mi>e</mi><mi>n</mi><mi>n</mi></mrow></msub><mo>&amp;#x2248;</mo><mo stretchy=&quot;false&quot;>[</mo><mo>&amp;#x2212;</mo><mn>2</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><msup><mo stretchy=&quot;false&quot;>]</mo><mi>T</mi></msup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-194" style="width: 14.586em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.135em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.192em, 1012.14em, 2.691em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-195"><span class="msubsup" id="MathJax-Span-196"><span style="display: inline-block; position: relative; width: 1.917em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-197" style="font-family: MathJax_Math; font-style: italic;">e</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.466em;"><span class="texatom" id="MathJax-Span-198"><span class="mrow" id="MathJax-Span-199"><span class="mi" id="MathJax-Span-200" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span class="mi" id="MathJax-Span-201" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-202" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-203" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-204" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-205" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 2.449em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-206" style="font-family: MathJax_Math; font-style: italic;">e</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.466em;"><span class="texatom" id="MathJax-Span-207"><span class="mrow" id="MathJax-Span-208"><span class="mi" id="MathJax-Span-209" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span class="mi" id="MathJax-Span-210" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">u</span><span class="mi" id="MathJax-Span-211" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-212" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-213" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-214" style="font-family: MathJax_Main; padding-left: 0.278em;">≈</span><span class="mo" id="MathJax-Span-215" style="font-family: MathJax_Main; padding-left: 0.278em;">[</span><span class="mo" id="MathJax-Span-216" style="font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-217" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-218" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-219" style="font-family: MathJax_Main; padding-left: 0.167em;">0</span><span class="mo" id="MathJax-Span-220" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-221" style="font-family: MathJax_Main; padding-left: 0.167em;">0</span><span class="mo" id="MathJax-Span-222" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-223" style="font-family: MathJax_Main; padding-left: 0.167em;">0</span><span class="msubsup" id="MathJax-Span-224"><span style="display: inline-block; position: relative; width: 0.851em; height: 0px;"><span style="position: absolute; clip: rect(3.104em, 1000.16em, 4.417em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-225" style="font-family: MathJax_Main;">]</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.423em; left: 0.278em;"><span class="mi" id="MathJax-Span-226" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.416em; border-left: 0px solid; width: 0px; height: 1.549em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mi>i</mi><mi>n</mi><mi>g</mi></mrow></msub><mo>−</mo><msub><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mi>q</mi><mi>u</mi><mi>e</mi><mi>n</mi><mi>n</mi></mrow></msub><mo>≈</mo><mo stretchy="false">[</mo><mo>−</mo><mn>2</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><msup><mo stretchy="false">]</mo><mi>T</mi></msup></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-7">e_{king}-e_{quenn} \approx [ -2,0,0,0]^T</script> <br>
也就是man和woman的主要差异在第一个参数也就是性别，而King和queen的主要差异也是性别。<p></p>

<p><strong>最常用的相似度函数-余弦函数：</strong> <br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span></p><div class="MathJax_Display" style="text-align: center;"></div><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>s</mi><mi>i</mi><mi>m</mi><mo stretchy=&quot;false&quot;>(</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mfrac><mrow><msup><mi>u</mi><mi>T</mi></msup><mi>v</mi></mrow><mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>u</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mn>2</mn></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>v</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mn>2</mn></msub></mrow></mfrac></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-227" style="width: 11.773em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.792em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.617em, 1009.79em, 3.452em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-228"><span class="mi" id="MathJax-Span-229" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mi" id="MathJax-Span-230" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-231" style="font-family: MathJax_Math; font-style: italic;">m</span><span class="mo" id="MathJax-Span-232" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-233" style="font-family: MathJax_Math; font-style: italic;">u</span><span class="mo" id="MathJax-Span-234" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-235" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">v</span><span class="mo" id="MathJax-Span-236" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-237" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mfrac" id="MathJax-Span-238" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 4.258em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.013em, 1001.61em, 4.178em, -1000em); top: -4.687em; left: 50%; margin-left: -0.815em;"><span class="mrow" id="MathJax-Span-239"><span class="msubsup" id="MathJax-Span-240"><span style="display: inline-block; position: relative; width: 1.145em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.55em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-241" style="font-family: MathJax_Math; font-style: italic;">u</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.572em;"><span class="mi" id="MathJax-Span-242" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mi" id="MathJax-Span-243" style="font-family: MathJax_Math; font-style: italic;">v</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.104em, 1004.14em, 4.451em, -1000em); top: -3.29em; left: 50%; margin-left: -2.069em;"><span class="mrow" id="MathJax-Span-244"><span class="texatom" id="MathJax-Span-245"><span class="mrow" id="MathJax-Span-246"><span class="mo" id="MathJax-Span-247" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-248"><span class="mrow" id="MathJax-Span-249"><span class="mo" id="MathJax-Span-250" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-251" style="font-family: MathJax_Math; font-style: italic;">u</span><span class="texatom" id="MathJax-Span-252"><span class="mrow" id="MathJax-Span-253"><span class="mo" id="MathJax-Span-254" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-255"><span style="display: inline-block; position: relative; width: 0.707em; height: 0px;"><span style="position: absolute; clip: rect(3.104em, 1000.16em, 4.416em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-256"><span class="mrow" id="MathJax-Span-257"><span class="mo" id="MathJax-Span-258" style="font-family: MathJax_Main;">|</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.726em; left: 0.278em;"><span class="mn" id="MathJax-Span-259" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="texatom" id="MathJax-Span-260"><span class="mrow" id="MathJax-Span-261"><span class="mo" id="MathJax-Span-262" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-263"><span class="mrow" id="MathJax-Span-264"><span class="mo" id="MathJax-Span-265" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-266" style="font-family: MathJax_Math; font-style: italic;">v</span><span class="texatom" id="MathJax-Span-267"><span class="mrow" id="MathJax-Span-268"><span class="mo" id="MathJax-Span-269" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-270"><span style="display: inline-block; position: relative; width: 0.707em; height: 0px;"><span style="position: absolute; clip: rect(3.104em, 1000.16em, 4.416em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-271"><span class="mrow" id="MathJax-Span-272"><span class="mo" id="MathJax-Span-273" style="font-family: MathJax_Main;">|</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.726em; left: 0.278em;"><span class="mn" id="MathJax-Span-274" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1004.26em, 1.198em, -1000em); top: -1.262em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.258em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.268em; border-left: 0px solid; width: 0px; height: 3.152em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>s</mi><mi>i</mi><mi>m</mi><mo stretchy="false">(</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><msup><mi>u</mi><mi>T</mi></msup><mi>v</mi></mrow><mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>u</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mn>2</mn></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>v</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mn>2</mn></msub></mrow></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-8">sim(u,v)=\frac {u^Tv}{||u||_2 ||v||_2}</script><p></p>

<p>也可以用平方距离做相似度函数： <br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span></p><div class="MathJax_Display" style="text-align: center;"></div><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>s</mi><mi>i</mi><mi>m</mi><mo stretchy=&quot;false&quot;>(</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>u</mi><mo>&amp;#x2212;</mo><mi>v</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mn>2</mn></msup></mrow></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-275" style="width: 10.94em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.115em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.188em, 1009.12em, 2.698em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-276"><span class="mi" id="MathJax-Span-277" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mi" id="MathJax-Span-278" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-279" style="font-family: MathJax_Math; font-style: italic;">m</span><span class="mo" id="MathJax-Span-280" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-281" style="font-family: MathJax_Math; font-style: italic;">u</span><span class="mo" id="MathJax-Span-282" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-283" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">v</span><span class="mo" id="MathJax-Span-284" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-285" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="texatom" id="MathJax-Span-286" style="padding-left: 0.278em;"><span class="mrow" id="MathJax-Span-287"><span class="texatom" id="MathJax-Span-288"><span class="mrow" id="MathJax-Span-289"><span class="mo" id="MathJax-Span-290" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-291"><span class="mrow" id="MathJax-Span-292"><span class="mo" id="MathJax-Span-293" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-294" style="font-family: MathJax_Math; font-style: italic;">u</span><span class="mo" id="MathJax-Span-295" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-296" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">v</span><span class="texatom" id="MathJax-Span-297"><span class="mrow" id="MathJax-Span-298"><span class="mo" id="MathJax-Span-299" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-300"><span style="display: inline-block; position: relative; width: 0.707em; height: 0px;"><span style="position: absolute; clip: rect(3.104em, 1000.16em, 4.416em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-301"><span class="mrow" id="MathJax-Span-302"><span class="mo" id="MathJax-Span-303" style="font-family: MathJax_Main;">|</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.487em; left: 0.278em;"><span class="mn" id="MathJax-Span-304" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.362em; border-left: 0px solid; width: 0px; height: 1.562em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>s</mi><mi>i</mi><mi>m</mi><mo stretchy="false">(</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo stretchy="false">)</mo><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>u</mi><mo>−</mo><mi>v</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msup><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mn>2</mn></msup></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-9">sim(u,v)={||u-v||^2}</script><p></p>



<h1 id="4embedding-matrix嵌入矩阵"><a name="t6"></a>4.Embedding matrix嵌入矩阵</h1>

<p>应用算法学习词嵌入实际学习的是嵌入矩阵。</p>

<p>如果词汇表长度是10000，加上就是10001，特征为300个，那么我们要得到的矩阵E就是(300,10001)，矩阵每一列代表词汇表中的一个字，通过其在词汇值表的位置来表示，即one-shot向量里面1的位置，用O来表示每个词的ont-shot向量，那么词的嵌入表示也就是编码可以这样计算： <br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span></p><div class="MathJax_Display" style="text-align: center;"></div><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi></mrow></msub><mo>=</mo><mi>E</mi><mo>&amp;#x2217;</mo><msub><mi>o</mi><mi>j</mi></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-305" style="width: 5.732em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.74em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.455em, 1004.74em, 2.742em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-306"><span class="msubsup" id="MathJax-Span-307"><span style="display: inline-block; position: relative; width: 0.832em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-308" style="font-family: MathJax_Math; font-style: italic;">e</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.466em;"><span class="texatom" id="MathJax-Span-309"><span class="mrow" id="MathJax-Span-310"><span class="mi" id="MathJax-Span-311" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-312" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-313" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mo" id="MathJax-Span-314" style="font-family: MathJax_Main; padding-left: 0.222em;">∗</span><span class="msubsup" id="MathJax-Span-315" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.851em; height: 0px;"><span style="position: absolute; clip: rect(3.413em, 1000.48em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-316" style="font-family: MathJax_Math; font-style: italic;">o</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.485em;"><span class="mi" id="MathJax-Span-317" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.416em; border-left: 0px solid; width: 0px; height: 1.294em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi></mrow></msub><mo>=</mo><mi>E</mi><mo>∗</mo><msub><mi>o</mi><mi>j</mi></msub></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-10">e_{j}=E*o_j</script> <br>
j：代表词在词汇表中的位置，如orange是6257 <br>
e：表示词嵌入向量 <br>
E：嵌入矩阵 <br>
o：词的one-shot向量 <br>
这样表示是为了方便理解，实际中并不利用矩阵乘法来计算嵌入向量，因为词汇表通常很大one-shot向量也会很大，但是里面只有一个有用值，其他都为0，所以矩阵相乘大部分都是在做0乘法运算。实际中一般都直接从嵌入矩阵提取嵌入向量，如在Keras中有个embedding layer可以利用其高效的从嵌入矩阵中提取列。 <br>
下一节讲如何初始化嵌入矩阵E，并通过梯度下降学习E。<p></p>



<h1 id="5-learn-word-embeddings"><a name="t7"></a>5. Learn Word embeddings</h1>

<p>在词嵌入学习的历史上，一开始算法非常复杂，后来算法越来越简单，尤其是大数据时代，主流的算法都很简单，本节会从复杂算法讲起，以便于大家理解算法原理。</p>



<h3 id="复杂算法-通过学习语言模型学习词嵌入矩阵"><a name="t8"></a>复杂算法-通过学习语言模型学习词嵌入矩阵</h3>

<p>本节不做重点，只为了说明此类算法的理论基础 <br>
建立神经语言模型是学习词嵌入的一个好方法，具体如下： <br>
<img src="https://img-blog.csdn.net/20180304114752355?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd2VpeGluXzQxMDQzMjQw/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述" title=""> <br>
每个单词获得其one-shot向量后，乘以嵌入矩阵E得到嵌入向量e（假设为300维），然后将所有嵌入向量作为神经网络输入，经过神经网络层之后，通过softmax层输出预测，softmax分类器输出数目与词汇表数目一致，通过输出的各词出现的概率，预测此位置最可能的词。最后利用反向传播学习各参数以及嵌入矩阵E。 <br>
这里我们用了这句话所有的词预测，实际中也可以设置一个超参数来决定用几个词来进行预测，比如4个，那么就用a glass of orange来进行下一个词的预测，用固定数目的词组成的隐藏层叫做历史窗口，因为其维度固定不受句长的影响，所以可以处理任意长度的句子。 <br>
<img src="https://img-blog.csdn.net/2018030411532055?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd2VpeGluXzQxMDQzMjQw/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述" title=""> <br>
如上图，设置超参数决定用哪些词进行预测，可以用目标词前面的4个词（目前用的最多），也可以用目标前后的4个词，目标之前一个词，或目标附近一个词。</p>



<h3 id="简单方法-word2vec"><a name="t9"></a>简单方法-Word2Vec</h3>

<p>下一节讲</p>



<h3 id="另一种简单方法-glove词向量"><a name="t10"></a>另一种简单方法-GloVe词向量</h3>

<p>第8节讲</p>

<h1 id="6-word2vec"><a name="t11"></a>6. Word2Vec</h1>

<p>Word2Vec有两个版本模型，一个是skip gram模型，一个是CBow模型，continues bag-of-words连续词袋模型。skip gram模型是选择中间词然后预测两边词，而CBow是选择两边的词预测中间的词。</p>



<h3 id="skip-gram"><a name="t12"></a>Skip gram</h3>

<p>抽取上下文和目标词配对，构建监督学习问题，通过根据选定词，预测上下文，来学习词嵌入矩阵。 <br>
Skip gram就是在一定词距内随机抽取上下文，如orange，可以在上下文5个词内随机抽取一个词，选定的词orange作为context，以随机抽取的词为target。 <br>
<img src="https://img-blog.csdn.net/20180304120441305?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd2VpeGluXzQxMDQzMjQw/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述" title=""> <br>
具体步骤如下： <br>
<img src="https://img-blog.csdn.net/20180304180332191?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd2VpeGluXzQxMDQzMjQw/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述" title=""> <br>
假设词汇表长度为10000k，选定orange为context，预测一定间距内上下文出现的词，如juice，对照词汇表确定context的one-shot向量<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>o</mi><mi>c</mi></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-318" style="width: 1.096em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.59em, 1000.89em, 2.502em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-319"><span class="msubsup" id="MathJax-Span-320"><span style="display: inline-block; position: relative; width: 0.866em; height: 0px;"><span style="position: absolute; clip: rect(3.413em, 1000.48em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-321" style="font-family: MathJax_Math; font-style: italic;">o</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.485em;"><span class="mi" id="MathJax-Span-322" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.252em; border-left: 0px solid; width: 0px; height: 0.844em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>o</mi><mi>c</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-11">o_c</script>，结合嵌入矩阵E，生成嵌入向量<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>e</mi><mi>c</mi></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-323" style="width: 1.044em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.833em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.589em, 1000.83em, 2.502em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-324"><span class="msubsup" id="MathJax-Span-325"><span style="display: inline-block; position: relative; width: 0.847em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-326" style="font-family: MathJax_Math; font-style: italic;">e</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.466em;"><span class="mi" id="MathJax-Span-327" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.252em; border-left: 0px solid; width: 0px; height: 0.845em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>e</mi><mi>c</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-12">e_c</script>，然后输入softmax分类器，得到所有可能目标词在这里出现的概率<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>c</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-328" style="width: 2.398em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.979em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.385em, 1001.98em, 2.698em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-329"><span class="mi" id="MathJax-Span-330" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-331" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-332" style="font-family: MathJax_Math; font-style: italic;">t</span><span class="texatom" id="MathJax-Span-333"><span class="mrow" id="MathJax-Span-334"><span class="mo" id="MathJax-Span-335" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-336" style="font-family: MathJax_Math; font-style: italic;">c</span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.362em; border-left: 0px solid; width: 0px; height: 1.325em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-13">p(t|c</script>，即在c的情况下发生t的概率，<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03B8;</mi><mi>t</mi></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-337" style="width: 0.94em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.781em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.326em, 1000.78em, 2.502em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-338"><span class="msubsup" id="MathJax-Span-339"><span style="display: inline-block; position: relative; width: 0.799em; height: 0px;"><span style="position: absolute; clip: rect(3.149em, 1000.46em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-340" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.469em;"><span class="mi" id="MathJax-Span-341" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.252em; border-left: 0px solid; width: 0px; height: 1.16em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>θ</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-14">\theta_t</script>为与输出t有关的参数。 <br>
成本函数中<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-342" style="width: 0.628em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.521em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.693em, 1000.52em, 2.653em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-343"><span class="mi" id="MathJax-Span-344" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.308em; border-left: 0px solid; width: 0px; height: 0.901em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-15">y</script>为target的one-shot向量，<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>y</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-345" style="width: 0.732em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.573em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.296em, 1000.49em, 2.549em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-346"><span class="texatom" id="MathJax-Span-347"><span class="mrow" id="MathJax-Span-348"><span class="munderover" id="MathJax-Span-349"><span style="display: inline-block; position: relative; width: 0.585em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.5em, 4.372em, -1000em); top: -4.01em; left: 0.002em;"><span class="mi" id="MathJax-Span-350" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.16em, 1000.39em, 3.636em, -1000em); top: -4.052em; left: 0.085em;"><span class="mo" id="MathJax-Span-351" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.308em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow></math></span></span><script type="math/tex" id="MathJax-Element-16">\hat y</script>为softmax预测值。</p>



<h4 id="问题">问题：</h4>

<p>在计算<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>c</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-352" style="width: 2.815em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.344em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.385em, 1002.25em, 2.698em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-353"><span class="mi" id="MathJax-Span-354" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-355" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-356" style="font-family: MathJax_Math; font-style: italic;">t</span><span class="texatom" id="MathJax-Span-357"><span class="mrow" id="MathJax-Span-358"><span class="mo" id="MathJax-Span-359" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-360" style="font-family: MathJax_Math; font-style: italic;">c</span><span class="mo" id="MathJax-Span-361" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.362em; border-left: 0px solid; width: 0px; height: 1.325em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>c</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-17">p(t|c)</script>的时候，分母部分需要计算词汇表中所有词之和，当词汇表较大的时候，求和计算会比较慢。 <br>
<strong>解决方法：</strong> <br>
 - <strong>分级softmax分类器</strong>：相当于折半查找，用一个分类树，每个节点处将所有词汇分成两份，用一个二分类如sigmoid来确定目标词是在前半部分还是后半部分，然后一级一级的分下去，直到找到这个词。实际中，一般不会使用完美平衡的分类树，通常使用率较高的词一般会放在树的浅层，使用率较低的词放在树的深层。这种方法的成本是log|v|，v是词汇表大小。 <br>
 <img src="https://img-blog.csdn.net/20180304204458608?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd2VpeGluXzQxMDQzMjQw/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述" title=""> <br>
 - <strong>负采样</strong> <br>
 此方法会在下一节讨论，效率更高，推荐此方法</p>



<h3 id="如何对context-c采样即如何选择c"><a name="t13"></a>如何对context c采样？即如何选择c</h3>

<ul>
<li>对语料库均匀随机采样，会发现有些词出现频率特别高，如the a of and to等，一般必选选择此类词作为c</li>
</ul>



<h1 id="7negative-sampling负采样"><a name="t14"></a>7.Negative sampling负采样</h1>

<p>简单来说就是选一组词，然后判断其是否有关联。 <br>
<strong>具体做法如下：</strong> <br>
<img src="https://img-blog.csdn.net/20180305101902477?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd2VpeGluXzQxMDQzMjQw/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述" title=""> <br>
<img src="https://img-blog.csdn.net/20180305101911647?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd2VpeGluXzQxMDQzMjQw/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述" title=""> <br>
给出一句话，选定一个context词，然后从句子中一定间距内选择一个target词，即跟context关联的词，组成一个正样本词组，然后从字典随机选k个词和context组成负样本词组，然后建立一个监督学习</p>

<p><strong>如何选择k？</strong> <br>
小数据集，k取(5,20)，数据集越大k应该越小，比如(2,5)</p>

<p><strong>如何预测？</strong> <br>
因为要预测的目标取值为0和1，所以可以用sigmoid函数，给定c和t组合情况下target为1的概率为： <br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span></p><div class="MathJax_Display" style="text-align: center;"></div><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>=</mo><mn>1</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>c</mi><mo>,</mo><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>&amp;#x03C3;</mi><mo stretchy=&quot;false&quot;>(</mo><msubsup><mi>&amp;#x03B8;</mi><mi>t</mi><mi>T</mi></msubsup><msub><mi>e</mi><mi>c</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-362" style="width: 11.982em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.948em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.312em, 1009.85em, 2.734em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-363"><span class="mi" id="MathJax-Span-364" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span class="mo" id="MathJax-Span-365" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-366" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-367" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-368" style="font-family: MathJax_Main; padding-left: 0.278em;">1</span><span class="texatom" id="MathJax-Span-369"><span class="mrow" id="MathJax-Span-370"><span class="mo" id="MathJax-Span-371" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-372" style="font-family: MathJax_Math; font-style: italic;">c</span><span class="mo" id="MathJax-Span-373" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-374" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">t</span><span class="mo" id="MathJax-Span-375" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-376" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-377" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-378" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-379"><span style="display: inline-block; position: relative; width: 1.042em; height: 0px;"><span style="position: absolute; clip: rect(3.149em, 1000.46em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-380" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.375em, 1000.57em, 4.167em, -1000em); top: -4.355em; left: 0.469em;"><span class="mi" id="MathJax-Span-381" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.412em, 1000.33em, 4.174em, -1000em); top: -3.732em; left: 0.469em;"><span class="mi" id="MathJax-Span-382" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-383"><span style="display: inline-block; position: relative; width: 0.847em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-384" style="font-family: MathJax_Math; font-style: italic;">e</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.466em;"><span class="mi" id="MathJax-Span-385" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-386" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.406em; border-left: 0px solid; width: 0px; height: 1.456em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>P</mi><mo stretchy="false">(</mo><mi>y</mi><mo>=</mo><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>c</mi><mo>,</mo><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><mi>σ</mi><mo stretchy="false">(</mo><msubsup><mi>θ</mi><mi>t</mi><mi>T</mi></msubsup><msub><mi>e</mi><mi>c</mi></msub><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-30">P(y=1|c,t) =\sigma(\theta_t^T e_c)</script><p></p>

<p><strong>完整流程：</strong> <br>
<img src="https://img-blog.csdn.net/20180305115856982?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd2VpeGluXzQxMDQzMjQw/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述" title=""> <br>
输入context的one-shot向量，传递个嵌入向量E，然后两者相乘得到嵌入向量e，输出有10000（词汇表长度）种二分类可能，也就是由10000个二分类logistics回归分类器，根据与context配对的Word来确定是哪个分类器，每次计算更新k+1个二分类结果，计算量大大减少。 <br>
<strong>选择负样本的方法：</strong> <br>
按照均匀随机分布抽样以及按照词频抽样（大量的负样本都是the of and之类的高频词）是两个极端，都不太理想，有人根据观察到的英文文本分布提出了以下方法，抽取某个词的概率为： <br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span></p><div class="MathJax_Display" style="text-align: center;"></div><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>w</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mfrac><mrow><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>w</mi><mi>i</mi></msub><msup><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mfrac><mn>3</mn><mn>4</mn></mfrac></mrow></msup></mrow><mrow><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>10000</mn></mrow></munderover><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>w</mi><mi>i</mi></msub><msup><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mfrac><mn>3</mn><mn>4</mn></mfrac></mrow></msup></mrow></mfrac></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-387" style="width: 12.451em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.365em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.31em, 1010.37em, 3.953em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-388"><span class="mi" id="MathJax-Span-389" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span class="mo" id="MathJax-Span-390" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-391"><span style="display: inline-block; position: relative; width: 1.035em; height: 0px;"><span style="position: absolute; clip: rect(3.411em, 1000.69em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-392" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.716em;"><span class="mi" id="MathJax-Span-393" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-394" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-395" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mfrac" id="MathJax-Span-396" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 6.234em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(2.749em, 1003.05em, 4.417em, -1000em); top: -4.731em; left: 50%; margin-left: -1.524em;"><span class="mrow" id="MathJax-Span-397"><span class="mi" id="MathJax-Span-398" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-399" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-400"><span style="display: inline-block; position: relative; width: 1.035em; height: 0px;"><span style="position: absolute; clip: rect(3.411em, 1000.69em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-401" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.716em;"><span class="mi" id="MathJax-Span-402" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-403"><span style="display: inline-block; position: relative; width: 1.074em; height: 0px;"><span style="position: absolute; clip: rect(3.104em, 1000.29em, 4.417em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-404" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.437em; left: 0.389em;"><span class="texatom" id="MathJax-Span-405"><span class="mrow" id="MathJax-Span-406"><span class="mfrac" id="MathJax-Span-407"><span style="display: inline-block; position: relative; width: 0.37em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.522em, 1000.23em, 4.178em, -1000em); top: -4.356em; left: 50%; margin-left: -0.125em;"><span class="mn" id="MathJax-Span-408" style="font-size: 50%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.516em, 1000.24em, 4.167em, -1000em); top: -3.691em; left: 50%; margin-left: -0.125em;"><span class="mn" id="MathJax-Span-409" style="font-size: 50%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1000.37em, 1.198em, -1000em); top: -1.188em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.37em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(2.749em, 1006.11em, 4.596em, -1000em); top: -2.935em; left: 50%; margin-left: -3.057em;"><span class="mrow" id="MathJax-Span-410"><span class="munderover" id="MathJax-Span-411"><span style="display: inline-block; position: relative; width: 2.899em; height: 0px;"><span style="position: absolute; clip: rect(3.104em, 1001em, 4.417em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-412" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.383em, 1001.84em, 4.182em, -1000em); top: -4.487em; left: 1.056em;"><span class="texatom" id="MathJax-Span-413"><span class="mrow" id="MathJax-Span-414"><span class="mn" id="MathJax-Span-415" style="font-size: 70.7%; font-family: MathJax_Main;">10000</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.383em, 1001.27em, 4.311em, -1000em); top: -3.725em; left: 1.056em;"><span class="texatom" id="MathJax-Span-416"><span class="mrow" id="MathJax-Span-417"><span class="mi" id="MathJax-Span-418" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span class="mo" id="MathJax-Span-419" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-420" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mi" id="MathJax-Span-421" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-422" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-423"><span style="display: inline-block; position: relative; width: 1.035em; height: 0px;"><span style="position: absolute; clip: rect(3.411em, 1000.69em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-424" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.716em;"><span class="mi" id="MathJax-Span-425" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-426"><span style="display: inline-block; position: relative; width: 1.074em; height: 0px;"><span style="position: absolute; clip: rect(3.104em, 1000.29em, 4.417em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-427" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.437em; left: 0.389em;"><span class="texatom" id="MathJax-Span-428"><span class="mrow" id="MathJax-Span-429"><span class="mfrac" id="MathJax-Span-430"><span style="display: inline-block; position: relative; width: 0.37em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.522em, 1000.23em, 4.178em, -1000em); top: -4.356em; left: 50%; margin-left: -0.125em;"><span class="mn" id="MathJax-Span-431" style="font-size: 50%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.516em, 1000.24em, 4.167em, -1000em); top: -3.691em; left: 50%; margin-left: -0.125em;"><span class="mn" id="MathJax-Span-432" style="font-size: 50%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1000.37em, 1.198em, -1000em); top: -1.188em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.37em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1006.23em, 1.198em, -1000em); top: -1.262em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 6.234em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.868em; border-left: 0px solid; width: 0px; height: 4.121em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>P</mi><mo stretchy="false">(</mo><msub><mi>w</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mi>f</mi><mo stretchy="false">(</mo><msub><mi>w</mi><mi>i</mi></msub><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mfrac><mn>3</mn><mn>4</mn></mfrac></mrow></msup></mrow><mrow><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mn>10000</mn></mrow></munderover><mi>f</mi><mo stretchy="false">(</mo><msub><mi>w</mi><mi>i</mi></msub><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mfrac><mn>3</mn><mn>4</mn></mfrac></mrow></msup></mrow></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-31">P(w_i)=\frac{f(w_i)^{\frac 3 4}}{\sum_{j=1}^{10000}f(w_i)^{\frac 3 4}}</script> <br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>f(w_i)}</mtext></merror></math>" role="presentation"><span class="math" id="MathJax-Span-433" style="" aria-hidden="true"><span class="noError" id="MathJax-Span-434" style="display: inline-block;">f(w_i)}</span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>f(w_i)}</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-32">f(w_i)}</script>为观测到的Word i在语料库中出现的频率，通过这种方式使得分布在两个极端之间。<p></p>

<p>现在有很多开源资源，如果想要在NLP领域取得快速进展，可以下载词向量，并在此基础上改进。</p>



<h1 id="8-glove-word-vector"><a name="t15"></a>8. GloVe word vector</h1>

<p>GloVe代表global vector for Word representation。 <br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-779-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mi>j</mi></mrow></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-435" style="width: 1.461em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.198em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.589em, 1001.2em, 2.638em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-436"><span class="msubsup" id="MathJax-Span-437"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.52em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-438" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.572em;"><span class="texatom" id="MathJax-Span-439"><span class="mrow" id="MathJax-Span-440"><span class="mi" id="MathJax-Span-441" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-442" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.416em; border-left: 0px solid; width: 0px; height: 1.008em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-779">x_{ij}</script>：单词i出现在单词j的上下文的次数，如果定义词距为10个词，那么就会有一种能对称关系<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-780-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msub><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi><mi>i</mi></mrow></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-443" style="width: 4.482em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.698em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.641em, 1003.7em, 2.69em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-444"><span class="msubsup" id="MathJax-Span-445"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.52em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-446" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.572em;"><span class="texatom" id="MathJax-Span-447"><span class="mrow" id="MathJax-Span-448"><span class="mi" id="MathJax-Span-449" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-450" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-451" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-452" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.52em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-453" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.572em;"><span class="texatom" id="MathJax-Span-454"><span class="mrow" id="MathJax-Span-455"><span class="mi" id="MathJax-Span-456" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span class="mi" id="MathJax-Span-457" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.416em; border-left: 0px solid; width: 0px; height: 1.008em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mi>i</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-780">x_{ij}=x_{ji}</script>，如果定义词距比较小比如前面1个，那么则没有这种对称关系。 <br>
<img src="https://img-blog.csdn.net/20180305181827962?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd2VpeGluXzQxMDQzMjQw/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述" title=""> <br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-781-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-458" style="width: 3.023em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.5em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.385em, 1002.41em, 2.742em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-459"><span class="mi" id="MathJax-Span-460" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-461" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-462"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.52em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-463" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.572em;"><span class="texatom" id="MathJax-Span-464"><span class="mrow" id="MathJax-Span-465"><span class="mi" id="MathJax-Span-466" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-467" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-468" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.416em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-781">f(x_{ij})</script>为加权项weighting term： <br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-782-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mn>0</mn></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-469" style="width: 5.211em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.323em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.385em, 1004.28em, 2.742em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-470"><span class="mi" id="MathJax-Span-471" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-472" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-473"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.52em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-474" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.572em;"><span class="texatom" id="MathJax-Span-475"><span class="mrow" id="MathJax-Span-476"><span class="mi" id="MathJax-Span-477" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-478" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-479" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-480" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-481" style="font-family: MathJax_Main; padding-left: 0.278em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.416em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-782">f(x_{ij})=0</script> if <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-783-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>0</mn></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-482" style="width: 3.648em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.021em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.417em, 1002.98em, 2.69em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-483"><span class="msubsup" id="MathJax-Span-484"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.52em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-485" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.572em;"><span class="texatom" id="MathJax-Span-486"><span class="mrow" id="MathJax-Span-487"><span class="mi" id="MathJax-Span-488" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-489" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-490" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-491" style="font-family: MathJax_Main; padding-left: 0.278em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.416em; border-left: 0px solid; width: 0px; height: 1.277em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-783">x_{ij}=0</script>，是为了防止当<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-784-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>0</mn></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-492" style="width: 3.648em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.021em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.417em, 1002.98em, 2.69em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-493"><span class="msubsup" id="MathJax-Span-494"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.52em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-495" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.572em;"><span class="texatom" id="MathJax-Span-496"><span class="mrow" id="MathJax-Span-497"><span class="mi" id="MathJax-Span-498" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-499" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-500" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-501" style="font-family: MathJax_Main; padding-left: 0.278em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.416em; border-left: 0px solid; width: 0px; height: 1.277em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-784">x_{ij}=0</script>是出现<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-785-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy=&quot;false&quot;>(</mo><mn>0</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-502" style="width: 3.076em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.552em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.385em, 1002.46em, 2.698em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-503"><span class="mi" id="MathJax-Span-504" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-505" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-506" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-507" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-508" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-509" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.362em; border-left: 0px solid; width: 0px; height: 1.325em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-785">log(0) </script>，并定义<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-786-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>0</mn><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy=&quot;false&quot;>(</mo><mn>0</mn><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mn>0</mn></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-510" style="width: 5.888em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.896em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.385em, 1004.86em, 2.698em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-511"><span class="mn" id="MathJax-Span-512" style="font-family: MathJax_Main;">0</span><span class="mi" id="MathJax-Span-513" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-514" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-515" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-516" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-517" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-518" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-519" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-520" style="font-family: MathJax_Main; padding-left: 0.278em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.362em; border-left: 0px solid; width: 0px; height: 1.325em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-786">0log(0)=0 </script> <br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-787-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-521" style="width: 3.023em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.5em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.385em, 1002.41em, 2.742em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-522"><span class="mi" id="MathJax-Span-523" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-524" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-525"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.52em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-526" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.572em;"><span class="texatom" id="MathJax-Span-527"><span class="mrow" id="MathJax-Span-528"><span class="mi" id="MathJax-Span-529" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-530" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-531" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.416em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-787">f(x_{ij})</script>另一个作用就是控制不让常用词的权重过高，也不让低频词的权重过低，具体方法可以看论文。 <br>
另外，算法里面的<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-788-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B8;</mi><mi>e</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-532" style="width: 1.148em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.938em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.43em, 1000.9em, 2.459em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-533"><span class="mi" id="MathJax-Span-534" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="mi" id="MathJax-Span-535" style="font-family: MathJax_Math; font-style: italic;">e</span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 0.984em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi><mi>e</mi></math></span></span><script type="math/tex" id="MathJax-Element-788">\theta e</script>是对称的，作用是相似的。</p>



<h1 id="9sentiment-classification情绪分类"><a name="t16"></a>9.Sentiment classification情绪分类</h1>

<p>情绪分类的一大挑战就是标记数据较少，利用词嵌入可以达到很好的效果。</p>



<h3 id="算法一"><a name="t17"></a>算法一</h3>

<p><img src="https://img-blog.csdn.net/20180305183521895?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd2VpeGluXzQxMDQzMjQw/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述" title=""> <br>
计算出各词的嵌入向量，然后对向量对应元素取均值或和，带入softmax分类器，这种方法适合任意长度的句子 <br>
缺点：没有考虑词序</p>



<h3 id="算法二-rnn"><a name="t18"></a>算法二-RNN</h3>

<p><img src="https://img-blog.csdn.net/20180305184007866?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd2VpeGluXzQxMDQzMjQw/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述" title=""></p>



<h1 id="10-debiasing-word-embeddings词嵌入去偏"><a name="t19"></a>10. Debiasing word embeddings词嵌入去偏</h1>

<p><img src="https://img-blog.csdn.net/20180305184441740?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd2VpeGluXzQxMDQzMjQw/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述" title=""> <br>
这里的偏是指偏见而不是偏差。 <br>
以性别歧视为例： <br>
<img src="https://img-blog.csdn.net/20180305185437217?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd2VpeGluXzQxMDQzMjQw/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述" title=""></p>                