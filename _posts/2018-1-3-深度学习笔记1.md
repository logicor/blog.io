
#深度学习中的序列模型

<p>序列模型是监督学习的一种，也就是其输入数据是带标签的。 <br>
<img src="https://img-blog.csdn.net/20180301170528442?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd2VpeGluXzQxMDQzMjQw/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="序列模型的应用" title=""> <br>
如图给出了几个典型的序列模型的应用，如语音识别、音乐生成（输入可以为空，输出是时序的）、情感分析、DNA序列分析、机器翻译、视频行为识别、人名实体识别等，其特点是输入或输入或者输入输出是时序的。</p>



<h1 id="2-notation数学符号"><a name="t1"></a>2. Notation数学符号</h1>

<p>下面以一个人名实体识别为例讲述表示符号，给出一句话X，识别里面所有的人名，为了使说明简单，这里的输出Y只简单标识每个单词是否为人名，这种表示方式并不是很好，有一些复杂的输出方式可以指出一个人名从哪里开始到哪里结束。 <br>
<img src="https://img-blog.csdn.net/20180301180951242?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd2VpeGluXzQxMDQzMjQw/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述" title=""> <br>
上图输入中有9个单词，那么第一步就是要把单词划分开，表示如下： <br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mi>t</mi><mo>&amp;gt;</mo></mrow></msup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 2.398em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.979em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.226em, 1001.98em, 2.355em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="msubsup" id="MathJax-Span-3"><span style="display: inline-block; position: relative; width: 2.003em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.52em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-4" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.572em;"><span class="texatom" id="MathJax-Span-5"><span class="mrow" id="MathJax-Span-6"><span class="mo" id="MathJax-Span-7" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mi" id="MathJax-Span-8" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-9" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 1.105em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mi>t</mi><mo>&gt;</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-1">x^{<t>}</script> ：表示第t个单词； <br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>T</mi><mi>x</mi></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-10" style="width: 1.253em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.042em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.354em, 1001.04em, 2.502em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-11"><span class="msubsup" id="MathJax-Span-12"><span style="display: inline-block; position: relative; width: 1.063em; height: 0px;"><span style="position: absolute; clip: rect(3.177em, 1000.7em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-13" style="font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.584em;"><span class="mi" id="MathJax-Span-14" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.252em; border-left: 0px solid; width: 0px; height: 1.127em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mi>x</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-2">T_x</script>：表示输入的单词总数，这里<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>T</mi><mi>x</mi></msub><mo>=</mo><mn>9</mn></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-15" style="width: 3.544em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.917em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.406em, 1002.87em, 2.554em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-16"><span class="msubsup" id="MathJax-Span-17"><span style="display: inline-block; position: relative; width: 1.063em; height: 0px;"><span style="position: absolute; clip: rect(3.177em, 1000.7em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-18" style="font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.584em;"><span class="mi" id="MathJax-Span-19" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-20" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-21" style="font-family: MathJax_Main; padding-left: 0.278em;">9</span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.252em; border-left: 0px solid; width: 0px; height: 1.127em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mi>x</mi></msub><mo>=</mo><mn>9</mn></math></span></span><script type="math/tex" id="MathJax-Element-3">T_x=9</script>； <br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mi>t</mi><mo>&amp;gt;</mo></mrow></msup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-22" style="width: 2.398em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.979em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.226em, 1001.98em, 2.549em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-23"><span class="msubsup" id="MathJax-Span-24"><span style="display: inline-block; position: relative; width: 1.978em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.5em, 4.372em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-25" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.548em;"><span class="texatom" id="MathJax-Span-26"><span class="mrow" id="MathJax-Span-27"><span class="mo" id="MathJax-Span-28" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mi" id="MathJax-Span-29" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-30" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.308em; border-left: 0px solid; width: 0px; height: 1.338em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mi>t</mi><mo>&gt;</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-4">y^{<t>}</script>：为第t个单词的输出； <br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>T</mi><mi>y</mi></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-31" style="width: 1.201em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.99em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.354em, 1000.99em, 2.639em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-32"><span class="msubsup" id="MathJax-Span-33"><span style="display: inline-block; position: relative; width: 1.01em; height: 0px;"><span style="position: absolute; clip: rect(3.177em, 1000.7em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-34" style="font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.584em;"><span class="mi" id="MathJax-Span-35" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.416em; border-left: 0px solid; width: 0px; height: 1.291em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mi>y</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-5">T_y</script>：为输出总数，，这里<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>T</mi><mi>y</mi></msub><mo>=</mo><mn>9</mn></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-36" style="width: 3.44em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.865em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.406em, 1002.82em, 2.691em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-37"><span class="msubsup" id="MathJax-Span-38"><span style="display: inline-block; position: relative; width: 1.01em; height: 0px;"><span style="position: absolute; clip: rect(3.177em, 1000.7em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-39" style="font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.584em;"><span class="mi" id="MathJax-Span-40" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-41" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-42" style="font-family: MathJax_Main; padding-left: 0.278em;">9</span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.416em; border-left: 0px solid; width: 0px; height: 1.291em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mi>y</mi></msub><mo>=</mo><mn>9</mn></math></span></span><script type="math/tex" id="MathJax-Element-6">T_y=9</script>； <br>
以上是对单个样本的表示，若有i个样本的话，第i个样本表示如下： <br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;lt;</mo><mi>t</mi><mo>&amp;gt;</mo></mrow></msup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-43" style="width: 3.388em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.813em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.138em, 1002.81em, 2.355em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-44"><span class="msubsup" id="MathJax-Span-45"><span style="display: inline-block; position: relative; width: 2.797em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.52em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-46" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.572em;"><span class="texatom" id="MathJax-Span-47"><span class="mrow" id="MathJax-Span-48"><span class="mo" id="MathJax-Span-49" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-50" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-51" style="font-size: 70.7%; font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-52" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mi" id="MathJax-Span-53" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-54" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 1.21em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mo>&lt;</mo><mi>t</mi><mo>&gt;</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-7">x^{(i)<t>}</script>： 表示第i个样本的第t个单词； <br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi>T</mi><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-55" style="width: 2.034em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.667em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.98em, 1001.67em, 2.5em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-56"><span class="msubsup" id="MathJax-Span-57"><span style="display: inline-block; position: relative; width: 1.659em; height: 0px;"><span style="position: absolute; clip: rect(3.177em, 1000.7em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-58" style="font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.324em, 1000.87em, 4.343em, -1000em); top: -4.532em; left: 0.79em;"><span class="texatom" id="MathJax-Span-59"><span class="mrow" id="MathJax-Span-60"><span class="mo" id="MathJax-Span-61" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-62" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-63" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.542em, 1000.48em, 4.174em, -1000em); top: -3.862em; left: 0.584em;"><span class="mi" id="MathJax-Span-64" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.25em; border-left: 0px solid; width: 0px; height: 1.574em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>T</mi><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-8">T_x^{(i)}</script>：表示第i个样本的输入的单词总数； <br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;lt;</mo><mi>t</mi><mo>&amp;gt;</mo></mrow></msup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-65" style="width: 3.336em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.76em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.138em, 1002.76em, 2.549em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-66"><span class="msubsup" id="MathJax-Span-67"><span style="display: inline-block; position: relative; width: 2.772em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.5em, 4.372em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-68" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.548em;"><span class="texatom" id="MathJax-Span-69"><span class="mrow" id="MathJax-Span-70"><span class="mo" id="MathJax-Span-71" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-72" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-73" style="font-size: 70.7%; font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-74" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mi" id="MathJax-Span-75" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-76" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.308em; border-left: 0px solid; width: 0px; height: 1.443em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mo>&lt;</mo><mi>t</mi><mo>&gt;</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-9">y^{(i)<t>}</script>：为第i个版本的第t个单词的输出； <br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi>T</mi><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-77" style="width: 2.034em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.667em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.98em, 1001.67em, 2.637em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-78"><span class="msubsup" id="MathJax-Span-79"><span style="display: inline-block; position: relative; width: 1.659em; height: 0px;"><span style="position: absolute; clip: rect(3.177em, 1000.7em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-80" style="font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.324em, 1000.87em, 4.343em, -1000em); top: -4.532em; left: 0.79em;"><span class="texatom" id="MathJax-Span-81"><span class="mrow" id="MathJax-Span-82"><span class="mo" id="MathJax-Span-83" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-84" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-85" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.542em, 1000.43em, 4.312em, -1000em); top: -3.862em; left: 0.584em;"><span class="mi" id="MathJax-Span-86" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.414em; border-left: 0px solid; width: 0px; height: 1.739em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>T</mi><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-10">T_y^{(i)}</script>：为第i个样本的输出总数；</p>

<p><strong>如何表示一个单词？</strong> <br>
1. 首先建立一个词汇表vocabulary，也就是将表示方法中所有要用到的词列成一列 <br>
   如下图，建立一个长度为10,000的词表，这对实际中的NLP来说太小了，商用中的词表有的三五万，也有的几十万甚至百万，这里仅用作说明的例子； <br>
2. 用one-hot向量来表示单词 <br>
    也就是每个单词用一个和词表长度一样的向量来表示，向量中除了这个单词所在位置为1，其余都为0，所以称之为one-hot。 <br>
<img src="https://img-blog.csdn.net/20180301181027758?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd2VpeGluXzQxMDQzMjQw/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述" title=""> <br>
<img src="https://img-blog.csdn.net/20180301181042298?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd2VpeGluXzQxMDQzMjQw/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述" title=""> <br>
    如果遇到不在词表中的词，那么可以创建一个新的标记，叫做unknown Word，用UNK表示，之后会详细讨论这个问题。   </p>



<h1 id="3recurrent-neural-network-model循环序列模型"><a name="t2"></a>3.Recurrent Neural Network Model循环序列模型</h1>



<h3 id="1为什么不用标准神经网络"><a name="t3"></a>1）为什么不用标准神经网络？</h3>

<p>实验发现用标准神经网络效果不好，主要原因有两点：</p>

<ul>
<li><p>输入和输出在不同的样本中可以有不同的长度，即使能找到输入输出的最大值，对某个样本来说填充来使他达到最大长度，但是这种表示方式依然不够好；</p></li>
<li><p>标准神经网络不能讲从文本不同位置学习到的特征共享，比如在第一个位置学习到了Harry是一个人名，如果Harry再次出现在其他位置的时候，不能自动识别它是一个人名，还需要重新识别</p></li>
</ul>



<h3 id="2什么是循环神经网络"><a name="t4"></a>2）什么是循环神经网络？</h3>

<p>首先，将第一个单词<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mn>1</mn><mo>&amp;gt;</mo></mrow></msup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-87" style="width: 2.503em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.083em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.197em, 1002.08em, 2.355em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-88"><span class="msubsup" id="MathJax-Span-89"><span style="display: inline-block; position: relative; width: 2.101em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.52em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-90" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.572em;"><span class="texatom" id="MathJax-Span-91"><span class="mrow" id="MathJax-Span-92"><span class="mo" id="MathJax-Span-93" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mn" id="MathJax-Span-94" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-95" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 1.139em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mn>1</mn><mo>&gt;</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-11">x^{<1>}</script>输入神经网络，并预测  <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>y</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mn>1</mn><mo>&amp;gt;</mo></mrow></msup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-96" style="width: 2.607em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.135em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.098em, 1002.14em, 2.549em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-97"><span class="msubsup" id="MathJax-Span-98"><span style="display: inline-block; position: relative; width: 2.113em; height: 0px;"><span style="position: absolute; clip: rect(3.119em, 1000.5em, 4.372em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-99"><span class="mrow" id="MathJax-Span-100"><span class="munderover" id="MathJax-Span-101"><span style="display: inline-block; position: relative; width: 0.585em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.5em, 4.372em, -1000em); top: -4.01em; left: 0.002em;"><span class="mi" id="MathJax-Span-102" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.16em, 1000.39em, 3.636em, -1000em); top: -4.052em; left: 0.085em;"><span class="mo" id="MathJax-Span-103" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.473em; left: 0.585em;"><span class="texatom" id="MathJax-Span-104"><span class="mrow" id="MathJax-Span-105"><span class="mo" id="MathJax-Span-106" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mn" id="MathJax-Span-107" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-108" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.308em; border-left: 0px solid; width: 0px; height: 1.491em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mn>1</mn><mo>&gt;</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-12">\hat y^{<1>}</script>; <br>
 然后，将第二个单词<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mn>2</mn><mo>&amp;gt;</mo></mrow></msup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-109" style="width: 2.503em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.083em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.197em, 1002.08em, 2.355em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-110"><span class="msubsup" id="MathJax-Span-111"><span style="display: inline-block; position: relative; width: 2.101em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.52em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-112" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.572em;"><span class="texatom" id="MathJax-Span-113"><span class="mrow" id="MathJax-Span-114"><span class="mo" id="MathJax-Span-115" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mn" id="MathJax-Span-116" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-117" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 1.139em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mn>2</mn><mo>&gt;</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-13">x^{<2>}</script>输入神经网络，同时将第一步计算的激活值<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mn>1</mn><mo>&amp;gt;</mo></mrow></msup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-118" style="width: 2.503em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.083em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.197em, 1002.08em, 2.354em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-119"><span class="msubsup" id="MathJax-Span-120"><span style="display: inline-block; position: relative; width: 2.058em; height: 0px;"><span style="position: absolute; clip: rect(3.413em, 1000.51em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-121" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.529em;"><span class="texatom" id="MathJax-Span-122"><span class="mrow" id="MathJax-Span-123"><span class="mo" id="MathJax-Span-124" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mn" id="MathJax-Span-125" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-126" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.074em; border-left: 0px solid; width: 0px; height: 1.138em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mn>1</mn><mo>&gt;</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-14">a^{<1>}</script>也输入到神经网络，共同作用并预测<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>y</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mn>2</mn><mo>&amp;gt;</mo></mrow></msup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-127" style="width: 2.607em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.135em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.098em, 1002.14em, 2.549em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-128"><span class="msubsup" id="MathJax-Span-129"><span style="display: inline-block; position: relative; width: 2.113em; height: 0px;"><span style="position: absolute; clip: rect(3.119em, 1000.5em, 4.372em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-130"><span class="mrow" id="MathJax-Span-131"><span class="munderover" id="MathJax-Span-132"><span style="display: inline-block; position: relative; width: 0.585em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.5em, 4.372em, -1000em); top: -4.01em; left: 0.002em;"><span class="mi" id="MathJax-Span-133" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.16em, 1000.39em, 3.636em, -1000em); top: -4.052em; left: 0.085em;"><span class="mo" id="MathJax-Span-134" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.473em; left: 0.585em;"><span class="texatom" id="MathJax-Span-135"><span class="mrow" id="MathJax-Span-136"><span class="mo" id="MathJax-Span-137" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mn" id="MathJax-Span-138" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-139" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.308em; border-left: 0px solid; width: 0px; height: 1.491em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mn>2</mn><mo>&gt;</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-15">\hat y^{<2>}</script>; <br>
 重复第二步，直至把所有单词都训练完毕。 <br>
 <img src="https://img-blog.csdn.net/20180301204144171?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd2VpeGluXzQxMDQzMjQw/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述" title=""> <br>
 注意，由于在第一步之前没有任何输入，所以一般人为设置一个<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mn>0</mn><mo>&amp;gt;</mo></mrow></msup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-140" style="width: 2.503em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.083em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.197em, 1002.08em, 2.354em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-141"><span class="msubsup" id="MathJax-Span-142"><span style="display: inline-block; position: relative; width: 2.058em; height: 0px;"><span style="position: absolute; clip: rect(3.413em, 1000.51em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-143" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.529em;"><span class="texatom" id="MathJax-Span-144"><span class="mrow" id="MathJax-Span-145"><span class="mo" id="MathJax-Span-146" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mn" id="MathJax-Span-147" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-148" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.074em; border-left: 0px solid; width: 0px; height: 1.138em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mn>0</mn><mo>&gt;</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-16">a^{<0>}</script>和<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mn>1</mn><mo>&amp;gt;</mo></mrow></msup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-149" style="width: 2.503em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.083em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.197em, 1002.08em, 2.355em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-150"><span class="msubsup" id="MathJax-Span-151"><span style="display: inline-block; position: relative; width: 2.101em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.52em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-152" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.572em;"><span class="texatom" id="MathJax-Span-153"><span class="mrow" id="MathJax-Span-154"><span class="mo" id="MathJax-Span-155" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mn" id="MathJax-Span-156" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-157" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 1.139em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mn>1</mn><mo>&gt;</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-17">x^{<1>}</script>一起输入到神经网络中，<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mn>0</mn><mo>&amp;gt;</mo></mrow></msup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-158" style="width: 2.503em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.083em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.197em, 1002.08em, 2.354em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-159"><span class="msubsup" id="MathJax-Span-160"><span style="display: inline-block; position: relative; width: 2.058em; height: 0px;"><span style="position: absolute; clip: rect(3.413em, 1000.51em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-161" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.529em;"><span class="texatom" id="MathJax-Span-162"><span class="mrow" id="MathJax-Span-163"><span class="mo" id="MathJax-Span-164" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mn" id="MathJax-Span-165" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-166" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.074em; border-left: 0px solid; width: 0px; height: 1.138em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mn>0</mn><mo>&gt;</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-18">a^{<0>}</script>最常见的初始化为0，不过也有人任意初始化。</p>

<p>在这个结构中输入和输出数目相等，如果输入和输出不等的话，网络结构还需要改变。</p>

<p><strong>参数：</strong> <br>
循环神经网络中的参数是共享的，从输入到隐藏层的参数表示为<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>a</mi><mi>x</mi></mrow></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-167" style="width: 1.878em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.563em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.588em, 1001.56em, 2.502em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-168"><span class="msubsup" id="MathJax-Span-169"><span style="display: inline-block; position: relative; width: 1.57em; height: 0px;"><span style="position: absolute; clip: rect(3.411em, 1000.69em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-170" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.716em;"><span class="texatom" id="MathJax-Span-171"><span class="mrow" id="MathJax-Span-172"><span class="mi" id="MathJax-Span-173" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-174" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.252em; border-left: 0px solid; width: 0px; height: 0.846em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mi>x</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-19">w_{ax}</script>，水平方向激活值向下一层输入的参数表示为<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>a</mi><mi>a</mi></mrow></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-175" style="width: 1.878em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.563em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.588em, 1001.56em, 2.501em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-176"><span class="msubsup" id="MathJax-Span-177"><span style="display: inline-block; position: relative; width: 1.539em; height: 0px;"><span style="position: absolute; clip: rect(3.411em, 1000.69em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-178" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.716em;"><span class="texatom" id="MathJax-Span-179"><span class="mrow" id="MathJax-Span-180"><span class="mi" id="MathJax-Span-181" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-182" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.251em; border-left: 0px solid; width: 0px; height: 0.845em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mi>a</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-20">w_{aa}</script>，从隐藏层到输出的残水表示为<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>y</mi><mi>a</mi></mrow></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-183" style="width: 1.826em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.51em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.588em, 1001.51em, 2.639em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-184"><span class="msubsup" id="MathJax-Span-185"><span style="display: inline-block; position: relative; width: 1.516em; height: 0px;"><span style="position: absolute; clip: rect(3.411em, 1000.69em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-186" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.716em;"><span class="texatom" id="MathJax-Span-187"><span class="mrow" id="MathJax-Span-188"><span class="mi" id="MathJax-Span-189" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span><span class="mi" id="MathJax-Span-190" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.416em; border-left: 0px solid; width: 0px; height: 1.011em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mi>y</mi><mi>a</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-21">w_{ya}</script> <br>
<strong>前向传播：</strong> <br>
<img src="https://img-blog.csdn.net/20180301204441545?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd2VpeGluXzQxMDQzMjQw/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述" title=""> <br>
其中参数<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>a</mi><mi>a</mi></mrow></msub><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>a</mi><mi>x</mi></mrow></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-191" style="width: 3.753em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.125em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.588em, 1003.13em, 2.502em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-192"><span class="msubsup" id="MathJax-Span-193"><span style="display: inline-block; position: relative; width: 1.539em; height: 0px;"><span style="position: absolute; clip: rect(3.411em, 1000.69em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-194" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.716em;"><span class="texatom" id="MathJax-Span-195"><span class="mrow" id="MathJax-Span-196"><span class="mi" id="MathJax-Span-197" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-198" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-199"><span style="display: inline-block; position: relative; width: 1.57em; height: 0px;"><span style="position: absolute; clip: rect(3.411em, 1000.69em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-200" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.716em;"><span class="texatom" id="MathJax-Span-201"><span class="mrow" id="MathJax-Span-202"><span class="mi" id="MathJax-Span-203" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-204" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.252em; border-left: 0px solid; width: 0px; height: 0.846em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mi>a</mi></mrow></msub><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mi>x</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-22">w_{aa} w_{ax}</script>两个参数可以合并为<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>a</mi></mrow></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-205" style="width: 1.409em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.146em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.588em, 1001.15em, 2.501em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-206"><span class="msubsup" id="MathJax-Span-207"><span style="display: inline-block; position: relative; width: 1.165em; height: 0px;"><span style="position: absolute; clip: rect(3.411em, 1000.69em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-208" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.716em;"><span class="texatom" id="MathJax-Span-209"><span class="mrow" id="MathJax-Span-210"><span class="mi" id="MathJax-Span-211" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.251em; border-left: 0px solid; width: 0px; height: 0.845em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-23">w_{a}</script>，若<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>a</mi><mi>a</mi></mrow></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-212" style="width: 1.878em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.563em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.588em, 1001.56em, 2.501em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-213"><span class="msubsup" id="MathJax-Span-214"><span style="display: inline-block; position: relative; width: 1.539em; height: 0px;"><span style="position: absolute; clip: rect(3.411em, 1000.69em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-215" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.716em;"><span class="texatom" id="MathJax-Span-216"><span class="mrow" id="MathJax-Span-217"><span class="mi" id="MathJax-Span-218" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-219" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.251em; border-left: 0px solid; width: 0px; height: 0.845em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mi>a</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-24">w_{aa}</script>为(100,100),<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>a</mi><mi>x</mi></mrow></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-220" style="width: 1.878em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.563em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.588em, 1001.56em, 2.502em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-221"><span class="msubsup" id="MathJax-Span-222"><span style="display: inline-block; position: relative; width: 1.57em; height: 0px;"><span style="position: absolute; clip: rect(3.411em, 1000.69em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-223" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.716em;"><span class="texatom" id="MathJax-Span-224"><span class="mrow" id="MathJax-Span-225"><span class="mi" id="MathJax-Span-226" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-227" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.252em; border-left: 0px solid; width: 0px; height: 0.846em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mi>x</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-25">w_{ax}</script>为(100,10000)，<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>a</mi></mrow></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-228" style="width: 1.409em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.146em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.588em, 1001.15em, 2.501em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-229"><span class="msubsup" id="MathJax-Span-230"><span style="display: inline-block; position: relative; width: 1.165em; height: 0px;"><span style="position: absolute; clip: rect(3.411em, 1000.69em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-231" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.716em;"><span class="texatom" id="MathJax-Span-232"><span class="mrow" id="MathJax-Span-233"><span class="mi" id="MathJax-Span-234" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.251em; border-left: 0px solid; width: 0px; height: 0.845em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-26">w_{a}</script>为(100,10100)，如下图： <br>
<img src="https://img-blog.csdn.net/20180301204937898?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd2VpeGluXzQxMDQzMjQw/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述" title=""> <br>
所以可以表示为： <br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span></p><div class="MathJax_Display" style="text-align: center;"></div><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msup><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mi>t</mi><mo>&amp;gt;</mo></mrow></msup><mo>=</mo><mi>g</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>w</mi><mi>a</mi></msub><mo stretchy=&quot;false&quot;>[</mo><msup><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo>&amp;gt;</mo></mrow></msup><mo>,</mo><msup><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mi>t</mi><mo>&amp;gt;</mo></mrow></msup><mo stretchy=&quot;false&quot;>]</mo><mo>+</mo><msub><mi>b</mi><mi>a</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-235" style="width: 16.461em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.698em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.252em, 1013.6em, 2.698em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-236"><span class="msubsup" id="MathJax-Span-237"><span style="display: inline-block; position: relative; width: 1.96em; height: 0px;"><span style="position: absolute; clip: rect(3.413em, 1000.51em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-238" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.423em; left: 0.529em;"><span class="texatom" id="MathJax-Span-239"><span class="mrow" id="MathJax-Span-240"><span class="mo" id="MathJax-Span-241" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mi" id="MathJax-Span-242" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-243" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-244" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-245" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-246" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-247"><span style="display: inline-block; position: relative; width: 1.165em; height: 0px;"><span style="position: absolute; clip: rect(3.411em, 1000.69em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-248" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.716em;"><span class="mi" id="MathJax-Span-249" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-250" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-251"><span style="display: inline-block; position: relative; width: 2.863em; height: 0px;"><span style="position: absolute; clip: rect(3.413em, 1000.51em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-252" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.423em; left: 0.529em;"><span class="texatom" id="MathJax-Span-253"><span class="mrow" id="MathJax-Span-254"><span class="mo" id="MathJax-Span-255" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mi" id="MathJax-Span-256" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-257" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-258" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-259" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-260" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-261" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 2.003em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.52em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-262" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.423em; left: 0.572em;"><span class="texatom" id="MathJax-Span-263"><span class="mrow" id="MathJax-Span-264"><span class="mo" id="MathJax-Span-265" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mi" id="MathJax-Span-266" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-267" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-268" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-269" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msubsup" id="MathJax-Span-270" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.878em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.42em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-271" style="font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.429em;"><span class="mi" id="MathJax-Span-272" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-273" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.362em; border-left: 0px solid; width: 0px; height: 1.486em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mi>t</mi><mo>&gt;</mo></mrow></msup><mo>=</mo><mi>g</mi><mo stretchy="false">(</mo><msub><mi>w</mi><mi>a</mi></msub><mo stretchy="false">[</mo><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo>&gt;</mo></mrow></msup><mo>,</mo><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mi>t</mi><mo>&gt;</mo></mrow></msup><mo stretchy="false">]</mo><mo>+</mo><msub><mi>b</mi><mi>a</mi></msub><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-27">a^{<t>}=g(w_a[a^{<t-1>},x^{<t>}]+b_a)</script> <br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"></div><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>y</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mi>t</mi><mo>&amp;gt;</mo></mrow></msup><mo>=</mo><mi>g</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>w</mi><mi>y</mi></msub><msup><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mi>t</mi><mo>&amp;gt;</mo></mrow></msup><mo>+</mo><msub><mi>b</mi><mi>y</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-274" style="width: 11.773em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.792em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.231em, 1009.7em, 2.743em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-275"><span class="msubsup" id="MathJax-Span-276"><span style="display: inline-block; position: relative; width: 2.015em; height: 0px;"><span style="position: absolute; clip: rect(3.119em, 1000.5em, 4.372em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-277"><span class="mrow" id="MathJax-Span-278"><span class="munderover" id="MathJax-Span-279"><span style="display: inline-block; position: relative; width: 0.585em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.5em, 4.372em, -1000em); top: -4.01em; left: 0.002em;"><span class="mi" id="MathJax-Span-280" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.16em, 1000.39em, 3.636em, -1000em); top: -4.052em; left: 0.085em;"><span class="mo" id="MathJax-Span-281" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.473em; left: 0.585em;"><span class="texatom" id="MathJax-Span-282"><span class="mrow" id="MathJax-Span-283"><span class="mo" id="MathJax-Span-284" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mi" id="MathJax-Span-285" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-286" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-287" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-288" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-289" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-290"><span style="display: inline-block; position: relative; width: 1.142em; height: 0px;"><span style="position: absolute; clip: rect(3.411em, 1000.69em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-291" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.716em;"><span class="mi" id="MathJax-Span-292" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-293"><span style="display: inline-block; position: relative; width: 1.96em; height: 0px;"><span style="position: absolute; clip: rect(3.413em, 1000.51em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-294" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.423em; left: 0.529em;"><span class="texatom" id="MathJax-Span-295"><span class="mrow" id="MathJax-Span-296"><span class="mo" id="MathJax-Span-297" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mi" id="MathJax-Span-298" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-299" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-300" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msubsup" id="MathJax-Span-301" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.855em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.42em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-302" style="font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.429em;"><span class="mi" id="MathJax-Span-303" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-304" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.416em; border-left: 0px solid; width: 0px; height: 1.565em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mi>t</mi><mo>&gt;</mo></mrow></msup><mo>=</mo><mi>g</mi><mo stretchy="false">(</mo><msub><mi>w</mi><mi>y</mi></msub><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mi>t</mi><mo>&gt;</mo></mrow></msup><mo>+</mo><msub><mi>b</mi><mi>y</mi></msub><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-28">\hat y^{<t>}=g(w_ya^{<t>}+b_y)</script> <br>
关于激活函数，两步的激活函数可以相同也可以不同，一般求<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mi>t</mi><mo>&amp;gt;</mo></mrow></msup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-305" style="width: 2.398em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.979em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.226em, 1001.98em, 2.354em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-306"><span class="msubsup" id="MathJax-Span-307"><span style="display: inline-block; position: relative; width: 1.96em; height: 0px;"><span style="position: absolute; clip: rect(3.413em, 1000.51em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-308" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.529em;"><span class="texatom" id="MathJax-Span-309"><span class="mrow" id="MathJax-Span-310"><span class="mo" id="MathJax-Span-311" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mi" id="MathJax-Span-312" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-313" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.074em; border-left: 0px solid; width: 0px; height: 1.104em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mi>t</mi><mo>&gt;</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-29">a^{<t>}</script>采用tanh或ReLU，求<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>y</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mi>t</mi><mo>&amp;gt;</mo></mrow></msup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-314" style="width: 2.451em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.031em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.126em, 1002.03em, 2.549em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-315"><span class="msubsup" id="MathJax-Span-316"><span style="display: inline-block; position: relative; width: 2.015em; height: 0px;"><span style="position: absolute; clip: rect(3.119em, 1000.5em, 4.372em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-317"><span class="mrow" id="MathJax-Span-318"><span class="munderover" id="MathJax-Span-319"><span style="display: inline-block; position: relative; width: 0.585em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.5em, 4.372em, -1000em); top: -4.01em; left: 0.002em;"><span class="mi" id="MathJax-Span-320" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.16em, 1000.39em, 3.636em, -1000em); top: -4.052em; left: 0.085em;"><span class="mo" id="MathJax-Span-321" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.473em; left: 0.585em;"><span class="texatom" id="MathJax-Span-322"><span class="mrow" id="MathJax-Span-323"><span class="mo" id="MathJax-Span-324" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mi" id="MathJax-Span-325" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-326" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.308em; border-left: 0px solid; width: 0px; height: 1.457em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mi>t</mi><mo>&gt;</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-30">\hat y^{<t>}</script>则根据输出的个数选择sigmoid或者softmax。<p></p>



<h1 id="4-backpropagation-through-time时间反向传播"><a name="t5"></a>4. Backpropagation through time时间反向传播</h1>

<p>上一节讲了RNN正向传播，本节讲RNN反向传播，虽然开源框架通常都会自动计算反向传播，但是了解其原理还是很有帮助的。</p>



<h3 id="损失函数"><a name="t6"></a>损失函数：</h3>

<p>这里损失函数采用标准逻辑回归的损失函数，又叫交叉熵损失函数，具体如下： <br>
<img src="https://img-blog.csdn.net/2018030121093396?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd2VpeGluXzQxMDQzMjQw/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述" title=""></p>



<h3 id="穿越时间的反向传播"><a name="t7"></a>穿越时间的反向传播</h3>

<p><img src="https://img-blog.csdn.net/20180301211007515?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd2VpeGluXzQxMDQzMjQw/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述" title=""></p>



<h1 id="5-different-types-of-rnn"><a name="t8"></a>5. Different types of RNN</h1>

<p>之前将的RNN是建立在输入和输出数目相等的情况下，我们也讲过了，在循环神经网络中，输入和输出数目可以不等，那么这种情况下的RNN结构应该是什么样呢？这一节我们就来讨论RNN的各种不同的结构。</p>



<h3 id="1-one-to-one"><a name="t9"></a>1) one to one</h3>

<p>标准神经网络就是这种类型 <br>
<img src="https://img-blog.csdn.net/20180301213317511?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd2VpeGluXzQxMDQzMjQw/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述" title=""></p>



<h3 id="2-one-to-many-music-generation音乐生成"><a name="t10"></a>2) one to many （music generation音乐生成）</h3>

<p>输入为空，或有较少的输入，产生很多输出 <br>
<img src="https://img-blog.csdn.net/20180301213400259?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd2VpeGluXzQxMDQzMjQw/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述" title=""></p>



<h3 id="3-many-to-one-setiment-classification情感分类"><a name="t11"></a>3) many to one (setiment classification情感分类)</h3>

<p>输入为文本，输出为整数 <br>
<img src="https://img-blog.csdn.net/20180301213417226?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd2VpeGluXzQxMDQzMjQw/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述" title=""></p>



<h3 id="4many-to-many"><a name="t12"></a>4）many to many</h3>

<p>这里又分两类，一类是输入和输出数目相同，一类是输入和输出数目不同。</p>

<ul>
<li><strong>输入和输出数目相同</strong> <br>
这种就是之前将的多个输入产生多个输出的结构，如图： <br>
<img src="https://img-blog.csdn.net/20180301213430889?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd2VpeGluXzQxMDQzMjQw/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述" title=""></li>
<li><strong>输入和输出数目不同</strong> <br>
如machine translation <br>
<img src="https://img-blog.csdn.net/20180301213443483?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd2VpeGluXzQxMDQzMjQw/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述" title=""> <br>
此结构中输入的部分，也就是<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mn>1</mn><mo>&amp;gt;</mo></mrow></msup><mo>&amp;#x2212;</mo><msup><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><msub><mi>T</mi><mi>x</mi></msub><mo>&amp;gt;</mo></mrow></msup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-327" style="width: 7.034em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.833em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.242em, 1005.83em, 2.478em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-328"><span class="msubsup" id="MathJax-Span-329"><span style="display: inline-block; position: relative; width: 2.101em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.52em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-330" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.572em;"><span class="texatom" id="MathJax-Span-331"><span class="mrow" id="MathJax-Span-332"><span class="mo" id="MathJax-Span-333" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mn" id="MathJax-Span-334" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-335" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-336" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-337" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 2.499em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.52em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-338" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.572em;"><span class="texatom" id="MathJax-Span-339"><span class="mrow" id="MathJax-Span-340"><span class="mo" id="MathJax-Span-341" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="msubsup" id="MathJax-Span-342"><span style="display: inline-block; position: relative; width: 0.752em; height: 0px;"><span style="position: absolute; clip: rect(3.375em, 1000.5em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-343" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.904em; left: 0.413em;"><span class="mi" id="MathJax-Span-344" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-345" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.161em; border-left: 0px solid; width: 0px; height: 1.233em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mn>1</mn><mo>&gt;</mo></mrow></msup><mo>−</mo><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><msub><mi>T</mi><mi>x</mi></msub><mo>&gt;</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-31">x^{<1>}-x^{<T_x>}</script>通常被称作encoder，输出部分，也就是<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>y</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mn>1</mn><mo>&amp;gt;</mo></mrow></msup><mo>&amp;#x2212;</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>y</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><msub><mi>T</mi><mi>x</mi></msub><mo>&amp;gt;</mo></mrow></msup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-346" style="width: 7.034em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.833em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.142em, 1005.83em, 2.601em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-347"><span class="msubsup" id="MathJax-Span-348"><span style="display: inline-block; position: relative; width: 2.113em; height: 0px;"><span style="position: absolute; clip: rect(3.119em, 1000.5em, 4.372em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-349"><span class="mrow" id="MathJax-Span-350"><span class="munderover" id="MathJax-Span-351"><span style="display: inline-block; position: relative; width: 0.585em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.5em, 4.372em, -1000em); top: -4.01em; left: 0.002em;"><span class="mi" id="MathJax-Span-352" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.16em, 1000.39em, 3.636em, -1000em); top: -4.052em; left: 0.085em;"><span class="mo" id="MathJax-Span-353" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.473em; left: 0.585em;"><span class="texatom" id="MathJax-Span-354"><span class="mrow" id="MathJax-Span-355"><span class="mo" id="MathJax-Span-356" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mn" id="MathJax-Span-357" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-358" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-359" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-360" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 2.512em; height: 0px;"><span style="position: absolute; clip: rect(3.119em, 1000.5em, 4.372em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-361"><span class="mrow" id="MathJax-Span-362"><span class="munderover" id="MathJax-Span-363"><span style="display: inline-block; position: relative; width: 0.585em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.5em, 4.372em, -1000em); top: -4.01em; left: 0.002em;"><span class="mi" id="MathJax-Span-364" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.16em, 1000.39em, 3.636em, -1000em); top: -4.052em; left: 0.085em;"><span class="mo" id="MathJax-Span-365" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.473em; left: 0.585em;"><span class="texatom" id="MathJax-Span-366"><span class="mrow" id="MathJax-Span-367"><span class="mo" id="MathJax-Span-368" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="msubsup" id="MathJax-Span-369"><span style="display: inline-block; position: relative; width: 0.752em; height: 0px;"><span style="position: absolute; clip: rect(3.375em, 1000.5em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-370" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.904em; left: 0.413em;"><span class="mi" id="MathJax-Span-371" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-372" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.308em; border-left: 0px solid; width: 0px; height: 1.5em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mn>1</mn><mo>&gt;</mo></mrow></msup><mo>−</mo><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><msub><mi>T</mi><mi>x</mi></msub><mo>&gt;</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-32">\hat y^{<1>}-\hat y^{<T_x>}</script>通常被称为decoder。</li>
</ul>



<h3 id="5attention-based-architecture注意力结构"><a name="t13"></a>5）attention based architecture注意力结构</h3>

<p>这部分将在第四周讲</p>



<h1 id="6-language-model-and-sequence-generation语言模型和序列生成"><a name="t14"></a>6 Language model and sequence generation语言模型和序列生成</h1>



<h3 id="1什么是语言模型"><a name="t15"></a>1）什么是语言模型</h3>

<p>语言模型定义一句话发生的可能性。 <br>
比如两句发音一样的话，那么应该是哪句呢？ <br>
<img src="https://img-blog.csdn.net/20180301222503649?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd2VpeGluXzQxMDQzMjQw/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述" title=""> <br>
如图，上面两个句子发音一样，我们根据语义理解知道第二个是正确的，那么对于语音识别来说，需要通过语言模型计算两句话的可能性，然后做出选择。 <br>
语言模型就是输入一个文本序列，估计这一特定序列各单词出现的可能性。</p>



<h3 id="2rnn语言模型"><a name="t16"></a>2）RNN语言模型</h3>

<p>训练集：需要很大的对应语言（如英语）的语料库 <br>
获得训练集之后，训练RNN步骤如下： <br>
（1）首先，应该切分词tokenize，然后对照词汇表获得每个词的索引，如one-hot向量； <br>
（2）其次，如果需要模型能准确的识别句尾，那么需要为每一句话，在句尾加一个结束符‘‘（end of sentence）； <br>
如果遇到一个不在词汇表的词，那么可以删除这个词，代之以’’(unknown Word) <br>
（3）建立RNN model <br>
以如下样本为例：cats average 15 hours of sleep of a day. <br>
<img src="https://img-blog.csdn.net/20180301222629612?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd2VpeGluXzQxMDQzMjQw/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述" title=""> <br>
第一个输入为0向量，然后经过RNN，由一个softmax分类器来预测第一个单词可能会是什么，即计算词汇表中所有单词在这里出现概率，出现概率最高的那个即是这里输出的词，<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-33-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>y</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mn>1</mn><mo>&amp;gt;</mo></mrow></msup><mo>=</mo><mi>c</mi><mi>a</mi><mi>t</mi><mi>s</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-373" style="width: 6.357em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.26em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.202em, 1005.21em, 2.653em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-374"><span class="msubsup" id="MathJax-Span-375"><span style="display: inline-block; position: relative; width: 2.113em; height: 0px;"><span style="position: absolute; clip: rect(3.119em, 1000.5em, 4.372em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-376"><span class="mrow" id="MathJax-Span-377"><span class="munderover" id="MathJax-Span-378"><span style="display: inline-block; position: relative; width: 0.585em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.5em, 4.372em, -1000em); top: -4.01em; left: 0.002em;"><span class="mi" id="MathJax-Span-379" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.16em, 1000.39em, 3.636em, -1000em); top: -4.052em; left: 0.085em;"><span class="mo" id="MathJax-Span-380" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.473em; left: 0.585em;"><span class="texatom" id="MathJax-Span-381"><span class="mrow" id="MathJax-Span-382"><span class="mo" id="MathJax-Span-383" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mn" id="MathJax-Span-384" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-385" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-386" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-387" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">c</span><span class="mi" id="MathJax-Span-388" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-389" style="font-family: MathJax_Math; font-style: italic;">t</span><span class="mi" id="MathJax-Span-390" style="font-family: MathJax_Math; font-style: italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.308em; border-left: 0px solid; width: 0px; height: 1.491em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mn>1</mn><mo>&gt;</mo></mrow></msup><mo>=</mo><mi>c</mi><mi>a</mi><mi>t</mi><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-33">\hat y^{<1>}=cats</script>，这里softmax输出个数与词汇表个数相同； <br>
然后，将<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-34-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>y</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mn>1</mn><mo>&amp;gt;</mo></mrow></msup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-391" style="width: 2.607em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.135em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.098em, 1002.14em, 2.549em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-392"><span class="msubsup" id="MathJax-Span-393"><span style="display: inline-block; position: relative; width: 2.113em; height: 0px;"><span style="position: absolute; clip: rect(3.119em, 1000.5em, 4.372em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-394"><span class="mrow" id="MathJax-Span-395"><span class="munderover" id="MathJax-Span-396"><span style="display: inline-block; position: relative; width: 0.585em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.5em, 4.372em, -1000em); top: -4.01em; left: 0.002em;"><span class="mi" id="MathJax-Span-397" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.16em, 1000.39em, 3.636em, -1000em); top: -4.052em; left: 0.085em;"><span class="mo" id="MathJax-Span-398" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.473em; left: 0.585em;"><span class="texatom" id="MathJax-Span-399"><span class="mrow" id="MathJax-Span-400"><span class="mo" id="MathJax-Span-401" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mn" id="MathJax-Span-402" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-403" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.308em; border-left: 0px solid; width: 0px; height: 1.491em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mn>1</mn><mo>&gt;</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-34">\hat y^{<1>}</script>赋值给<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-35-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mn>2</mn><mo>&amp;gt;</mo></mrow></msup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-404" style="width: 2.503em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.083em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.197em, 1002.08em, 2.355em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-405"><span class="msubsup" id="MathJax-Span-406"><span style="display: inline-block; position: relative; width: 2.101em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.52em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-407" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.572em;"><span class="texatom" id="MathJax-Span-408"><span class="mrow" id="MathJax-Span-409"><span class="mo" id="MathJax-Span-410" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mn" id="MathJax-Span-411" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-412" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 1.139em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mn>2</mn><mo>&gt;</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-35">x^{<2>}</script>，再次输入RNN，获得在<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-36-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>y</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mn>1</mn><mo>&amp;gt;</mo></mrow></msup><mo>=</mo><mi>c</mi><mi>a</mi><mi>t</mi><mi>s</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-413" style="width: 6.357em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.26em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.202em, 1005.21em, 2.653em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-414"><span class="msubsup" id="MathJax-Span-415"><span style="display: inline-block; position: relative; width: 2.113em; height: 0px;"><span style="position: absolute; clip: rect(3.119em, 1000.5em, 4.372em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-416"><span class="mrow" id="MathJax-Span-417"><span class="munderover" id="MathJax-Span-418"><span style="display: inline-block; position: relative; width: 0.585em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.5em, 4.372em, -1000em); top: -4.01em; left: 0.002em;"><span class="mi" id="MathJax-Span-419" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.16em, 1000.39em, 3.636em, -1000em); top: -4.052em; left: 0.085em;"><span class="mo" id="MathJax-Span-420" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.473em; left: 0.585em;"><span class="texatom" id="MathJax-Span-421"><span class="mrow" id="MathJax-Span-422"><span class="mo" id="MathJax-Span-423" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mn" id="MathJax-Span-424" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-425" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-426" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-427" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">c</span><span class="mi" id="MathJax-Span-428" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-429" style="font-family: MathJax_Math; font-style: italic;">t</span><span class="mi" id="MathJax-Span-430" style="font-family: MathJax_Math; font-style: italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.308em; border-left: 0px solid; width: 0px; height: 1.491em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mn>1</mn><mo>&gt;</mo></mrow></msup><mo>=</mo><mi>c</mi><mi>a</mi><mi>t</mi><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-36">\hat y^{<1>}=cats</script>的情况下<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-37-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>y</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mn>2</mn><mo>&amp;gt;</mo></mrow></msup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-431" style="width: 2.607em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.135em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.098em, 1002.14em, 2.549em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-432"><span class="msubsup" id="MathJax-Span-433"><span style="display: inline-block; position: relative; width: 2.113em; height: 0px;"><span style="position: absolute; clip: rect(3.119em, 1000.5em, 4.372em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-434"><span class="mrow" id="MathJax-Span-435"><span class="munderover" id="MathJax-Span-436"><span style="display: inline-block; position: relative; width: 0.585em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.5em, 4.372em, -1000em); top: -4.01em; left: 0.002em;"><span class="mi" id="MathJax-Span-437" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.16em, 1000.39em, 3.636em, -1000em); top: -4.052em; left: 0.085em;"><span class="mo" id="MathJax-Span-438" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.473em; left: 0.585em;"><span class="texatom" id="MathJax-Span-439"><span class="mrow" id="MathJax-Span-440"><span class="mo" id="MathJax-Span-441" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mn" id="MathJax-Span-442" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-443" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.308em; border-left: 0px solid; width: 0px; height: 1.491em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mn>2</mn><mo>&gt;</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-37">\hat y^{<2>}</script>的预测值； <br>
接着，将<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-38-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>y</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mn>2</mn><mo>&amp;gt;</mo></mrow></msup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-444" style="width: 2.607em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.135em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.098em, 1002.14em, 2.549em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-445"><span class="msubsup" id="MathJax-Span-446"><span style="display: inline-block; position: relative; width: 2.113em; height: 0px;"><span style="position: absolute; clip: rect(3.119em, 1000.5em, 4.372em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-447"><span class="mrow" id="MathJax-Span-448"><span class="munderover" id="MathJax-Span-449"><span style="display: inline-block; position: relative; width: 0.585em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.5em, 4.372em, -1000em); top: -4.01em; left: 0.002em;"><span class="mi" id="MathJax-Span-450" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.16em, 1000.39em, 3.636em, -1000em); top: -4.052em; left: 0.085em;"><span class="mo" id="MathJax-Span-451" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.473em; left: 0.585em;"><span class="texatom" id="MathJax-Span-452"><span class="mrow" id="MathJax-Span-453"><span class="mo" id="MathJax-Span-454" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mn" id="MathJax-Span-455" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-456" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.308em; border-left: 0px solid; width: 0px; height: 1.491em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mn>2</mn><mo>&gt;</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-38">\hat y^{<2>}</script>赋值给<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-39-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mn>3</mn><mo>&amp;gt;</mo></mrow></msup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-457" style="width: 2.503em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.083em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.198em, 1002.08em, 2.355em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-458"><span class="msubsup" id="MathJax-Span-459"><span style="display: inline-block; position: relative; width: 2.101em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.52em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-460" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.572em;"><span class="texatom" id="MathJax-Span-461"><span class="mrow" id="MathJax-Span-462"><span class="mo" id="MathJax-Span-463" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mn" id="MathJax-Span-464" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span class="mo" id="MathJax-Span-465" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 1.138em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mn>3</mn><mo>&gt;</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-39">x^{<3>}</script>，再次输入RNN，获得在<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-40-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>y</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mn>1</mn><mo>&amp;gt;</mo></mrow></msup><mo>=</mo><mi>c</mi><mi>a</mi><mi>t</mi><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF0C;</mo></mrow><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>y</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mn>2</mn><mo>&amp;gt;</mo></mrow></msup><mo>=</mo><mi>a</mi><mi>v</mi><mi>e</mi><mi>r</mi><mi>a</mi><mi>g</mi><mi>e</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-466" style="width: 15.523em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.917em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.202em, 1012.88em, 2.653em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-467"><span class="msubsup" id="MathJax-Span-468"><span style="display: inline-block; position: relative; width: 2.113em; height: 0px;"><span style="position: absolute; clip: rect(3.119em, 1000.5em, 4.372em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-469"><span class="mrow" id="MathJax-Span-470"><span class="munderover" id="MathJax-Span-471"><span style="display: inline-block; position: relative; width: 0.585em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.5em, 4.372em, -1000em); top: -4.01em; left: 0.002em;"><span class="mi" id="MathJax-Span-472" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.16em, 1000.39em, 3.636em, -1000em); top: -4.052em; left: 0.085em;"><span class="mo" id="MathJax-Span-473" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.473em; left: 0.585em;"><span class="texatom" id="MathJax-Span-474"><span class="mrow" id="MathJax-Span-475"><span class="mo" id="MathJax-Span-476" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mn" id="MathJax-Span-477" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-478" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-479" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-480" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">c</span><span class="mi" id="MathJax-Span-481" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-482" style="font-family: MathJax_Math; font-style: italic;">t</span><span class="mi" id="MathJax-Span-483" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="texatom" id="MathJax-Span-484"><span class="mrow" id="MathJax-Span-485"><span class="mo" id="MathJax-Span-486"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">，</span></span></span></span><span class="msubsup" id="MathJax-Span-487"><span style="display: inline-block; position: relative; width: 2.113em; height: 0px;"><span style="position: absolute; clip: rect(3.119em, 1000.5em, 4.372em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-488"><span class="mrow" id="MathJax-Span-489"><span class="munderover" id="MathJax-Span-490"><span style="display: inline-block; position: relative; width: 0.585em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.5em, 4.372em, -1000em); top: -4.01em; left: 0.002em;"><span class="mi" id="MathJax-Span-491" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.16em, 1000.39em, 3.636em, -1000em); top: -4.052em; left: 0.085em;"><span class="mo" id="MathJax-Span-492" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.473em; left: 0.585em;"><span class="texatom" id="MathJax-Span-493"><span class="mrow" id="MathJax-Span-494"><span class="mo" id="MathJax-Span-495" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mn" id="MathJax-Span-496" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-497" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-498" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-499" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">a</span><span class="mi" id="MathJax-Span-500" style="font-family: MathJax_Math; font-style: italic;">v</span><span class="mi" id="MathJax-Span-501" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-502" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-503" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-504" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-505" style="font-family: MathJax_Math; font-style: italic;">e</span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.308em; border-left: 0px solid; width: 0px; height: 1.491em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mn>1</mn><mo>&gt;</mo></mrow></msup><mo>=</mo><mi>c</mi><mi>a</mi><mi>t</mi><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mo>，</mo></mrow><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mn>2</mn><mo>&gt;</mo></mrow></msup><mo>=</mo><mi>a</mi><mi>v</mi><mi>e</mi><mi>r</mi><mi>a</mi><mi>g</mi><mi>e</mi></math></span></span><script type="math/tex" id="MathJax-Element-40">\hat y^{<1>}=cats，\hat y^{<2>}=average</script>的情况下<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-41-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>y</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mn>3</mn><mo>&amp;gt;</mo></mrow></msup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-506" style="width: 2.607em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.135em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.099em, 1002.14em, 2.549em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-507"><span class="msubsup" id="MathJax-Span-508"><span style="display: inline-block; position: relative; width: 2.113em; height: 0px;"><span style="position: absolute; clip: rect(3.119em, 1000.5em, 4.372em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-509"><span class="mrow" id="MathJax-Span-510"><span class="munderover" id="MathJax-Span-511"><span style="display: inline-block; position: relative; width: 0.585em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.5em, 4.372em, -1000em); top: -4.01em; left: 0.002em;"><span class="mi" id="MathJax-Span-512" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.16em, 1000.39em, 3.636em, -1000em); top: -4.052em; left: 0.085em;"><span class="mo" id="MathJax-Span-513" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.473em; left: 0.585em;"><span class="texatom" id="MathJax-Span-514"><span class="mrow" id="MathJax-Span-515"><span class="mo" id="MathJax-Span-516" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mn" id="MathJax-Span-517" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span class="mo" id="MathJax-Span-518" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.308em; border-left: 0px solid; width: 0px; height: 1.49em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mn>3</mn><mo>&gt;</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-41">\hat y^{<3>}</script>的预测值，重复此步直至句尾。</p>



<h3 id="损失函数-1"><a name="t17"></a>损失函数：</h3>

<p><img src="https://img-blog.csdn.net/20180301223746625?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd2VpeGluXzQxMDQzMjQw/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述" title=""></p>



<h1 id="7-sampling-novel-sequence新序列采样"><a name="t18"></a>7. Sampling novel sequence新序列采样</h1>

<p>有一个训练好的序列模型，若想知道这个模型学到了什么，应该怎么办，一种非正式的做法就是进行新序列采样，让模型生成一个随机选择的句子，具体做法如下： <br>
<img src="https://img-blog.csdn.net/20180302105831933?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd2VpeGluXzQxMDQzMjQw/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述" title=""> <br>
和语言模型的RNN类似，但是在softmax分类器之后，对其结果进行了采样，获得采样后的<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-42-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>y</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mn>1</mn><mo>&amp;gt;</mo></mrow></msup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-519" style="width: 2.607em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.135em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.098em, 1002.14em, 2.549em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-520"><span class="msubsup" id="MathJax-Span-521"><span style="display: inline-block; position: relative; width: 2.113em; height: 0px;"><span style="position: absolute; clip: rect(3.119em, 1000.5em, 4.372em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-522"><span class="mrow" id="MathJax-Span-523"><span class="munderover" id="MathJax-Span-524"><span style="display: inline-block; position: relative; width: 0.585em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.5em, 4.372em, -1000em); top: -4.01em; left: 0.002em;"><span class="mi" id="MathJax-Span-525" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.16em, 1000.39em, 3.636em, -1000em); top: -4.052em; left: 0.085em;"><span class="mo" id="MathJax-Span-526" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.473em; left: 0.585em;"><span class="texatom" id="MathJax-Span-527"><span class="mrow" id="MathJax-Span-528"><span class="mo" id="MathJax-Span-529" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mn" id="MathJax-Span-530" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-531" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.308em; border-left: 0px solid; width: 0px; height: 1.491em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mn>1</mn><mo>&gt;</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-42">\hat y^{<1>}</script>，采样的numpy命令是np.random.choice，然后将采样后的<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-43-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>y</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mn>1</mn><mo>&amp;gt;</mo></mrow></msup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-532" style="width: 2.607em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.135em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.098em, 1002.14em, 2.549em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-533"><span class="msubsup" id="MathJax-Span-534"><span style="display: inline-block; position: relative; width: 2.113em; height: 0px;"><span style="position: absolute; clip: rect(3.119em, 1000.5em, 4.372em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-535"><span class="mrow" id="MathJax-Span-536"><span class="munderover" id="MathJax-Span-537"><span style="display: inline-block; position: relative; width: 0.585em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.5em, 4.372em, -1000em); top: -4.01em; left: 0.002em;"><span class="mi" id="MathJax-Span-538" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.16em, 1000.39em, 3.636em, -1000em); top: -4.052em; left: 0.085em;"><span class="mo" id="MathJax-Span-539" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.473em; left: 0.585em;"><span class="texatom" id="MathJax-Span-540"><span class="mrow" id="MathJax-Span-541"><span class="mo" id="MathJax-Span-542" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mn" id="MathJax-Span-543" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-544" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.308em; border-left: 0px solid; width: 0px; height: 1.491em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mn>1</mn><mo>&gt;</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-43">\hat y^{<1>}</script>传给下一时间步，重复直至最后一个时间步。</p>

<p>判断句子是否结束的两种方法：</p>

<ul>
<li>在句尾加上结束符“”；</li>
<li>设定需要采样的词数，如20个，或者设置采样时间，时间到了就结束采样。</li>
</ul>

<p>在之一过程中会产生一些未识别标识，如果希望算法不输出未识别标识，那么可以拒绝对预测的未识别标识进行采样，一旦出现未识别标识，就在剩下的词汇表中重采样，直到得到一个不是未识别标识的词。</p>



<h3 id="基于字符的rnn语言模型-character-level-rnn"><a name="t19"></a>基于字符的RNN语言模型 character level RNN</h3>

<p>上面讲的都是基于单词的RNN语言模型，也可以建立基于字符的RNN语言模型。 <br>
字典：观察数据集，将所有可能出现的字符加入字典，如a~z的字符，也可以包括空格，标点符号，数字0~9，如果需要区分大小写，也可以加上大写字符A~Z。 <br>
<img src="https://img-blog.csdn.net/20180302105848690?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd2VpeGluXzQxMDQzMjQw/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述" title=""> <br>
优点：不用担心出现未知标识； <br>
缺点：得到的序列通常很长很多；不善于捕捉句子中的关系，捕捉范围也比基于单词的RNN短；计算成本较高。</p>

<p>下面是两个新序列采样的例子，可以看出基于新闻训练的模型，其产生的句子会更加像新闻，用莎士比亚作品训练的模型，其产生的句子更莎士比亚化。 <br>
<img src="https://img-blog.csdn.net/20180302105901171?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd2VpeGluXzQxMDQzMjQw/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述" title=""></p>



<h1 id="8-vanishing-gradients-with-rnn梯度消失"><a name="t20"></a>8. Vanishing gradients with RNN梯度消失</h1>

<p>有如下两句： <br>
The cat, which already ate……, was full. <br>
The cats, which already ate……, were full. <br>
系动词需要根据主语是单数还是复数来决定，这个句子主语和系动词距离比较远，即后面的词对前面的词有长期的依赖关系，而目前所看到的RNN并不擅长捕捉这种长期依赖关系，因为由于梯度消失或梯度爆炸的问题，两个间隔很远的隐藏层很难互相影响，通常一个隐藏层主要受其附近的一些影藏层的影响，前向传播受其之前几层的影响，后向传播受其之后几层的影响。</p>



<h3 id="梯度爆炸"><a name="t21"></a>梯度爆炸</h3>

<p>对于RNN 来说梯度爆炸也会发生，梯度爆炸其参数值会变得很大甚至出现数值溢出，变成了一个非数字，所以很容易发现。</p>

<p>解决方法： <br>
梯度修剪，也叫最大值修剪，即观察梯度向量，一旦其超过某个阈值，就对其进行缩放，以保证其不会过大</p>



<h3 id="梯度消失"><a name="t22"></a>梯度消失</h3>

<p>梯度消失是RNN面临的首要问题，其解决也较为复杂，主要的解决方案有： <br>
- GRU <br>
- LSTM <br>
后面将会讨论详细的各个解决方法。</p>



<h1 id="gated-recurrent-unitgru门控循环单元"><a name="t23"></a>Gated Recurrent Unit(GRU)门控循环单元</h1>

<p>GRU改变了RNN隐藏层单元使其更好的捕捉深层连接，并改善了梯度消失问题。 <br>
相比于普通的RNN隐藏层单元，GRU增加了一个C(memory cell)记忆细胞，以增加记忆功能。 <br>
<strong>普通RNN单元：</strong> <br>
<img src="https://img-blog.csdn.net/20180302221014279?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd2VpeGluXzQxMDQzMjQw/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述" title=""> <br>
<strong>GRU单元：</strong> <br>
<img src="https://img-blog.csdn.net/20180302221047281?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd2VpeGluXzQxMDQzMjQw/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述" title=""> <br>
<img src="https://img-blog.csdn.net/20180302224211261?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd2VpeGluXzQxMDQzMjQw/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述" title=""> <br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-264-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mi>t</mi><mo>&amp;gt;</mo></mrow></msup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-545" style="width: 2.294em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.875em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.226em, 1001.88em, 2.355em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-546"><span class="msubsup" id="MathJax-Span-547"><span style="display: inline-block; position: relative; width: 1.864em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-548" style="font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.433em;"><span class="texatom" id="MathJax-Span-549"><span class="mrow" id="MathJax-Span-550"><span class="mo" id="MathJax-Span-551" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mi" id="MathJax-Span-552" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-553" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 1.105em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mi>t</mi><mo>&gt;</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-264">c^{<t>}</script>：记忆细胞的在t时间步的值，表示是否要记忆此处的信息，GRU中<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-265-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mi>t</mi><mo>&amp;gt;</mo></mrow></msup><mo>=</mo><msup><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mi>t</mi><mo>&amp;gt;</mo></mrow></msup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-554" style="width: 6.201em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.156em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.278em, 1005.16em, 2.407em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-555"><span class="msubsup" id="MathJax-Span-556"><span style="display: inline-block; position: relative; width: 1.864em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-557" style="font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.433em;"><span class="texatom" id="MathJax-Span-558"><span class="mrow" id="MathJax-Span-559"><span class="mo" id="MathJax-Span-560" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mi" id="MathJax-Span-561" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-562" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-563" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-564" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.96em; height: 0px;"><span style="position: absolute; clip: rect(3.413em, 1000.51em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-565" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.529em;"><span class="texatom" id="MathJax-Span-566"><span class="mrow" id="MathJax-Span-567"><span class="mo" id="MathJax-Span-568" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mi" id="MathJax-Span-569" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-570" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 1.105em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mi>t</mi><mo>&gt;</mo></mrow></msup><mo>=</mo><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mi>t</mi><mo>&gt;</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-265">c^{<t>}=a^{<t>}</script> <br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-266-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>c</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mi>t</mi><mo>&amp;gt;</mo></mrow></msup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-571" style="width: 2.398em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.979em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.126em, 1001.98em, 2.355em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-572"><span class="msubsup" id="MathJax-Span-573"><span style="display: inline-block; position: relative; width: 1.986em; height: 0px;"><span style="position: absolute; clip: rect(3.119em, 1000.46em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-574"><span class="mrow" id="MathJax-Span-575"><span class="munderover" id="MathJax-Span-576"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0.034em;"><span class="mi" id="MathJax-Span-577" style="font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.16em, 1000.39em, 3.636em, -1000em); top: -4.052em; left: 0.056em;"><span class="mo" id="MathJax-Span-578" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.473em; left: 0.556em;"><span class="texatom" id="MathJax-Span-579"><span class="mrow" id="MathJax-Span-580"><span class="mo" id="MathJax-Span-581" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mi" id="MathJax-Span-582" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-583" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 1.224em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>c</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mi>t</mi><mo>&gt;</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-266">\hat c^{<t>}</script>：重写记忆细胞的候选值，是否采用这个值来更新<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-267-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mi>t</mi><mo>&amp;gt;</mo></mrow></msup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-584" style="width: 2.294em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.875em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.226em, 1001.88em, 2.355em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-585"><span class="msubsup" id="MathJax-Span-586"><span style="display: inline-block; position: relative; width: 1.864em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-587" style="font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.433em;"><span class="texatom" id="MathJax-Span-588"><span class="mrow" id="MathJax-Span-589"><span class="mo" id="MathJax-Span-590" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mi" id="MathJax-Span-591" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-592" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 1.105em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mi>t</mi><mo>&gt;</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-267">c^{<t>}</script>取决于<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-268-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi mathvariant=&quot;normal&quot;>&amp;#x0393;</mi><mi>u</mi></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-593" style="width: 1.357em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.094em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.351em, 1001.09em, 2.502em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-594"><span class="msubsup" id="MathJax-Span-595"><span style="display: inline-block; position: relative; width: 1.104em; height: 0px;"><span style="position: absolute; clip: rect(3.174em, 1000.58em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-596" style="font-family: MathJax_Main;">Γ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.625em;"><span class="mi" id="MathJax-Span-597" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">u</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.252em; border-left: 0px solid; width: 0px; height: 1.13em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi mathvariant="normal">Γ</mi><mi>u</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-268">\Gamma _u</script> <br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-269-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi mathvariant=&quot;normal&quot;>&amp;#x0393;</mi><mi>r</mi></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-598" style="width: 1.253em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.042em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.351em, 1001.04em, 2.502em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-599"><span class="msubsup" id="MathJax-Span-600"><span style="display: inline-block; position: relative; width: 1.019em; height: 0px;"><span style="position: absolute; clip: rect(3.174em, 1000.58em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-601" style="font-family: MathJax_Main;">Γ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.625em;"><span class="mi" id="MathJax-Span-602" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">r</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.252em; border-left: 0px solid; width: 0px; height: 1.13em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi mathvariant="normal">Γ</mi><mi>r</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-269">\Gamma _r</script>：相关门，表示<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-270-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo>&amp;gt;</mo></mrow></msup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-603" style="width: 3.336em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.76em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.197em, 1002.76em, 2.355em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-604"><span class="msubsup" id="MathJax-Span-605"><span style="display: inline-block; position: relative; width: 2.767em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-606" style="font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.433em;"><span class="texatom" id="MathJax-Span-607"><span class="mrow" id="MathJax-Span-608"><span class="mo" id="MathJax-Span-609" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mi" id="MathJax-Span-610" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-611" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-612" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-613" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 1.139em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo>&gt;</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-270">c^{<t-1>}</script>跟新的候选值<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-271-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>c</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mi>t</mi><mo>&amp;gt;</mo></mrow></msup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-614" style="width: 2.398em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.979em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.126em, 1001.98em, 2.355em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-615"><span class="msubsup" id="MathJax-Span-616"><span style="display: inline-block; position: relative; width: 1.986em; height: 0px;"><span style="position: absolute; clip: rect(3.119em, 1000.46em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-617"><span class="mrow" id="MathJax-Span-618"><span class="munderover" id="MathJax-Span-619"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0.034em;"><span class="mi" id="MathJax-Span-620" style="font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.16em, 1000.39em, 3.636em, -1000em); top: -4.052em; left: 0.056em;"><span class="mo" id="MathJax-Span-621" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.473em; left: 0.556em;"><span class="texatom" id="MathJax-Span-622"><span class="mrow" id="MathJax-Span-623"><span class="mo" id="MathJax-Span-624" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mi" id="MathJax-Span-625" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-626" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 1.224em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>c</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mi>t</mi><mo>&gt;</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-271">\hat c^{<t>}</script>之间的相关性。 <br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-272-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi mathvariant=&quot;normal&quot;>&amp;#x0393;</mi><mi>u</mi></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-627" style="width: 1.357em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.094em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.351em, 1001.09em, 2.502em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-628"><span class="msubsup" id="MathJax-Span-629"><span style="display: inline-block; position: relative; width: 1.104em; height: 0px;"><span style="position: absolute; clip: rect(3.174em, 1000.58em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-630" style="font-family: MathJax_Main;">Γ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.625em;"><span class="mi" id="MathJax-Span-631" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">u</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.252em; border-left: 0px solid; width: 0px; height: 1.13em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi mathvariant="normal">Γ</mi><mi>u</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-272">\Gamma _u</script>：更新门，u=update，决定什么时候更新记忆细胞，取值范围在0~1，0表示不更新记忆细胞即保持之前的值，1表示更新记忆细胞为候选值。 <br>
<img src="https://img-blog.csdn.net/20180302221117625?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd2VpeGluXzQxMDQzMjQw/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述" title=""> <br>
这里依旧举上一节的例子，根据主语单复数来确定系数。 <br>
首先<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-273-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mn>0</mn><mo>&amp;gt;</mo></mrow></msup><mo>=</mo><msup><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mn>0</mn><mo>&amp;gt;</mo></mrow></msup><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mn>0</mn><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></mover></mrow></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-632" style="width: 8.648em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.188em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.089em, 1007.15em, 2.418em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-633"><span class="msubsup" id="MathJax-Span-634"><span style="display: inline-block; position: relative; width: 1.962em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-635" style="font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.433em;"><span class="texatom" id="MathJax-Span-636"><span class="mrow" id="MathJax-Span-637"><span class="mo" id="MathJax-Span-638" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mn" id="MathJax-Span-639" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-640" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-641" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-642" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 2.058em; height: 0px;"><span style="position: absolute; clip: rect(3.413em, 1000.51em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-643" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.529em;"><span class="texatom" id="MathJax-Span-644"><span class="mrow" id="MathJax-Span-645"><span class="mo" id="MathJax-Span-646" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mn" id="MathJax-Span-647" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-648" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-649" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="texatom" id="MathJax-Span-650" style="padding-left: 0.278em;"><span class="mrow" id="MathJax-Span-651"><span class="munderover" id="MathJax-Span-652"><span style="display: inline-block; position: relative; width: 0.5em; height: 0px;"><span style="position: absolute; clip: rect(3.188em, 1000.46em, 4.189em, -1000em); top: -4.01em; left: 0em;"><span class="mn" id="MathJax-Span-653" style="font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.291em; left: 0.029em;"><span style="height: 0em; vertical-align: 0em; width: 0.471em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-654" style="font-family: MathJax_Main;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.26em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.089em; border-left: 0px solid; width: 0px; height: 1.344em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mn>0</mn><mo>&gt;</mo></mrow></msup><mo>=</mo><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mn>0</mn><mo>&gt;</mo></mrow></msup><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mover><mn>0</mn><mo stretchy="false">→</mo></mover></mrow></math></span></span><script type="math/tex" id="MathJax-Element-273">c^{<0>}=a^{<0>}=\vec 0</script>，第一个单词不需要记忆，<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-274-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi mathvariant=&quot;normal&quot;>&amp;#x0393;</mi><mi>u</mi></msub><mo>=</mo><mn>0</mn><mo>,</mo><msup><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mn>1</mn><mo>&amp;gt;</mo></mrow></msup><mo>=</mo><msup><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mn>0</mn><mo>&amp;gt;</mo></mrow></msup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-655" style="width: 10.419em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.646em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.25em, 1008.65em, 2.59em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-656"><span class="msubsup" id="MathJax-Span-657"><span style="display: inline-block; position: relative; width: 1.104em; height: 0px;"><span style="position: absolute; clip: rect(3.174em, 1000.58em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-658" style="font-family: MathJax_Main;">Γ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.625em;"><span class="mi" id="MathJax-Span-659" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">u</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-660" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-661" style="font-family: MathJax_Main; padding-left: 0.278em;">0</span><span class="mo" id="MathJax-Span-662" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-663" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.962em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-664" style="font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.433em;"><span class="texatom" id="MathJax-Span-665"><span class="mrow" id="MathJax-Span-666"><span class="mo" id="MathJax-Span-667" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mn" id="MathJax-Span-668" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-669" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-670" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-671" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.962em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-672" style="font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.433em;"><span class="texatom" id="MathJax-Span-673"><span class="mrow" id="MathJax-Span-674"><span class="mo" id="MathJax-Span-675" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mn" id="MathJax-Span-676" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-677" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.295em; border-left: 0px solid; width: 0px; height: 1.358em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi mathvariant="normal">Γ</mi><mi>u</mi></msub><mo>=</mo><mn>0</mn><mo>,</mo><msup><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mn>1</mn><mo>&gt;</mo></mrow></msup><mo>=</mo><msup><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mn>0</mn><mo>&gt;</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-274">\Gamma _u=0, c^{<1>}=c^{<0>}</script>; <br>
第二个单词cat需要记忆信息，所以<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-275-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi mathvariant=&quot;normal&quot;>&amp;#x0393;</mi><mi>u</mi></msub><mo>=</mo><mn>1</mn><mo>,</mo><msup><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mn>2</mn><mo>&amp;gt;</mo></mrow></msup><mo>=</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>c</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mn>2</mn><mo>&amp;gt;</mo></mrow></msup><mo>=</mo><mn>1</mn></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-678" style="width: 12.711em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.573em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.15em, 1010.5em, 2.59em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-679"><span class="msubsup" id="MathJax-Span-680"><span style="display: inline-block; position: relative; width: 1.104em; height: 0px;"><span style="position: absolute; clip: rect(3.174em, 1000.58em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-681" style="font-family: MathJax_Main;">Γ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.625em;"><span class="mi" id="MathJax-Span-682" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">u</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-683" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-684" style="font-family: MathJax_Main; padding-left: 0.278em;">1</span><span class="mo" id="MathJax-Span-685" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-686" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.962em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-687" style="font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.433em;"><span class="texatom" id="MathJax-Span-688"><span class="mrow" id="MathJax-Span-689"><span class="mo" id="MathJax-Span-690" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mn" id="MathJax-Span-691" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-692" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-693" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-694" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 2.084em; height: 0px;"><span style="position: absolute; clip: rect(3.119em, 1000.46em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-695"><span class="mrow" id="MathJax-Span-696"><span class="munderover" id="MathJax-Span-697"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0.034em;"><span class="mi" id="MathJax-Span-698" style="font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.16em, 1000.39em, 3.636em, -1000em); top: -4.052em; left: 0.056em;"><span class="mo" id="MathJax-Span-699" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.473em; left: 0.556em;"><span class="texatom" id="MathJax-Span-700"><span class="mrow" id="MathJax-Span-701"><span class="mo" id="MathJax-Span-702" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mn" id="MathJax-Span-703" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-704" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-705" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-706" style="font-family: MathJax_Main; padding-left: 0.278em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.295em; border-left: 0px solid; width: 0px; height: 1.478em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi mathvariant="normal">Γ</mi><mi>u</mi></msub><mo>=</mo><mn>1</mn><mo>,</mo><msup><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mn>2</mn><mo>&gt;</mo></mrow></msup><mo>=</mo><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>c</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mn>2</mn><mo>&gt;</mo></mrow></msup><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-275">\Gamma _u=1, c^{<2>}=\hat c^{<2>}=1</script>； <br>
第三个词which不需要记忆，<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-276-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi mathvariant=&quot;normal&quot;>&amp;#x0393;</mi><mi>u</mi></msub><mo>=</mo><mn>0</mn><mo>,</mo><msup><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mn>3</mn><mo>&amp;gt;</mo></mrow></msup><mo>=</mo><msup><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mn>2</mn><mo>&amp;gt;</mo></mrow></msup><mo>=</mo><mn>1</mn></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-707" style="width: 12.607em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.469em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.25em, 1010.4em, 2.59em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-708"><span class="msubsup" id="MathJax-Span-709"><span style="display: inline-block; position: relative; width: 1.104em; height: 0px;"><span style="position: absolute; clip: rect(3.174em, 1000.58em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-710" style="font-family: MathJax_Main;">Γ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.625em;"><span class="mi" id="MathJax-Span-711" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">u</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-712" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-713" style="font-family: MathJax_Main; padding-left: 0.278em;">0</span><span class="mo" id="MathJax-Span-714" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-715" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.962em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-716" style="font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.433em;"><span class="texatom" id="MathJax-Span-717"><span class="mrow" id="MathJax-Span-718"><span class="mo" id="MathJax-Span-719" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mn" id="MathJax-Span-720" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span class="mo" id="MathJax-Span-721" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-722" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-723" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.962em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-724" style="font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.433em;"><span class="texatom" id="MathJax-Span-725"><span class="mrow" id="MathJax-Span-726"><span class="mo" id="MathJax-Span-727" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mn" id="MathJax-Span-728" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-729" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-730" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-731" style="font-family: MathJax_Main; padding-left: 0.278em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.295em; border-left: 0px solid; width: 0px; height: 1.358em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi mathvariant="normal">Γ</mi><mi>u</mi></msub><mo>=</mo><mn>0</mn><mo>,</mo><msup><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mn>3</mn><mo>&gt;</mo></mrow></msup><mo>=</mo><msup><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mn>2</mn><mo>&gt;</mo></mrow></msup><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-276">\Gamma _u=0, c^{<3>}=c^{<2>}=1</script>； <br>
一直到单词was，需要更新，<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-277-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi mathvariant=&quot;normal&quot;>&amp;#x0393;</mi><mi>u</mi></msub><mo>=</mo><mn>1</mn><mo>,</mo><msup><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mi>t</mi><mo>&amp;gt;</mo></mrow></msup><mo>=</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>c</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo>&amp;gt;</mo></mrow></msup><mo>=</mo><mn>0</mn></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-732" style="width: 13.596em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.302em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.15em, 1011.26em, 2.59em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-733"><span class="msubsup" id="MathJax-Span-734"><span style="display: inline-block; position: relative; width: 1.104em; height: 0px;"><span style="position: absolute; clip: rect(3.174em, 1000.58em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-735" style="font-family: MathJax_Main;">Γ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.625em;"><span class="mi" id="MathJax-Span-736" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">u</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-737" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-738" style="font-family: MathJax_Main; padding-left: 0.278em;">1</span><span class="mo" id="MathJax-Span-739" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-740" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.864em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-741" style="font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.433em;"><span class="texatom" id="MathJax-Span-742"><span class="mrow" id="MathJax-Span-743"><span class="mo" id="MathJax-Span-744" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mi" id="MathJax-Span-745" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-746" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-747" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-748" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 2.89em; height: 0px;"><span style="position: absolute; clip: rect(3.119em, 1000.46em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-749"><span class="mrow" id="MathJax-Span-750"><span class="munderover" id="MathJax-Span-751"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0.034em;"><span class="mi" id="MathJax-Span-752" style="font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.16em, 1000.39em, 3.636em, -1000em); top: -4.052em; left: 0.056em;"><span class="mo" id="MathJax-Span-753" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.473em; left: 0.556em;"><span class="texatom" id="MathJax-Span-754"><span class="mrow" id="MathJax-Span-755"><span class="mo" id="MathJax-Span-756" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mi" id="MathJax-Span-757" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-758" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-759" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-760" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-761" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-762" style="font-family: MathJax_Main; padding-left: 0.278em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.295em; border-left: 0px solid; width: 0px; height: 1.478em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi mathvariant="normal">Γ</mi><mi>u</mi></msub><mo>=</mo><mn>1</mn><mo>,</mo><msup><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mi>t</mi><mo>&gt;</mo></mrow></msup><mo>=</mo><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>c</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo>&gt;</mo></mrow></msup><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-277">\Gamma _u=1, c^{<t>}=\hat c^{<t-1>}=0</script></p>

<h1 id="10-lstmlong-short-term-memory-unit长短时记忆单元"><a name="t24"></a>10. LSTM(Long  short term memory) Unit长短时记忆单元</h1>

<p>LSTM比之GRU更加有效。注意：LSTM中<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-56-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mi>t</mi><mo>&amp;gt;</mo></mrow></msup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-763" style="width: 2.294em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.875em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.226em, 1001.88em, 2.355em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-764"><span class="msubsup" id="MathJax-Span-765"><span style="display: inline-block; position: relative; width: 1.864em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-766" style="font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.433em;"><span class="texatom" id="MathJax-Span-767"><span class="mrow" id="MathJax-Span-768"><span class="mo" id="MathJax-Span-769" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mi" id="MathJax-Span-770" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-771" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 1.105em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mi>t</mi><mo>&gt;</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-56">c^{<t>}</script>和<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-57-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mi>t</mi><mo>&amp;gt;</mo></mrow></msup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-772" style="width: 2.398em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.979em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.226em, 1001.98em, 2.354em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-773"><span class="msubsup" id="MathJax-Span-774"><span style="display: inline-block; position: relative; width: 1.96em; height: 0px;"><span style="position: absolute; clip: rect(3.413em, 1000.51em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-775" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.529em;"><span class="texatom" id="MathJax-Span-776"><span class="mrow" id="MathJax-Span-777"><span class="mo" id="MathJax-Span-778" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mi" id="MathJax-Span-779" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-780" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.074em; border-left: 0px solid; width: 0px; height: 1.104em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mi>t</mi><mo>&gt;</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-57">a^{<t>}</script>将不再相等。 <br>
<img src="https://img-blog.csdn.net/20180302224556379?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd2VpeGluXzQxMDQzMjQw/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述" title=""> <br>
 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-58-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi mathvariant=&quot;normal&quot;>&amp;#x0393;</mi><mi>u</mi></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-781" style="width: 1.357em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.094em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.351em, 1001.09em, 2.502em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-782"><span class="msubsup" id="MathJax-Span-783"><span style="display: inline-block; position: relative; width: 1.104em; height: 0px;"><span style="position: absolute; clip: rect(3.174em, 1000.58em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-784" style="font-family: MathJax_Main;">Γ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.625em;"><span class="mi" id="MathJax-Span-785" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">u</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.252em; border-left: 0px solid; width: 0px; height: 1.13em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi mathvariant="normal">Γ</mi><mi>u</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-58">\Gamma _u</script>：更新门（update） <br>
 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-59-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi mathvariant=&quot;normal&quot;>&amp;#x0393;</mi><mi>f</mi></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-786" style="width: 1.357em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.094em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.351em, 1001.09em, 2.643em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-787"><span class="msubsup" id="MathJax-Span-788"><span style="display: inline-block; position: relative; width: 1.089em; height: 0px;"><span style="position: absolute; clip: rect(3.174em, 1000.58em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-789" style="font-family: MathJax_Main;">Γ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.856em; left: 0.625em;"><span class="mi" id="MathJax-Span-790" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.042em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.421em; border-left: 0px solid; width: 0px; height: 1.3em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi mathvariant="normal">Γ</mi><mi>f</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-59">\Gamma _f</script>：遗忘门（forget） <br>
 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-60-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi mathvariant=&quot;normal&quot;>&amp;#x0393;</mi><mi>o</mi></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-791" style="width: 1.253em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.042em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.351em, 1001.04em, 2.502em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-792"><span class="msubsup" id="MathJax-Span-793"><span style="display: inline-block; position: relative; width: 1.043em; height: 0px;"><span style="position: absolute; clip: rect(3.174em, 1000.58em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-794" style="font-family: MathJax_Main;">Γ</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.625em;"><span class="mi" id="MathJax-Span-795" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">o</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.252em; border-left: 0px solid; width: 0px; height: 1.13em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi mathvariant="normal">Γ</mi><mi>o</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-60">\Gamma _o</script>：输出门（output）</p>

<p>peephole connection窥视孔连接，将<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-61-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo>&amp;gt;</mo></mrow></msup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-796" style="width: 3.336em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.76em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.197em, 1002.76em, 2.355em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-797"><span class="msubsup" id="MathJax-Span-798"><span style="display: inline-block; position: relative; width: 2.767em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-799" style="font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.433em;"><span class="texatom" id="MathJax-Span-800"><span class="mrow" id="MathJax-Span-801"><span class="mo" id="MathJax-Span-802" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mi" id="MathJax-Span-803" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-804" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-805" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-806" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 1.139em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo>&gt;</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-61">c^{<t-1>}</script>加入到对门的计算中，也就是门由<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-62-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo>&amp;gt;</mo></mrow></msup><mo>,</mo><msup><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo>&amp;gt;</mo></mrow></msup><mo>,</mo><msup><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mi>t</mi><mo>&amp;gt;</mo></mrow></msup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-807" style="width: 10.263em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.542em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.25em, 1008.54em, 2.59em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-808"><span class="msubsup" id="MathJax-Span-809"><span style="display: inline-block; position: relative; width: 2.767em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-810" style="font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.433em;"><span class="texatom" id="MathJax-Span-811"><span class="mrow" id="MathJax-Span-812"><span class="mo" id="MathJax-Span-813" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mi" id="MathJax-Span-814" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-815" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-816" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-817" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-818" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-819" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 2.863em; height: 0px;"><span style="position: absolute; clip: rect(3.413em, 1000.51em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-820" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.529em;"><span class="texatom" id="MathJax-Span-821"><span class="mrow" id="MathJax-Span-822"><span class="mo" id="MathJax-Span-823" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mi" id="MathJax-Span-824" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-825" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-826" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-827" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-828" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-829" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 2.003em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.52em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-830" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.572em;"><span class="texatom" id="MathJax-Span-831"><span class="mrow" id="MathJax-Span-832"><span class="mo" id="MathJax-Span-833" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mi" id="MathJax-Span-834" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-835" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.295em; border-left: 0px solid; width: 0px; height: 1.358em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo>&gt;</mo></mrow></msup><mo>,</mo><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo>&gt;</mo></mrow></msup><mo>,</mo><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mi>t</mi><mo>&gt;</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-62">c^{<t-1>},a^{<t-1>},x^{<t>}</script>共同决定。</p>

<p>GRU和LSTM比较： <br>
GRU结构更简单，更有利于构建深层的RNN，LSTM功能更强大。</p>



<h1 id="11-bidirectional-rnn双向循环神经网络"><a name="t25"></a>11. Bidirectional RNN双向循环神经网络</h1>

<p>此网络结构使得在序列的某点，既可以获得之前的信息，也可以获得之后的信息。 <br>
以一个人名实体识别的例子来说明，下面两句话，判断Teddy是不是一个人名，只有前面的信息是不足够的。 <br>
<img src="https://img-blog.csdn.net/20180302230247666?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd2VpeGluXzQxMDQzMjQw/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述" title=""> <br>
<img src="https://img-blog.csdn.net/20180302230536964?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd2VpeGluXzQxMDQzMjQw/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述" title=""> <br>
图中最下面<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-63-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mn>1</mn><mo>&amp;gt;</mo></mrow></msup><mtext>&amp;#xA0;</mtext><msup><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mn>4</mn><mo>&amp;gt;</mo></mrow></msup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-836" style="width: 5.315em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.427em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.242em, 1004.43em, 2.407em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-837"><span class="msubsup" id="MathJax-Span-838"><span style="display: inline-block; position: relative; width: 2.101em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.52em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-839" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.572em;"><span class="texatom" id="MathJax-Span-840"><span class="mrow" id="MathJax-Span-841"><span class="mo" id="MathJax-Span-842" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mn" id="MathJax-Span-843" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-844" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mtext" id="MathJax-Span-845" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-846"><span style="display: inline-block; position: relative; width: 2.101em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.52em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-847" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.572em;"><span class="texatom" id="MathJax-Span-848"><span class="mrow" id="MathJax-Span-849"><span class="mo" id="MathJax-Span-850" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mn" id="MathJax-Span-851" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span class="mo" id="MathJax-Span-852" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 1.148em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mn>1</mn><mo>&gt;</mo></mrow></msup><mtext>&nbsp;</mtext><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mn>4</mn><mo>&gt;</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-63">x^{<1>}~x^{<4>}</script>表示输入的前四个单词，紫色框表示的是正向循环层，绿色框是反向循环层，正向循环和反向循环构成一个无环图，都属于正向传播，各值计算顺序如下： <br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span></p><div class="MathJax_Display" style="text-align: center;"></div><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-64-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>a</mi><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></mover></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mn>1</mn><mo>&amp;gt;</mo></mrow></msup><mo>&amp;#x2212;</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>a</mi><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></mover></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mn>2</mn><mo>&amp;gt;</mo></mrow></msup><mo>&amp;#x2212;</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>a</mi><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></mover></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mn>3</mn><mo>&amp;gt;</mo></mrow></msup><mo>&amp;#x2212;</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>a</mi><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></mover></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mn>4</mn><mo>&amp;gt;</mo></mrow></msup><mo>&amp;#x2212;</mo><msup><mover><mi>a</mi><mo>&amp;#x2190;</mo></mover><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mn>4</mn><mo>&amp;gt;</mo></mrow></msup><mo>&amp;#x2212;</mo><msup><mover><mi>a</mi><mo>&amp;#x2190;</mo></mover><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mn>3</mn><mo>&amp;gt;</mo></mrow></msup><mo>&amp;#x2212;</mo><msup><mover><mi>a</mi><mo>&amp;#x2190;</mo></mover><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mn>2</mn><mo>&amp;gt;</mo></mrow></msup><mo>&amp;#x2212;</mo><msup><mover><mi>a</mi><mo>&amp;#x2190;</mo></mover><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mn>1</mn><mo>&amp;gt;</mo></mrow></msup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-853" style="width: 32.346em; display: inline-block;"><span style="display: inline-block; position: relative; width: 26.927em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.784em, 1026.93em, 2.478em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-854"><span class="msubsup" id="MathJax-Span-855"><span style="display: inline-block; position: relative; width: 2.058em; height: 0px;"><span style="position: absolute; clip: rect(3.085em, 1000.51em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-856"><span class="mrow" id="MathJax-Span-857"><span class="munderover" id="MathJax-Span-858"><span style="display: inline-block; position: relative; width: 0.529em; height: 0px;"><span style="position: absolute; clip: rect(3.413em, 1000.51em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-859" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.066em; left: 0.044em;"><span style="height: 0em; vertical-align: 0em; width: 0.471em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-860" style="font-family: MathJax_Main;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.26em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.507em; left: 0.529em;"><span class="texatom" id="MathJax-Span-861"><span class="mrow" id="MathJax-Span-862"><span class="mo" id="MathJax-Span-863" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mn" id="MathJax-Span-864" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-865" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-866" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-867" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 2.058em; height: 0px;"><span style="position: absolute; clip: rect(3.085em, 1000.51em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-868"><span class="mrow" id="MathJax-Span-869"><span class="munderover" id="MathJax-Span-870"><span style="display: inline-block; position: relative; width: 0.529em; height: 0px;"><span style="position: absolute; clip: rect(3.413em, 1000.51em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-871" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.066em; left: 0.044em;"><span style="height: 0em; vertical-align: 0em; width: 0.471em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-872" style="font-family: MathJax_Main;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.26em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.507em; left: 0.529em;"><span class="texatom" id="MathJax-Span-873"><span class="mrow" id="MathJax-Span-874"><span class="mo" id="MathJax-Span-875" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mn" id="MathJax-Span-876" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-877" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-878" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-879" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 2.058em; height: 0px;"><span style="position: absolute; clip: rect(3.085em, 1000.51em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-880"><span class="mrow" id="MathJax-Span-881"><span class="munderover" id="MathJax-Span-882"><span style="display: inline-block; position: relative; width: 0.529em; height: 0px;"><span style="position: absolute; clip: rect(3.413em, 1000.51em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-883" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.066em; left: 0.044em;"><span style="height: 0em; vertical-align: 0em; width: 0.471em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-884" style="font-family: MathJax_Main;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.26em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.507em; left: 0.529em;"><span class="texatom" id="MathJax-Span-885"><span class="mrow" id="MathJax-Span-886"><span class="mo" id="MathJax-Span-887" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mn" id="MathJax-Span-888" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span class="mo" id="MathJax-Span-889" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-890" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-891" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 2.058em; height: 0px;"><span style="position: absolute; clip: rect(3.085em, 1000.51em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-892"><span class="mrow" id="MathJax-Span-893"><span class="munderover" id="MathJax-Span-894"><span style="display: inline-block; position: relative; width: 0.529em; height: 0px;"><span style="position: absolute; clip: rect(3.413em, 1000.51em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-895" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.066em; left: 0.044em;"><span style="height: 0em; vertical-align: 0em; width: 0.471em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-896" style="font-family: MathJax_Main;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.26em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.507em; left: 0.529em;"><span class="texatom" id="MathJax-Span-897"><span class="mrow" id="MathJax-Span-898"><span class="mo" id="MathJax-Span-899" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mn" id="MathJax-Span-900" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span class="mo" id="MathJax-Span-901" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-902" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-903" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 2.529em; height: 0px;"><span style="position: absolute; clip: rect(2.761em, 1000.94em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="munderover" id="MathJax-Span-904"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(3.413em, 1000.51em, 4.177em, -1000em); top: -4.01em; left: 0.235em;"><span class="mi" id="MathJax-Span-905" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1000.94em, 4.178em, -1000em); top: -4.593em; left: 0em;"><span class="mo" id="MathJax-Span-906" style=""><span style="font-family: MathJax_Main;">←</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.831em; left: 1em;"><span class="texatom" id="MathJax-Span-907"><span class="mrow" id="MathJax-Span-908"><span class="mo" id="MathJax-Span-909" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mn" id="MathJax-Span-910" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span class="mo" id="MathJax-Span-911" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-912" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-913" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 2.529em; height: 0px;"><span style="position: absolute; clip: rect(2.761em, 1000.94em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="munderover" id="MathJax-Span-914"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(3.413em, 1000.51em, 4.177em, -1000em); top: -4.01em; left: 0.235em;"><span class="mi" id="MathJax-Span-915" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1000.94em, 4.178em, -1000em); top: -4.593em; left: 0em;"><span class="mo" id="MathJax-Span-916" style=""><span style="font-family: MathJax_Main;">←</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.831em; left: 1em;"><span class="texatom" id="MathJax-Span-917"><span class="mrow" id="MathJax-Span-918"><span class="mo" id="MathJax-Span-919" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mn" id="MathJax-Span-920" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span class="mo" id="MathJax-Span-921" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-922" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-923" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 2.529em; height: 0px;"><span style="position: absolute; clip: rect(2.761em, 1000.94em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="munderover" id="MathJax-Span-924"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(3.413em, 1000.51em, 4.177em, -1000em); top: -4.01em; left: 0.235em;"><span class="mi" id="MathJax-Span-925" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1000.94em, 4.178em, -1000em); top: -4.593em; left: 0em;"><span class="mo" id="MathJax-Span-926" style=""><span style="font-family: MathJax_Main;">←</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.831em; left: 1em;"><span class="texatom" id="MathJax-Span-927"><span class="mrow" id="MathJax-Span-928"><span class="mo" id="MathJax-Span-929" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mn" id="MathJax-Span-930" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-931" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-932" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-933" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 2.529em; height: 0px;"><span style="position: absolute; clip: rect(2.761em, 1000.94em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="munderover" id="MathJax-Span-934"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(3.413em, 1000.51em, 4.177em, -1000em); top: -4.01em; left: 0.235em;"><span class="mi" id="MathJax-Span-935" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1000.94em, 4.178em, -1000em); top: -4.593em; left: 0em;"><span class="mo" id="MathJax-Span-936" style=""><span style="font-family: MathJax_Main;">←</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.831em; left: 1em;"><span class="texatom" id="MathJax-Span-937"><span class="mrow" id="MathJax-Span-938"><span class="mo" id="MathJax-Span-939" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mn" id="MathJax-Span-940" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-941" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.161em; border-left: 0px solid; width: 0px; height: 1.782em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>a</mi><mo stretchy="false">→</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mn>1</mn><mo>&gt;</mo></mrow></msup><mo>−</mo><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>a</mi><mo stretchy="false">→</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mn>2</mn><mo>&gt;</mo></mrow></msup><mo>−</mo><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>a</mi><mo stretchy="false">→</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mn>3</mn><mo>&gt;</mo></mrow></msup><mo>−</mo><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>a</mi><mo stretchy="false">→</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mn>4</mn><mo>&gt;</mo></mrow></msup><mo>−</mo><msup><mover><mi>a</mi><mo>←</mo></mover><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mn>4</mn><mo>&gt;</mo></mrow></msup><mo>−</mo><msup><mover><mi>a</mi><mo>←</mo></mover><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mn>3</mn><mo>&gt;</mo></mrow></msup><mo>−</mo><msup><mover><mi>a</mi><mo>←</mo></mover><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mn>2</mn><mo>&gt;</mo></mrow></msup><mo>−</mo><msup><mover><mi>a</mi><mo>←</mo></mover><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mn>1</mn><mo>&gt;</mo></mrow></msup></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-64">\vec a^{<1>} -\vec a^{<2>} -\vec a^{<3>} -\vec a^{<4>} -\overleftarrow a^{<4>}-\overleftarrow a^{<3>}-\overleftarrow a^{<2>}-\overleftarrow a^{<1>}</script> <br>
所有的激活值都计算完毕之后，就可以计算预测值了： <br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"></div><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-65-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>y</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mi>t</mi><mo>&amp;gt;</mo></mrow></msup><mo>=</mo><mi>g</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>w</mi><mi>y</mi></msub><mo stretchy=&quot;false&quot;>[</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>a</mi><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></mover></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mi>t</mi><mo>&amp;gt;</mo></mrow></msup><mo>,</mo><msup><mover><mi>a</mi><mo>&amp;#x2190;</mo></mover><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;lt;</mo><mi>t</mi><mo>&amp;gt;</mo></mrow></msup><mo stretchy=&quot;false&quot;>]</mo><mo>+</mo><msub><mi>b</mi><mi>y</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-942" style="width: 15.888em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.229em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.873em, 1013.13em, 2.743em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-943"><span class="msubsup" id="MathJax-Span-944"><span style="display: inline-block; position: relative; width: 2.015em; height: 0px;"><span style="position: absolute; clip: rect(3.119em, 1000.5em, 4.372em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-945"><span class="mrow" id="MathJax-Span-946"><span class="munderover" id="MathJax-Span-947"><span style="display: inline-block; position: relative; width: 0.585em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.5em, 4.372em, -1000em); top: -4.01em; left: 0.002em;"><span class="mi" id="MathJax-Span-948" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.16em, 1000.39em, 3.636em, -1000em); top: -4.052em; left: 0.085em;"><span class="mo" id="MathJax-Span-949" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.473em; left: 0.585em;"><span class="texatom" id="MathJax-Span-950"><span class="mrow" id="MathJax-Span-951"><span class="mo" id="MathJax-Span-952" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mi" id="MathJax-Span-953" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-954" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-955" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-956" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-957" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-958"><span style="display: inline-block; position: relative; width: 1.142em; height: 0px;"><span style="position: absolute; clip: rect(3.411em, 1000.69em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-959" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.716em;"><span class="mi" id="MathJax-Span-960" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-961" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-962"><span style="display: inline-block; position: relative; width: 1.96em; height: 0px;"><span style="position: absolute; clip: rect(3.085em, 1000.51em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-963"><span class="mrow" id="MathJax-Span-964"><span class="munderover" id="MathJax-Span-965"><span style="display: inline-block; position: relative; width: 0.529em; height: 0px;"><span style="position: absolute; clip: rect(3.413em, 1000.51em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-966" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.066em; left: 0.044em;"><span style="height: 0em; vertical-align: 0em; width: 0.471em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-967" style="font-family: MathJax_Main;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.26em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.507em; left: 0.529em;"><span class="texatom" id="MathJax-Span-968"><span class="mrow" id="MathJax-Span-969"><span class="mo" id="MathJax-Span-970" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mi" id="MathJax-Span-971" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-972" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-973" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-974" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 2.431em; height: 0px;"><span style="position: absolute; clip: rect(2.761em, 1000.94em, 4.177em, -1000em); top: -4.01em; left: 0em;"><span class="munderover" id="MathJax-Span-975"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(3.413em, 1000.51em, 4.177em, -1000em); top: -4.01em; left: 0.235em;"><span class="mi" id="MathJax-Span-976" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1000.94em, 4.178em, -1000em); top: -4.593em; left: 0em;"><span class="mo" id="MathJax-Span-977" style=""><span style="font-family: MathJax_Main;">←</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.831em; left: 1em;"><span class="texatom" id="MathJax-Span-978"><span class="mrow" id="MathJax-Span-979"><span class="mo" id="MathJax-Span-980" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mi" id="MathJax-Span-981" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-982" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-983" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-984" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msubsup" id="MathJax-Span-985" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.855em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.42em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-986" style="font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.429em;"><span class="mi" id="MathJax-Span-987" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-988" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.416em; border-left: 0px solid; width: 0px; height: 1.994em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mi>t</mi><mo>&gt;</mo></mrow></msup><mo>=</mo><mi>g</mi><mo stretchy="false">(</mo><msub><mi>w</mi><mi>y</mi></msub><mo stretchy="false">[</mo><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>a</mi><mo stretchy="false">→</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mi>t</mi><mo>&gt;</mo></mrow></msup><mo>,</mo><msup><mover><mi>a</mi><mo>←</mo></mover><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mi>t</mi><mo>&gt;</mo></mrow></msup><mo stretchy="false">]</mo><mo>+</mo><msub><mi>b</mi><mi>y</mi></msub><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-65">\hat y^{<t>}=g(w_y[\vec a^{<t>},\overleftarrow a^{<t>}]+b_y)</script> <br>
[其中各单元可以是标准RNN单元，也可以是GRU单元、LSTM单元，对于NLP问题来说基于LSTM单元的BRNN用的比较多。<p></p>

<p>BRNN缺点：需要完整序列的数据才能预测。对于语音识别来说，也就是必须等到讲话的人讲完，才能预测，这并不能满足我们的需求，所以语音识别通常用其他更复杂的模型，而BRNN较广泛的应用于NLP问题。</p>



<h1 id="12-deep-rnn"><a name="t26"></a>12. Deep RNN</h1>

<p>对于RNN来说一般很少像CNN那样堆叠很多层，3层对RNN来说就已经非常庞大了。如果需要堆叠多层，一般会删去水平连接。 <br>
<img src="https://img-blog.csdn.net/20180302225722621?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd2VpeGluXzQxMDQzMjQw/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述" title=""> <br>
某个RNN单元可以是标准RNN单元，也可以是GRU单元、LSTM单元甚至BRNN单元，可以自由设置。</p>                