# 转载 限制玻尔兹曼机详解

        <h1 class="csdn_top">限制玻尔兹曼机（RBMs）理论详解</h1>
        <div class="article_bar clearfix">
            


<!--          [startarticletags]-->
                                                            <li><a href="http://so.csdn.net/so/search/s.do?q=RBMs&amp;t=blog" target="_blank">RBMs</a> <span>/</span></li>
                                            <li><a href="http://so.csdn.net/so/search/s.do?q=Gibbs采样&amp;t=blog" target="_blank">Gibbs采样</a> <span>/</span></li>
                                            <li><a href="http://so.csdn.net/so/search/s.do?q=能量函数&amp;t=blog" target="_blank">能量函数</a> <span>/</span></li>
                                            <li><a href="http://so.csdn.net/so/search/s.do?q=深度学习&amp;t=blog" target="_blank">深度学习</a> <span>/</span></li>
                                            <li><a href="http://so.csdn.net/so/search/s.do?q=CD&amp;t=blog" target="_blank">CD</a> <span style="display: none;">/</span></li>
                                    <!--          [endarticletags]-->
            </ul>
            <ul class="right_bar">
                <li><button class="btn-noborder"><i class="icon iconfont icon-read"></i><span class="txt">5739</span></button></li>
                <li class="edit" style="display: none;">
                    <a class="btn-noborder" href="https://mp.csdn.net/postedit/50208841">
                        <i class="icon iconfont icon-bianji"></i><span class="txt">编辑</span>
                    </a>
                </li>
                <li class="del" style="display: none;">
                    <a class="btn-noborder" onclick="javascript:deleteArticle(fileName);return false;">
                        <i class="icon iconfont icon-shanchu"></i><span class="txt">删除</span>
                    </a>
                </li>
            </ul>
        </div>
        <div id="article_content" class="article_content csdn-tracking-statistics tracking-click" data-mod="popu_519" data-dsm="post" style="overflow: hidden;">
                            <div class="markdown_views">
                        <h2 id="一序"><a name="t0"></a><strong>一、序</strong></h2>

<blockquote>
  <p>关于RBMs的文章已经有不少了，但是很多资料我在阅读的时候仍然对细节有一些疑惑。在查阅学习了大牛的视频、论文之后，很多问题豁然开朗，且在本文中记录下我对RBMs的粗浅了解。首先从玻尔兹曼机和限制玻尔兹曼机的结构和定义开始： <br>
  </p><center><img src="https://img-blog.csdn.net/20151207175425861" alt="BM和RBM的结构" title=""></center><p></p>
</blockquote>



<h2 id="二boltmann-machines"><a name="t1"></a><strong>二、Boltmann Machines：</strong></h2>

<p>&nbsp;&nbsp;&nbsp;&nbsp;玻尔兹曼机（Boltmann Machines）的能量函数（Energy function）是： <br>
<span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"></div><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>E</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mo>&amp;#x2212;</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>W</mtext></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>&amp;#x2212;</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>c</mtext></mrow><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>&amp;#x2212;</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>b</mtext></mrow><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><mo>&amp;#x2212;</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>U</mtext></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>&amp;#x2212;</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>V</mtext></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 26.982em; display: inline-block;"><span style="display: inline-block; position: relative; width: 22.448em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.242em, 1022.43em, 2.698em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mo" id="MathJax-Span-4" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-5"><span class="mrow" id="MathJax-Span-6"><span class="mtext" id="MathJax-Span-7" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-8" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-9" style="padding-left: 0.167em;"><span class="mrow" id="MathJax-Span-10"><span class="mtext" id="MathJax-Span-11" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span class="mo" id="MathJax-Span-12" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-13" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-14" style="font-family: MathJax_Main; padding-left: 0.278em;">−</span><span class="msubsup" id="MathJax-Span-15"><span style="display: inline-block; position: relative; width: 1.264em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.62em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-16"><span class="mrow" id="MathJax-Span-17"><span class="mtext" id="MathJax-Span-18" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.431em; left: 0.639em;"><span class="mi" id="MathJax-Span-19" style="font-size: 70.7%; font-family: MathJax_Main;">⊤</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="texatom" id="MathJax-Span-20"><span class="mrow" id="MathJax-Span-21"><span class="mtext" id="MathJax-Span-22" style="font-family: MathJax_Main; font-weight: bold;">W</span></span></span><span class="texatom" id="MathJax-Span-23"><span class="mrow" id="MathJax-Span-24"><span class="mtext" id="MathJax-Span-25" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-26" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-27" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.136em; height: 0px;"><span style="position: absolute; clip: rect(3.401em, 1000.48em, 4.173em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-28"><span class="mrow" id="MathJax-Span-29"><span class="mtext" id="MathJax-Span-30" style="font-family: MathJax_Main; font-weight: bold;">c</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.423em; left: 0.511em;"><span class="mi" id="MathJax-Span-31" style="font-size: 70.7%; font-family: MathJax_Main;">⊤</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="texatom" id="MathJax-Span-32"><span class="mrow" id="MathJax-Span-33"><span class="mtext" id="MathJax-Span-34" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-35" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-36" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.264em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.6em, 4.173em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-37"><span class="mrow" id="MathJax-Span-38"><span class="mtext" id="MathJax-Span-39" style="font-family: MathJax_Main; font-weight: bold;">b</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.431em; left: 0.639em;"><span class="mi" id="MathJax-Span-40" style="font-size: 70.7%; font-family: MathJax_Main;">⊤</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="texatom" id="MathJax-Span-41"><span class="mrow" id="MathJax-Span-42"><span class="mtext" id="MathJax-Span-43" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span class="mo" id="MathJax-Span-44" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-45" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.232em; height: 0px;"><span style="position: absolute; clip: rect(3.41em, 1000.59em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-46"><span class="mrow" id="MathJax-Span-47"><span class="mtext" id="MathJax-Span-48" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.423em; left: 0.607em;"><span class="mi" id="MathJax-Span-49" style="font-size: 70.7%; font-family: MathJax_Main;">⊤</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="texatom" id="MathJax-Span-50"><span class="mrow" id="MathJax-Span-51"><span class="mtext" id="MathJax-Span-52" style="font-family: MathJax_Main; font-weight: bold;">U</span></span></span><span class="texatom" id="MathJax-Span-53"><span class="mrow" id="MathJax-Span-54"><span class="mtext" id="MathJax-Span-55" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-56" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-57" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.264em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.62em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-58"><span class="mrow" id="MathJax-Span-59"><span class="mtext" id="MathJax-Span-60" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.431em; left: 0.639em;"><span class="mi" id="MathJax-Span-61" style="font-size: 70.7%; font-family: MathJax_Main;">⊤</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="texatom" id="MathJax-Span-62"><span class="mrow" id="MathJax-Span-63"><span class="mtext" id="MathJax-Span-64" style="font-family: MathJax_Main; font-weight: bold;">V</span></span></span><span class="texatom" id="MathJax-Span-65"><span class="mrow" id="MathJax-Span-66"><span class="mtext" id="MathJax-Span-67" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.362em; border-left: 0px solid; width: 0px; height: 1.497em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>E</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><mi mathvariant="normal">⊤</mi></msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">W</mtext></mrow><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>−</mo><msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">c</mtext></mrow><mi mathvariant="normal">⊤</mi></msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>−</mo><msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">b</mtext></mrow><mi mathvariant="normal">⊤</mi></msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><mo>−</mo><msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mi mathvariant="normal">⊤</mi></msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">U</mtext></mrow><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>−</mo><msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><mi mathvariant="normal">⊤</mi></msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">V</mtext></mrow><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-1">\begin{equation}
    E(\textbf{x}, \textbf{h}) = -\textbf{h}^\top \textbf{W} \textbf{x} - \textbf{c}^\top \textbf{x} - \textbf{b}^\top \textbf{h} - \textbf{x}^\top \textbf{U} \textbf{x} - \textbf{h}^\top \textbf{V} \textbf{h}
\end{equation}</script><p></p>

<p>分布函数： <br>
<span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"></div><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x2212;</mo><mi>E</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mi>Z</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-68" style="width: 14.534em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.083em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.385em, 1012.08em, 2.698em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-69"><span class="mi" id="MathJax-Span-70" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span class="mo" id="MathJax-Span-71" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-72"><span class="mrow" id="MathJax-Span-73"><span class="mtext" id="MathJax-Span-74" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-75" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-76" style="padding-left: 0.167em;"><span class="mrow" id="MathJax-Span-77"><span class="mtext" id="MathJax-Span-78" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span class="mo" id="MathJax-Span-79" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-80" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-81" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">e</span><span class="mi" id="MathJax-Span-82" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mi" id="MathJax-Span-83" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-84" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-85" style="font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-86" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mo" id="MathJax-Span-87" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-88"><span class="mrow" id="MathJax-Span-89"><span class="mtext" id="MathJax-Span-90" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-91" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-92" style="padding-left: 0.167em;"><span class="mrow" id="MathJax-Span-93"><span class="mtext" id="MathJax-Span-94" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span class="mo" id="MathJax-Span-95" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-96" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-97"><span class="mrow" id="MathJax-Span-98"><span class="mo" id="MathJax-Span-99" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-100" style="font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.362em; border-left: 0px solid; width: 0px; height: 1.325em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>P</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><mo stretchy="false">)</mo><mo>=</mo><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="false">(</mo><mo>−</mo><mi>E</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi>Z</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-2">\begin{equation}
    P(\textbf{x}, \textbf{h}) = exp(-E(\textbf{x}, \textbf{h}))/Z
\end{equation}</script><p></p>

<p>其中分母Z学名叫做partition function <br>
<span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"></div><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>Z</mi><mo>=</mo><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow></mrow></munder><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow></mrow></munder><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x2212;</mo><mi>E</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-101" style="width: 13.961em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.615em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.185em, 1011.52em, 3.655em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-102"><span class="mi" id="MathJax-Span-103" style="font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span class="mo" id="MathJax-Span-104" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="munderover" id="MathJax-Span-105" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.444em; height: 0px;"><span style="position: absolute; clip: rect(2.904em, 1001.39em, 4.617em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-106" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.54em, 1000.41em, 4.267em, -1000em); top: -2.96em; left: 0.507em;"><span class="texatom" id="MathJax-Span-107"><span class="mrow" id="MathJax-Span-108"><span class="texatom" id="MathJax-Span-109"><span class="mrow" id="MathJax-Span-110"><span class="mtext" id="MathJax-Span-111" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">x</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="munderover" id="MathJax-Span-112" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.444em; height: 0px;"><span style="position: absolute; clip: rect(2.904em, 1001.39em, 4.617em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-113" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.363em, 1000.44em, 4.267em, -1000em); top: -2.903em; left: 0.496em;"><span class="texatom" id="MathJax-Span-114"><span class="mrow" id="MathJax-Span-115"><span class="texatom" id="MathJax-Span-116"><span class="mrow" id="MathJax-Span-117"><span class="mtext" id="MathJax-Span-118" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">h</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mi" id="MathJax-Span-119" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">e</span><span class="mi" id="MathJax-Span-120" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mi" id="MathJax-Span-121" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-122" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-123" style="font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-124" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mo" id="MathJax-Span-125" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-126"><span class="mrow" id="MathJax-Span-127"><span class="mtext" id="MathJax-Span-128" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-129" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-130" style="padding-left: 0.167em;"><span class="mrow" id="MathJax-Span-131"><span class="mtext" id="MathJax-Span-132" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span class="mo" id="MathJax-Span-133" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-134" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.511em; border-left: 0px solid; width: 0px; height: 2.714em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>Z</mi><mo>=</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow></mrow></munder><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow></mrow></munder><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="false">(</mo><mo>−</mo><mi>E</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-3">\begin{equation}
    Z = \sum_{\textbf{x}} \sum_{\textbf{h}} exp(-E(\textbf{x}, \textbf{h}))
\end{equation}</script><p></p>



<p>分布函数： <br>
<span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"></div><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>exp</mi><mo>&amp;#x2061;</mo><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x2212;</mo><mi>E</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mi>Z</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-231" style="width: 14.534em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.083em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.385em, 1012.08em, 2.698em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-232"><span class="mi" id="MathJax-Span-233" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span class="mo" id="MathJax-Span-234" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-235"><span class="mrow" id="MathJax-Span-236"><span class="mtext" id="MathJax-Span-237" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-238" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-239" style="padding-left: 0.167em;"><span class="mrow" id="MathJax-Span-240"><span class="mtext" id="MathJax-Span-241" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span class="mo" id="MathJax-Span-242" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-243" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-244" style="font-family: MathJax_Main; padding-left: 0.278em;">exp</span><span class="mo" id="MathJax-Span-245"></span><span class="mo" id="MathJax-Span-246" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-247" style="font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-248" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mo" id="MathJax-Span-249" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-250"><span class="mrow" id="MathJax-Span-251"><span class="mtext" id="MathJax-Span-252" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-253" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-254" style="padding-left: 0.167em;"><span class="mrow" id="MathJax-Span-255"><span class="mtext" id="MathJax-Span-256" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span class="mo" id="MathJax-Span-257" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-258" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-259"><span class="mrow" id="MathJax-Span-260"><span class="mo" id="MathJax-Span-261" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-262" style="font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.362em; border-left: 0px solid; width: 0px; height: 1.325em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>P</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><mo stretchy="false">)</mo><mo>=</mo><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><mo>−</mo><mi>E</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi>Z</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-5">\begin{equation}
    P(\textbf{x}, \textbf{h}) = \exp(-E(\textbf{x}, \textbf{h}))/Z
\end{equation}</script> <br>
能量函数的能量越小，分布函数相应的概率就越大。<p></p>

<p>&nbsp;  &nbsp;  &nbsp;&nbsp;玻尔兹曼机和限制玻尔兹曼机都属于基于能量的模型（Energy-Based Models），从模型图和公式中很容易看出两者的区别：玻尔兹曼机隐含层（和可见层）处于同一层的任意两个节点之间有一条连线；而限制玻尔兹曼机同层变量之间是相互独立的。只要有足够的隐单元，限制玻尔兹曼机可以表示任意的离散分布，玻尔兹曼机的表示能力则更强一些。另一方面，限制玻尔兹曼机比玻尔兹曼机更容易训练。</p>



<h2 id="四模型学习"><a name="t3"></a><strong>四、模型学习：</strong></h2>

<p>&nbsp;&nbsp;&nbsp;&nbsp;训练RBMs就是学习能量函数的过程，变量中只有输入<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-263" style="width: 0.784em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.625em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.639em, 1000.6em, 2.396em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-264"><span class="texatom" id="MathJax-Span-265"><span class="mrow" id="MathJax-Span-266"><span class="mtext" id="MathJax-Span-267" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.658em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow></math></span></span><script type="math/tex" id="MathJax-Element-6">\textbf{x}</script>是已知的。 <br>
</p><center><img src="https://img-blog.csdn.net/20151207175536478" alt="RBMs" title=""></center><p></p>





<p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"></div><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-168-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>F</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>E</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>y</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mo>&amp;#x2212;</mo><mi>l</mi><mi>o</mi><mi>g</mi><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow></mrow></munder><msup><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x2212;</mo><mi>E</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo></mrow></msup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-356" style="width: 18.284em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.208em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.185em, 1015.21em, 3.655em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-357"><span class="mi" id="MathJax-Span-358" style="font-family: MathJax_Math; font-style: italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mi" id="MathJax-Span-359" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-360" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-361" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-362" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mi" id="MathJax-Span-363" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-364" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-365" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-366" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-367" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-368" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-369"><span class="mrow" id="MathJax-Span-370"><span class="mtext" id="MathJax-Span-371" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-372" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-373" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-374" style="font-family: MathJax_Main; padding-left: 0.278em;">−</span><span class="mi" id="MathJax-Span-375" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-376" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-377" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="munderover" id="MathJax-Span-378" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.444em; height: 0px;"><span style="position: absolute; clip: rect(2.904em, 1001.39em, 4.617em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-379" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.363em, 1000.44em, 4.267em, -1000em); top: -2.903em; left: 0.496em;"><span class="texatom" id="MathJax-Span-380"><span class="mrow" id="MathJax-Span-381"><span class="texatom" id="MathJax-Span-382"><span class="mrow" id="MathJax-Span-383"><span class="mtext" id="MathJax-Span-384" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">h</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-385" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 3.259em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-386" style="font-family: MathJax_Math; font-style: italic;">e</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.423em; left: 0.466em;"><span class="texatom" id="MathJax-Span-387"><span class="mrow" id="MathJax-Span-388"><span class="mo" id="MathJax-Span-389" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-390" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.018em;"></span></span><span class="mo" id="MathJax-Span-391" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-392"><span class="mrow" id="MathJax-Span-393"><span class="mtext" id="MathJax-Span-394" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-395" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-396"><span class="mrow" id="MathJax-Span-397"><span class="mtext" id="MathJax-Span-398" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span class="mo" id="MathJax-Span-399" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.511em; border-left: 0px solid; width: 0px; height: 2.714em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>F</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>E</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>y</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mi>l</mi><mi>o</mi><mi>g</mi><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow></mrow></munder><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mi>E</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><mo stretchy="false">)</mo></mrow></msup></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-168">\begin{equation}
    FreeEnergy(\textbf{x}) = -log \sum_{\textbf{h}} e^{-E(\textbf{x}, \textbf{h})}
\end{equation}</script><p></p>

<p>例如：如果<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-169-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>h</mi><mi>i</mi></msub><mo>&amp;#x2208;</mo><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>}</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-400" style="width: 5.523em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.583em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.333em, 1004.52em, 2.646em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-401"><span class="msubsup" id="MathJax-Span-402"><span style="display: inline-block; position: relative; width: 0.895em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.56em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-403" style="font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.576em;"><span class="mi" id="MathJax-Span-404" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-405" style="font-family: MathJax_Main; padding-left: 0.278em;">∈</span><span class="mo" id="MathJax-Span-406" style="font-family: MathJax_Main; padding-left: 0.278em;">{</span><span class="mn" id="MathJax-Span-407" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-408" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-409" style="font-family: MathJax_Main; padding-left: 0.167em;">1</span><span class="mo" id="MathJax-Span-410" style="font-family: MathJax_Main;">}</span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.362em; border-left: 0px solid; width: 0px; height: 1.325em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>h</mi><mi>i</mi></msub><mo>∈</mo><mo fence="false" stretchy="false">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo fence="false" stretchy="false">}</mo></math></span>
给定参数和<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-171-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-672" style="width: 0.784em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.625em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.639em, 1000.6em, 2.396em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-673"><span class="texatom" id="MathJax-Span-674"><span class="mrow" id="MathJax-Span-675"><span class="mtext" id="MathJax-Span-676" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.658em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow></math></span></span><script type="math/tex" id="MathJax-Element-171">\textbf{x}</script>就可以很容易的计算出Free Energy的值，不依赖于隐单元<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-172-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-677" style="width: 0.784em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.625em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.389em, 1000.61em, 2.396em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-678"><span class="texatom" id="MathJax-Span-679"><span class="mrow" id="MathJax-Span-680"><span class="mtext" id="MathJax-Span-681" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.958em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow></math></span></span><script type="math/tex" id="MathJax-Element-172">\textbf{h}</script>的具体取值。<p></p>

<h3 id="梯度方法进行优化"><a name="t5"></a><strong>梯度方法进行优化：</strong></h3>

<p>&nbsp;  &nbsp;  &nbsp;&nbsp;用梯度算法学习RBMs模型参数<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-105-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B8;</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-682" style="width: 0.576em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.469em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.43em, 1000.46em, 2.458em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-683"><span class="mi" id="MathJax-Span-684" style="font-family: MathJax_Math; font-style: italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.074em; border-left: 0px solid; width: 0px; height: 0.983em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-105">\theta</script>(<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-106-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B8;</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-685" style="width: 0.576em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.469em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.43em, 1000.46em, 2.458em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-686"><span class="mi" id="MathJax-Span-687" style="font-family: MathJax_Math; font-style: italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.074em; border-left: 0px solid; width: 0px; height: 0.983em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-106">\theta</script>包括<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-107-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>W</mtext></mrow><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>c</mtext></mrow><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>b</mtext></mrow></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-688" style="width: 3.909em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.229em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.389em, 1003.19em, 2.59em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-689"><span class="texatom" id="MathJax-Span-690"><span class="mrow" id="MathJax-Span-691"><span class="mtext" id="MathJax-Span-692" style="font-family: MathJax_Main; font-weight: bold;">W</span></span></span><span class="mo" id="MathJax-Span-693" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-694" style="padding-left: 0.167em;"><span class="mrow" id="MathJax-Span-695"><span class="mtext" id="MathJax-Span-696" style="font-family: MathJax_Main; font-weight: bold;">c</span></span></span><span class="mo" id="MathJax-Span-697" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-698" style="padding-left: 0.167em;"><span class="mrow" id="MathJax-Span-699"><span class="mtext" id="MathJax-Span-700" style="font-family: MathJax_Main; font-weight: bold;">b</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.295em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">W</mtext></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">c</mtext></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">b</mtext></mrow></math></span></span><script type="math/tex" id="MathJax-Element-107">\textbf{W},\textbf{c},\textbf{b}</script>)，目标函数是<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-108-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-701" style="width: 2.607em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.135em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.385em, 1002.04em, 2.698em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-702"><span class="mi" id="MathJax-Span-703" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span class="mo" id="MathJax-Span-704" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-705"><span class="mrow" id="MathJax-Span-706"><span class="mtext" id="MathJax-Span-707" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-708" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.362em; border-left: 0px solid; width: 0px; height: 1.325em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-108">P(\textbf{x})</script>（这里是梯度上升，因为要求的是似然的极大值）。<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-109-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-709" style="width: 2.607em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.135em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.385em, 1002.04em, 2.698em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-710"><span class="mi" id="MathJax-Span-711" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span class="mo" id="MathJax-Span-712" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-713"><span class="mrow" id="MathJax-Span-714"><span class="mtext" id="MathJax-Span-715" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-716" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.362em; border-left: 0px solid; width: 0px; height: 1.325em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-109">P(\textbf{x})</script>取对数求偏导： <br>
<span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"></div><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-110-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>l</mi><mi>o</mi><mi>g</mi><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mo>&amp;#x2212;</mo><mi>F</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>E</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>y</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mi>l</mi><mi>o</mi><mi>g</mi><mi>Z</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-717" style="width: 18.596em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.469em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.385em, 1015.47em, 2.698em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-718"><span class="mi" id="MathJax-Span-719" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-720" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-721" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-722" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span class="mo" id="MathJax-Span-723" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-724"><span class="mrow" id="MathJax-Span-725"><span class="mtext" id="MathJax-Span-726" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-727" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-728" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-729" style="font-family: MathJax_Main; padding-left: 0.278em;">−</span><span class="mi" id="MathJax-Span-730" style="font-family: MathJax_Math; font-style: italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mi" id="MathJax-Span-731" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-732" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-733" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-734" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mi" id="MathJax-Span-735" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-736" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-737" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-738" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-739" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-740" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-741"><span class="mrow" id="MathJax-Span-742"><span class="mtext" id="MathJax-Span-743" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-744" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-745" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-746" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">l</span><span class="mi" id="MathJax-Span-747" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-748" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-749" style="font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.362em; border-left: 0px solid; width: 0px; height: 1.325em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>l</mi><mi>o</mi><mi>g</mi><mi>P</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mi>F</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>E</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>y</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo stretchy="false">)</mo><mo>−</mo><mi>l</mi><mi>o</mi><mi>g</mi><mi>Z</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-110">\begin{equation}
    log P(\textbf{x}) = -FreeEnergy(\textbf{x}) - log Z
\end{equation}</script> <br>


<p>&nbsp;  &nbsp; &nbsp; &nbsp;  很多文章里喜欢写成负对数似然梯度（negative log-likelihood gradient）的形式，<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-115-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo>&amp;#x2212;</mo><mi>l</mi><mi>o</mi><mi>g</mi><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1061" style="width: 5.003em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.167em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.385em, 1004.07em, 2.698em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-1062"><span class="mo" id="MathJax-Span-1063" style="font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-1064" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-1065" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-1066" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1067" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span class="mo" id="MathJax-Span-1068" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-1069"><span class="mrow" id="MathJax-Span-1070"><span class="mtext" id="MathJax-Span-1071" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1072" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.362em; border-left: 0px solid; width: 0px; height: 1.325em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>−</mo><mi>l</mi><mi>o</mi><mi>g</mi><mi>P</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-115">-log P(\textbf{x})</script>就应该用梯度下降方法来更新参数了： <br>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-118-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>P</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1253" style="width: 0.94em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.781em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.055em, 1000.73em, 2.344em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-1254"><span class="texatom" id="MathJax-Span-1255"><span class="mrow" id="MathJax-Span-1256"><span class="munderover" id="MathJax-Span-1257"><span style="display: inline-block; position: relative; width: 0.805em; height: 0px;"><span style="position: absolute; clip: rect(3.171em, 1000.75em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-1258" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.16em, 1000.39em, 3.636em, -1000em); top: -4.293em; left: 0.305em;"><span class="mo" id="MathJax-Span-1259" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 1.296em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><mi>P</mi><mo stretchy="false">^</mo></mover></mrow></math></span></span><script type="math/tex" id="MathJax-Element-118">\hat{P}</script>是训练集对应的分布，<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-119-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1260" style="width: 0.888em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.729em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.452em, 1000.73em, 2.448em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-1261"><span class="mi" id="MathJax-Span-1262" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.945em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi></math></span></span><script type="math/tex" id="MathJax-Element-119">P</script>是模型分布，<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-120-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>E</mi><mi>P</mi></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1263" style="width: 1.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.354em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.351em, 1001.35em, 2.494em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-1264"><span class="msubsup" id="MathJax-Span-1265"><span style="display: inline-block; position: relative; width: 1.344em; height: 0px;"><span style="position: absolute; clip: rect(3.174em, 1000.76em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-1266" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.738em;"><span class="mi" id="MathJax-Span-1267" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.242em; border-left: 0px solid; width: 0px; height: 1.121em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>E</mi><mi>P</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-120">E_P</script>表示在模型分布上求期望。（这里顺便解释一下为什么大家都喜欢负对数似然而不是直接最大化似然，其实如果你有一台可以表示任何数值的超级计算机，那么取不取对数真的没什么关系，但是现实中的计算机表示能力有限，N个训练样本似然乘积很小很小，小到计算机都无法表示了，所以最好取log，概率的和不会有这样的问题；另外，在优化理论中，优化问题的标准形式就是最小化某个目标函数，所以最好加个负号，最小化负对数似然）。<p></p>

<blockquote>
  <p>&nbsp;  &nbsp;  <font size="4" color="#0033ff" face="黑体"><strong>式子的第一项称为positive phrase，通过减小对应的FreeEnergy增大训练样本的概率；第二项是negative phrase，作用是增大对应的FreeEnergy来减小模型产生的样本的概率。</strong></font>句话不难理解，因为两项分别是往<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-121-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>F</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>E</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>y</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1268" style="width: 8.158em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.786em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.393em, 1006.69em, 2.75em, -1000em); top: -2.321em; left: 0em;"><span class="mrow" id="MathJax-Span-1269"><span class="mi" id="MathJax-Span-1270" style="font-family: MathJax_Math; font-style: italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mi" id="MathJax-Span-1271" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-1272" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-1273" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-1274" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mi" id="MathJax-Span-1275" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-1276" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-1277" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-1278" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1279" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-1280" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-1281"><span class="mrow" id="MathJax-Span-1282"><span class="mtext" id="MathJax-Span-1283" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1284" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.321em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.371em; border-left: 0px solid; width: 0px; height: 1.343em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>F</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>E</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>y</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-121">FreeEnergy(\textbf{x})</script>的梯度下降和<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-122-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>F</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>E</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>y</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo stretchy=&quot;false&quot;>&amp;#x007E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1285" style="width: 8.158em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.786em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.393em, 1006.69em, 2.75em, -1000em); top: -2.321em; left: 0em;"><span class="mrow" id="MathJax-Span-1286"><span class="mi" id="MathJax-Span-1287" style="font-family: MathJax_Math; font-style: italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mi" id="MathJax-Span-1288" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-1289" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-1290" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-1291" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mi" id="MathJax-Span-1292" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-1293" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-1294" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-1295" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1296" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-1297" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-1298"><span class="mrow" id="MathJax-Span-1299"><span class="munderover" id="MathJax-Span-1300"><span style="display: inline-block; position: relative; width: 0.607em; height: 0px;"><span style="position: absolute; clip: rect(3.366em, 1000.59em, 4.167em, -1000em); top: -3.988em; left: 0em;"><span class="texatom" id="MathJax-Span-1301"><span class="mrow" id="MathJax-Span-1302"><span class="mtext" id="MathJax-Span-1303" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 3.988em;"></span></span><span style="position: absolute; clip: rect(3.492em, 1000.42em, 3.952em, -1000em); top: -4.366em; left: 0.053em;"><span class="mo" id="MathJax-Span-1304" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.988em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-1305" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.321em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.371em; border-left: 0px solid; width: 0px; height: 1.343em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>F</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>E</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>y</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mover><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo stretchy="false">~</mo></mover></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-122">FreeEnergy(\tilde{\textbf{x}})</script>的梯度上升方向改变。这也符合最大似然标准，在训练样本上有较大的似然而在其他样本上概率较小。从分类的角度来看，训练样本是正样本，而模型样本是<font size="4" color="#ff0000" face="黑体"><strong>负样本(Negative samples)</strong></font>。 <br>
  </p><center><img src="https://img-blog.csdn.net/20151207175806917" alt="负样本" title=""></center><p></p>
</blockquote>

<p>&nbsp; &nbsp; &nbsp; &nbsp; 最后，简要概括一下RBMs模型学习方法的步骤：（1）、求偏导，（2）、采样，（3）、估计负对数似然梯度，（4）、梯度下降方法更新参数。</p>

<h2 id="五gibbs采样"><a name="t6"></a><strong>五、Gibbs采样：</strong></h2>

<p>&nbsp;  &nbsp; &nbsp;&nbsp;对RBMs模型来说， Gibbs主要有两个作用：一是估计negative log-likelihood gradient；二是在训练完模型之后（如DBN，DBN是由多个RBMs叠加而成的），用Gibbs进行采样，可以看到模型对数据的拟合以及网络中间隐含层的抽象效果。</p>

<p>&nbsp;  &nbsp; &nbsp;&nbsp; 在RBMs模型训练过程中，Gibbs就是用来对negative log-likelihood gradient进行估计的。Gibbs采样分两个小步对<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1478" style="width: 2.971em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.448em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.333em, 1002.35em, 2.646em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-1479"><span class="mo" id="MathJax-Span-1480" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-1481"><span class="mrow" id="MathJax-Span-1482"><span class="mtext" id="MathJax-Span-1483" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1484" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-1485" style="padding-left: 0.167em;"><span class="mrow" id="MathJax-Span-1486"><span class="mtext" id="MathJax-Span-1487" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span class="mo" id="MathJax-Span-1488" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.362em; border-left: 0px solid; width: 0px; height: 1.325em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-31">(\textbf{x}, \textbf{h})</script>进行采样，第一步固定<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1489" style="width: 0.784em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.625em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.639em, 1000.6em, 2.396em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-1490"><span class="texatom" id="MathJax-Span-1491"><span class="mrow" id="MathJax-Span-1492"><span class="mtext" id="MathJax-Span-1493" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.658em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow></math></span></span><script type="math/tex" id="MathJax-Element-32">\textbf{x}</script>对<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-33-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1494" style="width: 0.784em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.625em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.389em, 1000.61em, 2.396em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-1495"><span class="texatom" id="MathJax-Span-1496"><span class="mrow" id="MathJax-Span-1497"><span class="mtext" id="MathJax-Span-1498" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.958em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow></math></span></span><script type="math/tex" id="MathJax-Element-33">\textbf{h}</script>进行采样，第二步固定<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-34-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1499" style="width: 0.784em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.625em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.389em, 1000.61em, 2.396em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-1500"><span class="texatom" id="MathJax-Span-1501"><span class="mrow" id="MathJax-Span-1502"><span class="mtext" id="MathJax-Span-1503" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.958em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow></math></span></span><script type="math/tex" id="MathJax-Element-34">\textbf{h}</script>对<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-35-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1504" style="width: 0.784em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.625em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.639em, 1000.6em, 2.396em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-1505"><span class="texatom" id="MathJax-Span-1506"><span class="mrow" id="MathJax-Span-1507"><span class="mtext" id="MathJax-Span-1508" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.658em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow></math></span></span><script type="math/tex" id="MathJax-Element-35">\textbf{x}</script>进行采样，<strong>交替进行直到收敛</strong>： <br>

&nbsp;  &nbsp;  因为在训练过程中，训练模型分布会逐渐逼近训练样本分布，所以第一步可以从训练样本的分布<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-37-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>P</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1646" style="width: 0.94em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.781em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.055em, 1000.73em, 2.344em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-1647"><span class="texatom" id="MathJax-Span-1648"><span class="mrow" id="MathJax-Span-1649"><span class="munderover" id="MathJax-Span-1650"><span style="display: inline-block; position: relative; width: 0.805em; height: 0px;"><span style="position: absolute; clip: rect(3.171em, 1000.75em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-1651" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.16em, 1000.39em, 3.636em, -1000em); top: -4.293em; left: 0.305em;"><span class="mo" id="MathJax-Span-1652" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 1.296em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><mi>P</mi><mo stretchy="false">^</mo></mover></mrow></math></span></span><script type="math/tex" id="MathJax-Element-37">\hat{P}</script>抽取样本作为<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-38-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mn>1</mn></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1653" style="width: 1.253em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.042em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.587em, 1001.04em, 2.494em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-1654"><span class="msubsup" id="MathJax-Span-1655"><span style="display: inline-block; position: relative; width: 1.036em; height: 0px;"><span style="position: absolute; clip: rect(3.41em, 1000.59em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-1656"><span class="mrow" id="MathJax-Span-1657"><span class="mtext" id="MathJax-Span-1658" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.607em;"><span class="mn" id="MathJax-Span-1659" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.242em; border-left: 0px solid; width: 0px; height: 0.838em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-38">\textbf{x}_1</script>。如果第一步直接从模型<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-39-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1660" style="width: 0.888em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.729em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.452em, 1000.73em, 2.448em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-1661"><span class="mi" id="MathJax-Span-1662" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.945em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi></math></span></span><script type="math/tex" id="MathJax-Element-39">P</script> 中采样，Gibbs采样会迅速收敛。<p></p>


<p>如果<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-49-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>h</mi><mi>j</mi></msub><mo>&amp;#x2208;</mo><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>}</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2425" style="width: 5.523em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.583em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.333em, 1004.52em, 2.69em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-2426"><span class="msubsup" id="MathJax-Span-2427"><span style="display: inline-block; position: relative; width: 0.942em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.56em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2428" style="font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.576em;"><span class="mi" id="MathJax-Span-2429" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-2430" style="font-family: MathJax_Main; padding-left: 0.278em;">∈</span><span class="mo" id="MathJax-Span-2431" style="font-family: MathJax_Main; padding-left: 0.278em;">{</span><span class="mn" id="MathJax-Span-2432" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-2433" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-2434" style="font-family: MathJax_Main; padding-left: 0.167em;">1</span><span class="mo" id="MathJax-Span-2435" style="font-family: MathJax_Main;">}</span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.416em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>h</mi><mi>j</mi></msub><mo>∈</mo><mo fence="false" stretchy="false">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo fence="false" stretchy="false">}</mo></math></span></span><script type="math/tex" id="MathJax-Element-49">h_j \in \{0,1\}</script>，可以得到： <br>
<span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"></div><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-50-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>h</mi><mi>j</mi></msub><mo>=</mo><mn>1</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mfrac><mrow><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>W</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi><mo>&amp;#x22C5;</mo></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>+</mo><msub><mi>b</mi><mi>j</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><mn>1</mn><mo>+</mo><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>W</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi><mo>&amp;#x22C5;</mo></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>+</mo><msub><mi>b</mi><mi>j</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac><mo>=</mo><mi>s</mi><mi>i</mi><mi>g</mi><mi>m</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>W</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi><mo>&amp;#x22C5;</mo></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>+</mo><msub><mi>b</mi><mi>j</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2436" style="width: 27.919em; display: inline-block;"><span style="display: inline-block; position: relative; width: 23.229em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.621em, 1023.13em, 3.462em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-2437"><span class="mi" id="MathJax-Span-2438" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-2439" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2440"><span style="display: inline-block; position: relative; width: 0.942em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.56em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2441" style="font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.576em;"><span class="mi" id="MathJax-Span-2442" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-2443" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-2444" style="font-family: MathJax_Main; padding-left: 0.278em;">1</span><span class="texatom" id="MathJax-Span-2445"><span class="mrow" id="MathJax-Span-2446"><span class="mo" id="MathJax-Span-2447" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-2448"><span class="mrow" id="MathJax-Span-2449"><span class="mtext" id="MathJax-Span-2450" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-2451" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2452" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mfrac" id="MathJax-Span-2453" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 8.292em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.104em, 1006.36em, 4.461em, -1000em); top: -4.775em; left: 50%; margin-left: -3.225em;"><span class="mrow" id="MathJax-Span-2454"><span class="mi" id="MathJax-Span-2455" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-2456" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mi" id="MathJax-Span-2457" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-2458" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2459"><span style="display: inline-block; position: relative; width: 1.507em; height: 0px;"><span style="position: absolute; clip: rect(3.171em, 1001.05em, 4.189em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2460" style="font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.944em;"><span class="texatom" id="MathJax-Span-2461"><span class="mrow" id="MathJax-Span-2462"><span class="mi" id="MathJax-Span-2463" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span class="mo" id="MathJax-Span-2464" style="font-size: 70.7%; font-family: MathJax_Main;">⋅</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2465"><span class="mrow" id="MathJax-Span-2466"><span class="mtext" id="MathJax-Span-2467" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-2468" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msubsup" id="MathJax-Span-2469" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.795em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.42em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2470" style="font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.429em;"><span class="mi" id="MathJax-Span-2471" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-2472" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.104em, 1008.08em, 4.461em, -1000em); top: -3.29em; left: 50%; margin-left: -4.086em;"><span class="mrow" id="MathJax-Span-2473"><span class="mn" id="MathJax-Span-2474" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-2475" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-2476" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">e</span><span class="mi" id="MathJax-Span-2477" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mi" id="MathJax-Span-2478" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-2479" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2480"><span style="display: inline-block; position: relative; width: 1.507em; height: 0px;"><span style="position: absolute; clip: rect(3.171em, 1001.05em, 4.189em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2481" style="font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.944em;"><span class="texatom" id="MathJax-Span-2482"><span class="mrow" id="MathJax-Span-2483"><span class="mi" id="MathJax-Span-2484" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span class="mo" id="MathJax-Span-2485" style="font-size: 70.7%; font-family: MathJax_Main;">⋅</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2486"><span class="mrow" id="MathJax-Span-2487"><span class="mtext" id="MathJax-Span-2488" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-2489" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msubsup" id="MathJax-Span-2490" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.795em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.42em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2491" style="font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.429em;"><span class="mi" id="MathJax-Span-2492" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-2493" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1008.29em, 1.198em, -1000em); top: -1.262em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 8.292em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span><span class="mo" id="MathJax-Span-2494" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-2495" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">s</span><span class="mi" id="MathJax-Span-2496" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-2497" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-2498" style="font-family: MathJax_Math; font-style: italic;">m</span><span class="mo" id="MathJax-Span-2499" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2500"><span style="display: inline-block; position: relative; width: 1.507em; height: 0px;"><span style="position: absolute; clip: rect(3.171em, 1001.05em, 4.189em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2501" style="font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.944em;"><span class="texatom" id="MathJax-Span-2502"><span class="mrow" id="MathJax-Span-2503"><span class="mi" id="MathJax-Span-2504" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span class="mo" id="MathJax-Span-2505" style="font-size: 70.7%; font-family: MathJax_Main;">⋅</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2506"><span class="mrow" id="MathJax-Span-2507"><span class="mtext" id="MathJax-Span-2508" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-2509" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msubsup" id="MathJax-Span-2510" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.795em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.42em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2511" style="font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.429em;"><span class="mi" id="MathJax-Span-2512" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-2513" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.28em; border-left: 0px solid; width: 0px; height: 3.16em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>p</mi><mo stretchy="false">(</mo><msub><mi>h</mi><mi>j</mi></msub><mo>=</mo><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="false">(</mo><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>⋅</mo></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>+</mo><msub><mi>b</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow><mrow><mn>1</mn><mo>+</mo><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="false">(</mo><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>⋅</mo></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>+</mo><msub><mi>b</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow></mfrac><mo>=</mo><mi>s</mi><mi>i</mi><mi>g</mi><mi>m</mi><mo stretchy="false">(</mo><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>⋅</mo></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>+</mo><msub><mi>b</mi><mi>j</mi></msub><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-50">\begin{equation}
    p(h_j = 1|\textbf{x}) = \frac{ exp( W_{j\cdot} \textbf{x} + b_j )}{ 1 + exp( W_{j\cdot} \textbf{x} + b_j)} = sigm(W_{j\cdot} \textbf{x} + b_j)
\end{equation}</script><p></p>




<p>如果<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-53-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>x</mi><mi>j</mi></msub><mo>&amp;#x2208;</mo><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>}</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2656" style="width: 5.523em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.583em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.333em, 1004.52em, 2.69em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-2657"><span class="msubsup" id="MathJax-Span-2658"><span style="display: inline-block; position: relative; width: 0.938em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.52em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2659" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.572em;"><span class="mi" id="MathJax-Span-2660" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-2661" style="font-family: MathJax_Main; padding-left: 0.278em;">∈</span><span class="mo" id="MathJax-Span-2662" style="font-family: MathJax_Main; padding-left: 0.278em;">{</span><span class="mn" id="MathJax-Span-2663" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-2664" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-2665" style="font-family: MathJax_Main; padding-left: 0.167em;">1</span><span class="mo" id="MathJax-Span-2666" style="font-family: MathJax_Main;">}</span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.416em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>x</mi><mi>j</mi></msub><mo>∈</mo><mo fence="false" stretchy="false">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo fence="false" stretchy="false">}</mo></math></span></span><script type="math/tex" id="MathJax-Element-53">x_j \in \{0,1\}</script>，可以得到： <br>
<span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"></div><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-54-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mi>j</mi></msub><mo>=</mo><mn>1</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mfrac><mrow><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><msub><mi>W</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x22C5;</mo><mi>j</mi></mrow></msub><mo>+</mo><msub><mi>c</mi><mi>j</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><mn>1</mn><mo>+</mo><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><msub><mi>W</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x22C5;</mo><mi>j</mi></mrow></msub><mo>+</mo><msub><mi>c</mi><mi>j</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac><mo>=</mo><mi>s</mi><mi>i</mi><mi>g</mi><mi>m</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><msub><mi>W</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x22C5;</mo><mi>j</mi></mrow></msub><mo>+</mo><msub><mi>c</mi><mi>j</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2667" style="width: 28.44em; display: inline-block;"><span style="display: inline-block; position: relative; width: 23.698em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.621em, 1023.6em, 3.462em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-2668"><span class="mi" id="MathJax-Span-2669" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-2670" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2671"><span style="display: inline-block; position: relative; width: 0.938em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.52em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2672" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.572em;"><span class="mi" id="MathJax-Span-2673" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-2674" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-2675" style="font-family: MathJax_Main; padding-left: 0.278em;">1</span><span class="texatom" id="MathJax-Span-2676"><span class="mrow" id="MathJax-Span-2677"><span class="mo" id="MathJax-Span-2678" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-2679"><span class="mrow" id="MathJax-Span-2680"><span class="mtext" id="MathJax-Span-2681" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span class="mo" id="MathJax-Span-2682" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2683" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mfrac" id="MathJax-Span-2684" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 8.717em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.104em, 1006.39em, 4.461em, -1000em); top: -4.775em; left: 50%; margin-left: -3.243em;"><span class="mrow" id="MathJax-Span-2685"><span class="mi" id="MathJax-Span-2686" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-2687" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mi" id="MathJax-Span-2688" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-2689" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-2690"><span class="mrow" id="MathJax-Span-2691"><span class="mtext" id="MathJax-Span-2692" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span class="msubsup" id="MathJax-Span-2693"><span style="display: inline-block; position: relative; width: 1.507em; height: 0px;"><span style="position: absolute; clip: rect(3.171em, 1001.05em, 4.189em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2694" style="font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.944em;"><span class="texatom" id="MathJax-Span-2695"><span class="mrow" id="MathJax-Span-2696"><span class="mo" id="MathJax-Span-2697" style="font-size: 70.7%; font-family: MathJax_Main;">⋅</span><span class="mi" id="MathJax-Span-2698" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-2699" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msubsup" id="MathJax-Span-2700" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.799em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2701" style="font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.433em;"><span class="mi" id="MathJax-Span-2702" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-2703" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.104em, 1008.5em, 4.461em, -1000em); top: -3.29em; left: 50%; margin-left: -4.299em;"><span class="mrow" id="MathJax-Span-2704"><span class="mn" id="MathJax-Span-2705" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-2706" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-2707" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">e</span><span class="mi" id="MathJax-Span-2708" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mi" id="MathJax-Span-2709" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-2710" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-2711"><span class="mrow" id="MathJax-Span-2712"><span class="mtext" id="MathJax-Span-2713" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span class="msubsup" id="MathJax-Span-2714"><span style="display: inline-block; position: relative; width: 1.507em; height: 0px;"><span style="position: absolute; clip: rect(3.171em, 1001.05em, 4.189em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2715" style="font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.944em;"><span class="texatom" id="MathJax-Span-2716"><span class="mrow" id="MathJax-Span-2717"><span class="mo" id="MathJax-Span-2718" style="font-size: 70.7%; font-family: MathJax_Main;">⋅</span><span class="mi" id="MathJax-Span-2719" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-2720" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msubsup" id="MathJax-Span-2721" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.799em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2722" style="font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.433em;"><span class="mi" id="MathJax-Span-2723" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-2724" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2725" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1008.72em, 1.198em, -1000em); top: -1.262em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 8.717em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span><span class="mo" id="MathJax-Span-2726" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-2727" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">s</span><span class="mi" id="MathJax-Span-2728" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-2729" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-2730" style="font-family: MathJax_Math; font-style: italic;">m</span><span class="mo" id="MathJax-Span-2731" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-2732"><span class="mrow" id="MathJax-Span-2733"><span class="mtext" id="MathJax-Span-2734" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span class="msubsup" id="MathJax-Span-2735"><span style="display: inline-block; position: relative; width: 1.507em; height: 0px;"><span style="position: absolute; clip: rect(3.171em, 1001.05em, 4.189em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2736" style="font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.944em;"><span class="texatom" id="MathJax-Span-2737"><span class="mrow" id="MathJax-Span-2738"><span class="mo" id="MathJax-Span-2739" style="font-size: 70.7%; font-family: MathJax_Main;">⋅</span><span class="mi" id="MathJax-Span-2740" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-2741" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msubsup" id="MathJax-Span-2742" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.799em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2743" style="font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.433em;"><span class="mi" id="MathJax-Span-2744" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-2745" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.28em; border-left: 0px solid; width: 0px; height: 3.16em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>p</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>j</mi></msub><mo>=</mo><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo>⋅</mo><mi>j</mi></mrow></msub><mo>+</mo><msub><mi>c</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow><mrow><mn>1</mn><mo>+</mo><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo>⋅</mo><mi>j</mi></mrow></msub><mo>+</mo><msub><mi>c</mi><mi>j</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mfrac><mo>=</mo><mi>s</mi><mi>i</mi><mi>g</mi><mi>m</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo>⋅</mo><mi>j</mi></mrow></msub><mo>+</mo><msub><mi>c</mi><mi>j</mi></msub><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-54">\begin{equation}
        p(x_j = 1| \textbf{h}) = \frac{ exp(\textbf{h} W_{\cdot j} + c_j )}{ 1 + exp(\textbf{h} W_{\cdot j} + c_j))} = sigm(\textbf{h} W_{\cdot j} + c_j)
\end{equation}</script><p></p>



<h2 id="六contrastive-divergence"><a name="t8"></a><strong>六、Contrastive Divergence:</strong></h2>

<p>&nbsp;  &nbsp;  Contrastive Divergence可以加快RBMs的训练速度，<font size="4" color="#0022ff" face="黑体">随机选择一个<strong>训练样本</strong>初始化<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-55-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mn>1</mn></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2746" style="width: 1.103em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.048em; height: 0px; font-size: 106%;"><span style="position: absolute; clip: rect(1.6em, 1001.05em, 2.508em, -1000em); top: -2.201em; left: 0em;"><span class="mrow" id="MathJax-Span-2747"><span class="msubsup" id="MathJax-Span-2748"><span style="display: inline-block; position: relative; width: 1.036em; height: 0px;"><span style="position: absolute; clip: rect(3.382em, 1000.59em, 4.14em, -1000em); top: -3.983em; left: 0em;"><span class="texatom" id="MathJax-Span-2749"><span class="mrow" id="MathJax-Span-2750"><span class="mtext" id="MathJax-Span-2751" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 3.983em;"></span></span><span style="position: absolute; top: -3.833em; left: 0.607em;"><span class="mn" id="MathJax-Span-2752" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.983em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.201em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.215em; border-left: 0px solid; width: 0px; height: 0.741em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-55">\textbf{x}_1</script>，并且每一次迭代只用<strong>一个模型样本</strong>来估计negative log-likelihood gradient</font>，而不是等到MCMC采样收敛后求期望。</p>

<p>&nbsp;  &nbsp;  k-step Contrastive Divergence（CD-k）：MCMC采样k步<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-56-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mn>1</mn></msub><mo>,</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mn>2</mn></msub><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2753" style="width: 8.023em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.667em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.639em, 1006.67em, 2.604em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-2754"><span class="msubsup" id="MathJax-Span-2755"><span style="display: inline-block; position: relative; width: 1.036em; height: 0px;"><span style="position: absolute; clip: rect(3.41em, 1000.59em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-2756"><span class="mrow" id="MathJax-Span-2757"><span class="mtext" id="MathJax-Span-2758" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.607em;"><span class="mn" id="MathJax-Span-2759" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-2760" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2761" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.036em; height: 0px;"><span style="position: absolute; clip: rect(3.41em, 1000.59em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-2762"><span class="mrow" id="MathJax-Span-2763"><span class="mtext" id="MathJax-Span-2764" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.607em;"><span class="mn" id="MathJax-Span-2765" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-2766" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-2767" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-2768" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-2769" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-2770" style="font-family: MathJax_Main; padding-left: 0.167em;">,</span><span class="msubsup" id="MathJax-Span-2771" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.954em; height: 0px;"><span style="position: absolute; clip: rect(3.41em, 1000.59em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-2772"><span class="mrow" id="MathJax-Span-2773"><span class="mtext" id="MathJax-Span-2774" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.607em;"><span class="texatom" id="MathJax-Span-2775"><span class="mrow" id="MathJax-Span-2776"><span class="mi" id="MathJax-Span-2777" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span class="mo" id="MathJax-Span-2778" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2779" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.312em; border-left: 0px solid; width: 0px; height: 0.907em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mn>1</mn></msub><mo>,</mo><msub><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mn>2</mn></msub><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><msub><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-56">\textbf{x}_1,\textbf{x}_2,...,\textbf{x}_{k+1}</script>， 用 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-57-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2780" style="width: 2.398em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.979em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.587em, 1001.98em, 2.552em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-2781"><span class="msubsup" id="MathJax-Span-2782"><span style="display: inline-block; position: relative; width: 1.954em; height: 0px;"><span style="position: absolute; clip: rect(3.41em, 1000.59em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-2783"><span class="mrow" id="MathJax-Span-2784"><span class="mtext" id="MathJax-Span-2785" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.607em;"><span class="texatom" id="MathJax-Span-2786"><span class="mrow" id="MathJax-Span-2787"><span class="mi" id="MathJax-Span-2788" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span class="mo" id="MathJax-Span-2789" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2790" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.312em; border-left: 0px solid; width: 0px; height: 0.907em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-57">\textbf{x}_{k+1}</script> 估计negative log-likelihood gradient。当k=1时，就能得到比较好的近似（DBN等pre-training k取1就够用了），k增大可以得到更好的效果。Contrastive Divergence的一种理解是在训练样本<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-58-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mn>1</mn></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2791" style="width: 1.253em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.042em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.587em, 1001.04em, 2.494em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-2792"><span class="msubsup" id="MathJax-Span-2793"><span style="display: inline-block; position: relative; width: 1.036em; height: 0px;"><span style="position: absolute; clip: rect(3.41em, 1000.59em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-2794"><span class="mrow" id="MathJax-Span-2795"><span class="mtext" id="MathJax-Span-2796" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.607em;"><span class="mn" id="MathJax-Span-2797" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.242em; border-left: 0px solid; width: 0px; height: 0.838em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-58">\textbf{x}_1</script> 附近的局部区域内估计negative log-likelihood gradient。</p>

<p>借用一下大神Bengio的文章”Learning Deep Architectures for AI”的算法描述： <br>
</p><center><img src="https://img-blog.csdn.net/20151207175956728" alt="这里写图片描述" title=""></center><p></p>



<h3 id="persistent-cd"><a name="t9"></a><strong>Persistent CD:</strong></h3>

<p>&nbsp;  &nbsp;  CD只在附近的局部区域取Negative Sample来估计negative log-likelihood gradient，很难取到其它极值区域的样本，Persistent CD可以在一定程度上解决这个问题。Persistent CD的思想很简单，它与CD的区别仅仅在与：<font size="4" color="#0022ff" face="黑体">用上一次迭代得到的 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-59-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2798" style="width: 2.047em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.939em; height: 0px; font-size: 106%;"><span style="position: absolute; clip: rect(1.6em, 1001.94em, 2.566em, -1000em); top: -2.201em; left: 0em;"><span class="mrow" id="MathJax-Span-2799"><span class="msubsup" id="MathJax-Span-2800"><span style="display: inline-block; position: relative; width: 1.954em; height: 0px;"><span style="position: absolute; clip: rect(3.382em, 1000.59em, 4.14em, -1000em); top: -3.983em; left: 0em;"><span class="texatom" id="MathJax-Span-2801"><span class="mrow" id="MathJax-Span-2802"><span class="mtext" id="MathJax-Span-2803" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 3.983em;"></span></span><span style="position: absolute; top: -3.833em; left: 0.607em;"><span class="texatom" id="MathJax-Span-2804"><span class="mrow" id="MathJax-Span-2805"><span class="mi" id="MathJax-Span-2806" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span class="mo" id="MathJax-Span-2807" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2808" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.983em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.201em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.276em; border-left: 0px solid; width: 0px; height: 0.802em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-59">\textbf{x}_{k+1}</script>（即Negative Sample）作为这次迭代的初始值来初始化<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-60-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mn>1</mn></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2809" style="width: 1.103em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.048em; height: 0px; font-size: 106%;"><span style="position: absolute; clip: rect(1.6em, 1001.05em, 2.508em, -1000em); top: -2.201em; left: 0em;"><span class="mrow" id="MathJax-Span-2810"><span class="msubsup" id="MathJax-Span-2811"><span style="display: inline-block; position: relative; width: 1.036em; height: 0px;"><span style="position: absolute; clip: rect(3.382em, 1000.59em, 4.14em, -1000em); top: -3.983em; left: 0em;"><span class="texatom" id="MathJax-Span-2812"><span class="mrow" id="MathJax-Span-2813"><span class="mtext" id="MathJax-Span-2814" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 3.983em;"></span></span><span style="position: absolute; top: -3.833em; left: 0.607em;"><span class="mn" id="MathJax-Span-2815" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.983em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.201em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.215em; border-left: 0px solid; width: 0px; height: 0.741em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-60">\textbf{x}_1</script>。</font>PS：Persistent CD是2008年Tijmen发表在ICML上的文章。</p>



<h2 id="七参考资料"><a name="t10"></a><strong>七、参考资料：</strong></h2>

<p>[1].Youtube上Hugo Larochelle的视频讲解：<a href="https://www.youtube.com/user/hugolarochelle/videos" target="_blank">https://www.youtube.com/user/hugolarochelle/videos</a></p>

<p>[2].DeepLearning tutorial：<a href="http://deeplearning.net/tutorial/rbm.html" target="_blank">http://deeplearning.net/tutorial/rbm.html</a></p>

<p>[3].LSIA：<a href="http://www.iro.umontreal.ca/~lisa/twiki/bin/view.cgi/Public/DBNEquations" target="_blank">http://www.iro.umontreal.ca/~lisa/twiki/bin/view.cgi/Public/DBNEquations</a></p>

<p>[4].Yoshua Bengio：Learning Deep Architectures for AI</p>                </div>
                                              