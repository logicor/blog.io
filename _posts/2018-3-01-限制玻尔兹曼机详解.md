# 转载 限制玻尔兹曼机详解

        <h1 class="csdn_top">限制玻尔兹曼机（RBMs）理论详解</h1>
        <div class="article_bar clearfix">
            


<!--          [startarticletags]-->
                                                            <li><a href="http://so.csdn.net/so/search/s.do?q=RBMs&amp;t=blog" target="_blank">RBMs</a> <span>/</span></li>
                                            <li><a href="http://so.csdn.net/so/search/s.do?q=Gibbs采样&amp;t=blog" target="_blank">Gibbs采样</a> <span>/</span></li>
                                            <li><a href="http://so.csdn.net/so/search/s.do?q=能量函数&amp;t=blog" target="_blank">能量函数</a> <span>/</span></li>
                                            <li><a href="http://so.csdn.net/so/search/s.do?q=深度学习&amp;t=blog" target="_blank">深度学习</a> <span>/</span></li>
                                            <li><a href="http://so.csdn.net/so/search/s.do?q=CD&amp;t=blog" target="_blank">CD</a> <span style="display: none;">/</span></li>
                                    <!--          [endarticletags]-->
            </ul>
            <ul class="right_bar">
                <li><button class="btn-noborder"><i class="icon iconfont icon-read"></i><span class="txt">5739</span></button></li>
                <li class="edit" style="display: none;">
                    <a class="btn-noborder" href="https://mp.csdn.net/postedit/50208841">
                        <i class="icon iconfont icon-bianji"></i><span class="txt">编辑</span>
                    </a>
                </li>
                <li class="del" style="display: none;">
                    <a class="btn-noborder" onclick="javascript:deleteArticle(fileName);return false;">
                        <i class="icon iconfont icon-shanchu"></i><span class="txt">删除</span>
                    </a>
                </li>
            </ul>
        </div>
        <div id="article_content" class="article_content csdn-tracking-statistics tracking-click" data-mod="popu_519" data-dsm="post" style="overflow: hidden;">
                            <div class="markdown_views">
                        <h2 id="一序"><a name="t0"></a><strong>一、序</strong></h2>

<blockquote>
  <p>关于RBMs的文章已经有不少了，但是很多资料我在阅读的时候仍然对细节有一些疑惑。在查阅学习了大牛的视频、论文之后，很多问题豁然开朗，且在本文中记录下我对RBMs的粗浅了解。首先从玻尔兹曼机和限制玻尔兹曼机的结构和定义开始： <br>
  </p><center><img src="https://img-blog.csdn.net/20151207175425861" alt="BM和RBM的结构" title=""></center><p></p>
</blockquote>



<h2 id="二boltmann-machines"><a name="t1"></a><strong>二、Boltmann Machines：</strong></h2>

<p>&nbsp;&nbsp;&nbsp;&nbsp;玻尔兹曼机（Boltmann Machines）的能量函数（Energy function）是： <br>
<span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"></div><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>E</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mo>&amp;#x2212;</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>W</mtext></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>&amp;#x2212;</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>c</mtext></mrow><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>&amp;#x2212;</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>b</mtext></mrow><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><mo>&amp;#x2212;</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>U</mtext></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>&amp;#x2212;</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>V</mtext></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 26.982em; display: inline-block;"><span style="display: inline-block; position: relative; width: 22.448em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.242em, 1022.43em, 2.698em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mo" id="MathJax-Span-4" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-5"><span class="mrow" id="MathJax-Span-6"><span class="mtext" id="MathJax-Span-7" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-8" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-9" style="padding-left: 0.167em;"><span class="mrow" id="MathJax-Span-10"><span class="mtext" id="MathJax-Span-11" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span class="mo" id="MathJax-Span-12" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-13" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-14" style="font-family: MathJax_Main; padding-left: 0.278em;">−</span><span class="msubsup" id="MathJax-Span-15"><span style="display: inline-block; position: relative; width: 1.264em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.62em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-16"><span class="mrow" id="MathJax-Span-17"><span class="mtext" id="MathJax-Span-18" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.431em; left: 0.639em;"><span class="mi" id="MathJax-Span-19" style="font-size: 70.7%; font-family: MathJax_Main;">⊤</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="texatom" id="MathJax-Span-20"><span class="mrow" id="MathJax-Span-21"><span class="mtext" id="MathJax-Span-22" style="font-family: MathJax_Main; font-weight: bold;">W</span></span></span><span class="texatom" id="MathJax-Span-23"><span class="mrow" id="MathJax-Span-24"><span class="mtext" id="MathJax-Span-25" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-26" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-27" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.136em; height: 0px;"><span style="position: absolute; clip: rect(3.401em, 1000.48em, 4.173em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-28"><span class="mrow" id="MathJax-Span-29"><span class="mtext" id="MathJax-Span-30" style="font-family: MathJax_Main; font-weight: bold;">c</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.423em; left: 0.511em;"><span class="mi" id="MathJax-Span-31" style="font-size: 70.7%; font-family: MathJax_Main;">⊤</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="texatom" id="MathJax-Span-32"><span class="mrow" id="MathJax-Span-33"><span class="mtext" id="MathJax-Span-34" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-35" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-36" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.264em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.6em, 4.173em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-37"><span class="mrow" id="MathJax-Span-38"><span class="mtext" id="MathJax-Span-39" style="font-family: MathJax_Main; font-weight: bold;">b</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.431em; left: 0.639em;"><span class="mi" id="MathJax-Span-40" style="font-size: 70.7%; font-family: MathJax_Main;">⊤</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="texatom" id="MathJax-Span-41"><span class="mrow" id="MathJax-Span-42"><span class="mtext" id="MathJax-Span-43" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span class="mo" id="MathJax-Span-44" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-45" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.232em; height: 0px;"><span style="position: absolute; clip: rect(3.41em, 1000.59em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-46"><span class="mrow" id="MathJax-Span-47"><span class="mtext" id="MathJax-Span-48" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.423em; left: 0.607em;"><span class="mi" id="MathJax-Span-49" style="font-size: 70.7%; font-family: MathJax_Main;">⊤</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="texatom" id="MathJax-Span-50"><span class="mrow" id="MathJax-Span-51"><span class="mtext" id="MathJax-Span-52" style="font-family: MathJax_Main; font-weight: bold;">U</span></span></span><span class="texatom" id="MathJax-Span-53"><span class="mrow" id="MathJax-Span-54"><span class="mtext" id="MathJax-Span-55" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-56" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-57" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.264em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.62em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-58"><span class="mrow" id="MathJax-Span-59"><span class="mtext" id="MathJax-Span-60" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.431em; left: 0.639em;"><span class="mi" id="MathJax-Span-61" style="font-size: 70.7%; font-family: MathJax_Main;">⊤</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="texatom" id="MathJax-Span-62"><span class="mrow" id="MathJax-Span-63"><span class="mtext" id="MathJax-Span-64" style="font-family: MathJax_Main; font-weight: bold;">V</span></span></span><span class="texatom" id="MathJax-Span-65"><span class="mrow" id="MathJax-Span-66"><span class="mtext" id="MathJax-Span-67" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.362em; border-left: 0px solid; width: 0px; height: 1.497em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>E</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><mi mathvariant="normal">⊤</mi></msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">W</mtext></mrow><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>−</mo><msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">c</mtext></mrow><mi mathvariant="normal">⊤</mi></msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>−</mo><msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">b</mtext></mrow><mi mathvariant="normal">⊤</mi></msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><mo>−</mo><msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mi mathvariant="normal">⊤</mi></msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">U</mtext></mrow><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>−</mo><msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><mi mathvariant="normal">⊤</mi></msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">V</mtext></mrow><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-1">\begin{equation}
    E(\textbf{x}, \textbf{h}) = -\textbf{h}^\top \textbf{W} \textbf{x} - \textbf{c}^\top \textbf{x} - \textbf{b}^\top \textbf{h} - \textbf{x}^\top \textbf{U} \textbf{x} - \textbf{h}^\top \textbf{V} \textbf{h}
\end{equation}</script><p></p>

<p>分布函数： <br>
<span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"></div><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x2212;</mo><mi>E</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mi>Z</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-68" style="width: 14.534em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.083em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.385em, 1012.08em, 2.698em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-69"><span class="mi" id="MathJax-Span-70" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span class="mo" id="MathJax-Span-71" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-72"><span class="mrow" id="MathJax-Span-73"><span class="mtext" id="MathJax-Span-74" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-75" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-76" style="padding-left: 0.167em;"><span class="mrow" id="MathJax-Span-77"><span class="mtext" id="MathJax-Span-78" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span class="mo" id="MathJax-Span-79" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-80" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-81" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">e</span><span class="mi" id="MathJax-Span-82" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mi" id="MathJax-Span-83" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-84" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-85" style="font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-86" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mo" id="MathJax-Span-87" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-88"><span class="mrow" id="MathJax-Span-89"><span class="mtext" id="MathJax-Span-90" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-91" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-92" style="padding-left: 0.167em;"><span class="mrow" id="MathJax-Span-93"><span class="mtext" id="MathJax-Span-94" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span class="mo" id="MathJax-Span-95" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-96" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-97"><span class="mrow" id="MathJax-Span-98"><span class="mo" id="MathJax-Span-99" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-100" style="font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.362em; border-left: 0px solid; width: 0px; height: 1.325em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>P</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><mo stretchy="false">)</mo><mo>=</mo><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="false">(</mo><mo>−</mo><mi>E</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi>Z</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-2">\begin{equation}
    P(\textbf{x}, \textbf{h}) = exp(-E(\textbf{x}, \textbf{h}))/Z
\end{equation}</script><p></p>

<p>其中分母Z学名叫做partition function <br>
<span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"></div><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>Z</mi><mo>=</mo><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow></mrow></munder><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow></mrow></munder><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x2212;</mo><mi>E</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-101" style="width: 13.961em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.615em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.185em, 1011.52em, 3.655em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-102"><span class="mi" id="MathJax-Span-103" style="font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span class="mo" id="MathJax-Span-104" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="munderover" id="MathJax-Span-105" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.444em; height: 0px;"><span style="position: absolute; clip: rect(2.904em, 1001.39em, 4.617em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-106" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.54em, 1000.41em, 4.267em, -1000em); top: -2.96em; left: 0.507em;"><span class="texatom" id="MathJax-Span-107"><span class="mrow" id="MathJax-Span-108"><span class="texatom" id="MathJax-Span-109"><span class="mrow" id="MathJax-Span-110"><span class="mtext" id="MathJax-Span-111" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">x</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="munderover" id="MathJax-Span-112" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.444em; height: 0px;"><span style="position: absolute; clip: rect(2.904em, 1001.39em, 4.617em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-113" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.363em, 1000.44em, 4.267em, -1000em); top: -2.903em; left: 0.496em;"><span class="texatom" id="MathJax-Span-114"><span class="mrow" id="MathJax-Span-115"><span class="texatom" id="MathJax-Span-116"><span class="mrow" id="MathJax-Span-117"><span class="mtext" id="MathJax-Span-118" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">h</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mi" id="MathJax-Span-119" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">e</span><span class="mi" id="MathJax-Span-120" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mi" id="MathJax-Span-121" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-122" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-123" style="font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-124" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mo" id="MathJax-Span-125" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-126"><span class="mrow" id="MathJax-Span-127"><span class="mtext" id="MathJax-Span-128" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-129" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-130" style="padding-left: 0.167em;"><span class="mrow" id="MathJax-Span-131"><span class="mtext" id="MathJax-Span-132" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span class="mo" id="MathJax-Span-133" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-134" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.511em; border-left: 0px solid; width: 0px; height: 2.714em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>Z</mi><mo>=</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow></mrow></munder><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow></mrow></munder><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="false">(</mo><mo>−</mo><mi>E</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-3">\begin{equation}
    Z = \sum_{\textbf{x}} \sum_{\textbf{h}} exp(-E(\textbf{x}, \textbf{h}))
\end{equation}</script><p></p>



<h2 id="三restricted-boltmann-machines"><a name="t2"></a><strong>三、Restricted Boltmann Machines：</strong></h2>

<p>&nbsp;&nbsp;&nbsp;&nbsp;限制玻尔兹曼机（Restricted Boltmann Machines，简称RBMs）的能量函数（Energy function）是： <br>
<span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"></div><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtable columnalign=&quot;right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em&quot; displaystyle=&quot;true&quot;><mtr><mtd /><mtd><mi>E</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mo>&amp;#x2212;</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>W</mtext></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>&amp;#x2212;</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>c</mtext></mrow><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>&amp;#x2212;</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>b</mtext></mrow><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow></mtd></mtr><mtr><mtd /><mtd><mi></mi><mspace width=&quot;thickmathspace&quot; /><mspace width=&quot;thickmathspace&quot; /><mo>=</mo><mo>&amp;#x2212;</mo><munder><mo>&amp;#x2211;</mo><mi>j</mi></munder><munder><mo>&amp;#x2211;</mo><mi>k</mi></munder><msub><mi>W</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi><mo>,</mo><mi>k</mi></mrow></msub><msub><mi>h</mi><mi>j</mi></msub><msub><mi>x</mi><mi>k</mi></msub><mo>&amp;#x2212;</mo><munder><mo>&amp;#x2211;</mo><mi>k</mi></munder><msub><mi>c</mi><mi>k</mi></msub><msub><mi>x</mi><mi>k</mi></msub><mo>&amp;#x2212;</mo><munder><mo>&amp;#x2211;</mo><mi>j</mi></munder><msub><mi>b</mi><mi>j</mi></msub><msub><mi>h</mi><mi>j</mi></msub></mtd></mtr></mtable></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-135" style="width: 23.44em; display: inline-block;"><span style="display: inline-block; position: relative; width: 19.531em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(-0.08em, 1019.36em, 3.955em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-136"><span class="mtable" id="MathJax-Span-137" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 19.185em; height: 0px;"><span style="position: absolute; clip: rect(2.637em, 1000em, 4.449em, -1000em); top: -4.01em; left: 0em;"><span style="display: inline-block; position: relative; width: 0em; height: 0px;"><span style="position: absolute; clip: rect(3.854em, 1000em, 4.167em, -1000em); top: -5.228em; right: 0em;"><span class="mtd" id="MathJax-Span-138"><span class="mrow" id="MathJax-Span-139"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.854em, 1000em, 4.167em, -1000em); top: -3.728em; right: 0em;"><span class="mtd" id="MathJax-Span-183"><span class="mrow" id="MathJax-Span-184"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(2.473em, 1019.19em, 6.507em, -1000em); top: -4.74em; left: 0em;"><span style="display: inline-block; position: relative; width: 19.185em; height: 0px;"><span style="position: absolute; clip: rect(2.961em, 1014.48em, 4.417em, -1000em); top: -5.228em; left: 0em;"><span class="mtd" id="MathJax-Span-140"><span class="mrow" id="MathJax-Span-141"><span class="mi" id="MathJax-Span-142" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mo" id="MathJax-Span-143" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-144"><span class="mrow" id="MathJax-Span-145"><span class="mtext" id="MathJax-Span-146" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-147" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-148" style="padding-left: 0.167em;"><span class="mrow" id="MathJax-Span-149"><span class="mtext" id="MathJax-Span-150" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span class="mo" id="MathJax-Span-151" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-152" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-153" style="font-family: MathJax_Main; padding-left: 0.278em;">−</span><span class="msubsup" id="MathJax-Span-154"><span style="display: inline-block; position: relative; width: 1.264em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.62em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-155"><span class="mrow" id="MathJax-Span-156"><span class="mtext" id="MathJax-Span-157" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.431em; left: 0.639em;"><span class="mi" id="MathJax-Span-158" style="font-size: 70.7%; font-family: MathJax_Main;">⊤</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="texatom" id="MathJax-Span-159"><span class="mrow" id="MathJax-Span-160"><span class="mtext" id="MathJax-Span-161" style="font-family: MathJax_Main; font-weight: bold;">W</span></span></span><span class="texatom" id="MathJax-Span-162"><span class="mrow" id="MathJax-Span-163"><span class="mtext" id="MathJax-Span-164" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-165" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-166" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.136em; height: 0px;"><span style="position: absolute; clip: rect(3.401em, 1000.48em, 4.173em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-167"><span class="mrow" id="MathJax-Span-168"><span class="mtext" id="MathJax-Span-169" style="font-family: MathJax_Main; font-weight: bold;">c</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.423em; left: 0.511em;"><span class="mi" id="MathJax-Span-170" style="font-size: 70.7%; font-family: MathJax_Main;">⊤</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="texatom" id="MathJax-Span-171"><span class="mrow" id="MathJax-Span-172"><span class="mtext" id="MathJax-Span-173" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-174" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-175" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.264em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.6em, 4.173em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-176"><span class="mrow" id="MathJax-Span-177"><span class="mtext" id="MathJax-Span-178" style="font-family: MathJax_Main; font-weight: bold;">b</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.431em; left: 0.639em;"><span class="mi" id="MathJax-Span-179" style="font-size: 70.7%; font-family: MathJax_Main;">⊤</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="texatom" id="MathJax-Span-180"><span class="mrow" id="MathJax-Span-181"><span class="mtext" id="MathJax-Span-182" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(2.904em, 1019.19em, 5.495em, -1000em); top: -3.728em; left: 0em;"><span class="mtd" id="MathJax-Span-185"><span class="mrow" id="MathJax-Span-186"><span class="mi" id="MathJax-Span-187"></span><span class="mspace" id="MathJax-Span-188" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-189" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-190" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-191" style="font-family: MathJax_Main; padding-left: 0.278em;">−</span><span class="munderover" id="MathJax-Span-192" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.444em; height: 0px;"><span style="position: absolute; clip: rect(2.904em, 1001.39em, 4.617em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-193" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.387em, 1000.29em, 4.411em, -1000em); top: -2.926em; left: 0.576em;"><span class="mi" id="MathJax-Span-194" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="munderover" id="MathJax-Span-195" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.444em; height: 0px;"><span style="position: absolute; clip: rect(2.904em, 1001.39em, 4.617em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-196" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.363em, 1000.36em, 4.274em, -1000em); top: -2.903em; left: 0.538em;"><span class="mi" id="MathJax-Span-197" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-198" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.875em; height: 0px;"><span style="position: absolute; clip: rect(3.171em, 1001.05em, 4.189em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-199" style="font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.944em;"><span class="texatom" id="MathJax-Span-200"><span class="mrow" id="MathJax-Span-201"><span class="mi" id="MathJax-Span-202" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span class="mo" id="MathJax-Span-203" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-204" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-205"><span style="display: inline-block; position: relative; width: 0.942em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.56em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-206" style="font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.576em;"><span class="mi" id="MathJax-Span-207" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-208"><span style="display: inline-block; position: relative; width: 1.015em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.52em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-209" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.572em;"><span class="mi" id="MathJax-Span-210" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-211" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="munderover" id="MathJax-Span-212" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.444em; height: 0px;"><span style="position: absolute; clip: rect(2.904em, 1001.39em, 4.617em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-213" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.363em, 1000.36em, 4.274em, -1000em); top: -2.903em; left: 0.538em;"><span class="mi" id="MathJax-Span-214" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-215" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.876em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-216" style="font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.433em;"><span class="mi" id="MathJax-Span-217" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-218"><span style="display: inline-block; position: relative; width: 1.015em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.52em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-219" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.572em;"><span class="mi" id="MathJax-Span-220" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-221" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="munderover" id="MathJax-Span-222" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.444em; height: 0px;"><span style="position: absolute; clip: rect(2.904em, 1001.39em, 4.617em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-223" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.387em, 1000.29em, 4.411em, -1000em); top: -2.926em; left: 0.576em;"><span class="mi" id="MathJax-Span-224" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-225" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.795em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.42em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-226" style="font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.429em;"><span class="mi" id="MathJax-Span-227" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-228"><span style="display: inline-block; position: relative; width: 0.942em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.56em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-229" style="font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.576em;"><span class="mi" id="MathJax-Span-230" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.74em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.995em; border-left: 0px solid; width: 0px; height: 4.591em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left" rowspacing="3pt" columnspacing="0em" displaystyle="true"><mtr><mtd></mtd><mtd><mi>E</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><mi mathvariant="normal">⊤</mi></msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">W</mtext></mrow><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>−</mo><msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">c</mtext></mrow><mi mathvariant="normal">⊤</mi></msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>−</mo><msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">b</mtext></mrow><mi mathvariant="normal">⊤</mi></msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mspace width="thickmathspace"></mspace><mspace width="thickmathspace"></mspace><mo>=</mo><mo>−</mo><munder><mo>∑</mo><mi>j</mi></munder><munder><mo>∑</mo><mi>k</mi></munder><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>,</mo><mi>k</mi></mrow></msub><msub><mi>h</mi><mi>j</mi></msub><msub><mi>x</mi><mi>k</mi></msub><mo>−</mo><munder><mo>∑</mo><mi>k</mi></munder><msub><mi>c</mi><mi>k</mi></msub><msub><mi>x</mi><mi>k</mi></msub><mo>−</mo><munder><mo>∑</mo><mi>j</mi></munder><msub><mi>b</mi><mi>j</mi></msub><msub><mi>h</mi><mi>j</mi></msub></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-4">\begin{equation}
    \begin{split}
        &E(\textbf{x}, \textbf{h}) = -\textbf{h}^\top \textbf{W} \textbf{x} - \textbf{c}^\top \textbf{x} - \textbf{b}^\top \textbf{h}\\
        &\;\;=-\sum_j \sum_k  W_{j,k}h_j x_k - \sum_k c_k x_k - \sum_j b_j h_j\\
    \end{split}
\end{equation}</script><p></p>

<p>分布函数： <br>
<span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"></div><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>exp</mi><mo>&amp;#x2061;</mo><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x2212;</mo><mi>E</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mi>Z</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-231" style="width: 14.534em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.083em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.385em, 1012.08em, 2.698em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-232"><span class="mi" id="MathJax-Span-233" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span class="mo" id="MathJax-Span-234" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-235"><span class="mrow" id="MathJax-Span-236"><span class="mtext" id="MathJax-Span-237" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-238" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-239" style="padding-left: 0.167em;"><span class="mrow" id="MathJax-Span-240"><span class="mtext" id="MathJax-Span-241" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span class="mo" id="MathJax-Span-242" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-243" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-244" style="font-family: MathJax_Main; padding-left: 0.278em;">exp</span><span class="mo" id="MathJax-Span-245"></span><span class="mo" id="MathJax-Span-246" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-247" style="font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-248" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mo" id="MathJax-Span-249" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-250"><span class="mrow" id="MathJax-Span-251"><span class="mtext" id="MathJax-Span-252" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-253" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-254" style="padding-left: 0.167em;"><span class="mrow" id="MathJax-Span-255"><span class="mtext" id="MathJax-Span-256" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span class="mo" id="MathJax-Span-257" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-258" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-259"><span class="mrow" id="MathJax-Span-260"><span class="mo" id="MathJax-Span-261" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-262" style="font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.362em; border-left: 0px solid; width: 0px; height: 1.325em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>P</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><mo stretchy="false">)</mo><mo>=</mo><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><mo>−</mo><mi>E</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi>Z</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-5">\begin{equation}
    P(\textbf{x}, \textbf{h}) = \exp(-E(\textbf{x}, \textbf{h}))/Z
\end{equation}</script> <br>
能量函数的能量越小，分布函数相应的概率就越大。<p></p>

<p>&nbsp;  &nbsp;  &nbsp;&nbsp;玻尔兹曼机和限制玻尔兹曼机都属于基于能量的模型（Energy-Based Models），从模型图和公式中很容易看出两者的区别：玻尔兹曼机隐含层（和可见层）处于同一层的任意两个节点之间有一条连线；而限制玻尔兹曼机同层变量之间是相互独立的。只要有足够的隐单元，限制玻尔兹曼机可以表示任意的离散分布，玻尔兹曼机的表示能力则更强一些。另一方面，限制玻尔兹曼机比玻尔兹曼机更容易训练。</p>



<h2 id="四模型学习"><a name="t3"></a><strong>四、模型学习：</strong></h2>

<p>&nbsp;&nbsp;&nbsp;&nbsp;训练RBMs就是学习能量函数的过程，变量中只有输入<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-263" style="width: 0.784em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.625em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.639em, 1000.6em, 2.396em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-264"><span class="texatom" id="MathJax-Span-265"><span class="mrow" id="MathJax-Span-266"><span class="mtext" id="MathJax-Span-267" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.658em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow></math></span></span><script type="math/tex" id="MathJax-Element-6">\textbf{x}</script>是已知的。 <br>
</p><center><img src="https://img-blog.csdn.net/20151207175536478" alt="RBMs" title=""></center><p></p>



<h3 id="free-energy"><a name="t4"></a><strong>Free Energy：</strong></h3>

<p>&nbsp;&nbsp;&nbsp;&nbsp;为了后面计算公式的简洁，首先引入Free Energy这个概念： <br>
<span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"></div><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow></mrow></munder><mfrac><msup><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x2212;</mo><mi>E</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mi>Z</mi></mfrac><mo>=</mo><mfrac><msup><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x2212;</mo><mi>F</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>E</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>y</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mi>Z</mi></mfrac><mo>,</mo><mspace width=&quot;thickmathspace&quot; /><mspace width=&quot;thickmathspace&quot; /><mi>Z</mi><mo>=</mo><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow></mrow></munder><msup><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x2212;</mo><mi>F</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>E</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>y</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo></mrow></msup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-268" style="width: 32.19em; display: inline-block;"><span style="display: inline-block; position: relative; width: 26.823em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.566em, 1026.82em, 3.655em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-269"><span class="mi" id="MathJax-Span-270" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span class="mo" id="MathJax-Span-271" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-272"><span class="mrow" id="MathJax-Span-273"><span class="mtext" id="MathJax-Span-274" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-275" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-276" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="munderover" id="MathJax-Span-277" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.444em; height: 0px;"><span style="position: absolute; clip: rect(2.904em, 1001.39em, 4.617em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-278" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.363em, 1000.44em, 4.267em, -1000em); top: -2.903em; left: 0.496em;"><span class="texatom" id="MathJax-Span-279"><span class="mrow" id="MathJax-Span-280"><span class="texatom" id="MathJax-Span-281"><span class="mrow" id="MathJax-Span-282"><span class="mtext" id="MathJax-Span-283" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">h</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-284" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 3.379em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(2.961em, 1003.26em, 4.178em, -1000em); top: -4.687em; left: 50%; margin-left: -1.63em;"><span class="msubsup" id="MathJax-Span-285"><span style="display: inline-block; position: relative; width: 3.259em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-286" style="font-family: MathJax_Math; font-style: italic;">e</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.466em;"><span class="texatom" id="MathJax-Span-287"><span class="mrow" id="MathJax-Span-288"><span class="mo" id="MathJax-Span-289" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-290" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.018em;"></span></span><span class="mo" id="MathJax-Span-291" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-292"><span class="mrow" id="MathJax-Span-293"><span class="mtext" id="MathJax-Span-294" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-295" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-296"><span class="mrow" id="MathJax-Span-297"><span class="mtext" id="MathJax-Span-298" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span class="mo" id="MathJax-Span-299" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.171em, 1000.72em, 4.167em, -1000em); top: -3.324em; left: 50%; margin-left: -0.361em;"><span class="mi" id="MathJax-Span-300" style="font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1003.38em, 1.198em, -1000em); top: -1.262em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.379em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span><span class="mo" id="MathJax-Span-301" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mfrac" id="MathJax-Span-302" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 6.001em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(2.961em, 1005.88em, 4.178em, -1000em); top: -4.687em; left: 50%; margin-left: -2.941em;"><span class="msubsup" id="MathJax-Span-303"><span style="display: inline-block; position: relative; width: 5.881em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-304" style="font-family: MathJax_Math; font-style: italic;">e</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.466em;"><span class="texatom" id="MathJax-Span-305"><span class="mrow" id="MathJax-Span-306"><span class="mo" id="MathJax-Span-307" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-308" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.075em;"></span></span><span class="mi" id="MathJax-Span-309" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-310" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-311" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-312" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.018em;"></span></span><span class="mi" id="MathJax-Span-313" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-314" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-315" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-316" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-317" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span><span class="mo" id="MathJax-Span-318" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-319"><span class="mrow" id="MathJax-Span-320"><span class="mtext" id="MathJax-Span-321" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-322" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.171em, 1000.72em, 4.167em, -1000em); top: -3.324em; left: 50%; margin-left: -0.361em;"><span class="mi" id="MathJax-Span-323" style="font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1006em, 1.198em, -1000em); top: -1.262em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 6.001em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span><span class="mo" id="MathJax-Span-324" style="font-family: MathJax_Main;">,</span><span class="mspace" id="MathJax-Span-325" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-326" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-327" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span class="mo" id="MathJax-Span-328" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="munderover" id="MathJax-Span-329" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.444em; height: 0px;"><span style="position: absolute; clip: rect(2.904em, 1001.39em, 4.617em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-330" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.54em, 1000.41em, 4.267em, -1000em); top: -2.96em; left: 0.507em;"><span class="texatom" id="MathJax-Span-331"><span class="mrow" id="MathJax-Span-332"><span class="texatom" id="MathJax-Span-333"><span class="mrow" id="MathJax-Span-334"><span class="mtext" id="MathJax-Span-335" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">x</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-336" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 5.881em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-337" style="font-family: MathJax_Math; font-style: italic;">e</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.423em; left: 0.466em;"><span class="texatom" id="MathJax-Span-338"><span class="mrow" id="MathJax-Span-339"><span class="mo" id="MathJax-Span-340" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-341" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.075em;"></span></span><span class="mi" id="MathJax-Span-342" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-343" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-344" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-345" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.018em;"></span></span><span class="mi" id="MathJax-Span-346" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-347" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-348" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-349" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-350" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span><span class="mo" id="MathJax-Span-351" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-352"><span class="mrow" id="MathJax-Span-353"><span class="mtext" id="MathJax-Span-354" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-355" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.511em; border-left: 0px solid; width: 0px; height: 3.458em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>P</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo stretchy="false">)</mo><mo>=</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow></mrow></munder><mfrac><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mi>E</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><mo stretchy="false">)</mo></mrow></msup><mi>Z</mi></mfrac><mo>=</mo><mfrac><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mi>F</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>E</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>y</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo stretchy="false">)</mo></mrow></msup><mi>Z</mi></mfrac><mo>,</mo><mspace width="thickmathspace"></mspace><mspace width="thickmathspace"></mspace><mi>Z</mi><mo>=</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow></mrow></munder><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mi>F</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>E</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>y</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo stretchy="false">)</mo></mrow></msup></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-7">\begin{equation}
    P(\textbf{x}) = \sum_{\textbf{h}} \frac{e^{-E(\textbf{x}, \textbf{h})}}{Z} = \frac{e^{-FreeEnergy(\textbf{x})}}{Z},\;\; Z = \sum_{\textbf{x}}e^{-FreeEnergy(\textbf{x})}
\end{equation}</script><p></p>



<p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"></div><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-168-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>F</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>E</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>y</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mo>&amp;#x2212;</mo><mi>l</mi><mi>o</mi><mi>g</mi><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow></mrow></munder><msup><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x2212;</mo><mi>E</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo></mrow></msup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-356" style="width: 18.284em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.208em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.185em, 1015.21em, 3.655em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-357"><span class="mi" id="MathJax-Span-358" style="font-family: MathJax_Math; font-style: italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mi" id="MathJax-Span-359" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-360" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-361" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-362" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mi" id="MathJax-Span-363" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-364" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-365" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-366" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-367" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-368" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-369"><span class="mrow" id="MathJax-Span-370"><span class="mtext" id="MathJax-Span-371" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-372" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-373" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-374" style="font-family: MathJax_Main; padding-left: 0.278em;">−</span><span class="mi" id="MathJax-Span-375" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-376" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-377" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="munderover" id="MathJax-Span-378" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.444em; height: 0px;"><span style="position: absolute; clip: rect(2.904em, 1001.39em, 4.617em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-379" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.363em, 1000.44em, 4.267em, -1000em); top: -2.903em; left: 0.496em;"><span class="texatom" id="MathJax-Span-380"><span class="mrow" id="MathJax-Span-381"><span class="texatom" id="MathJax-Span-382"><span class="mrow" id="MathJax-Span-383"><span class="mtext" id="MathJax-Span-384" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">h</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-385" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 3.259em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-386" style="font-family: MathJax_Math; font-style: italic;">e</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.423em; left: 0.466em;"><span class="texatom" id="MathJax-Span-387"><span class="mrow" id="MathJax-Span-388"><span class="mo" id="MathJax-Span-389" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-390" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.018em;"></span></span><span class="mo" id="MathJax-Span-391" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-392"><span class="mrow" id="MathJax-Span-393"><span class="mtext" id="MathJax-Span-394" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-395" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-396"><span class="mrow" id="MathJax-Span-397"><span class="mtext" id="MathJax-Span-398" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span class="mo" id="MathJax-Span-399" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.511em; border-left: 0px solid; width: 0px; height: 2.714em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>F</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>E</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>y</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mi>l</mi><mi>o</mi><mi>g</mi><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow></mrow></munder><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mi>E</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><mo stretchy="false">)</mo></mrow></msup></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-168">\begin{equation}
    FreeEnergy(\textbf{x}) = -log \sum_{\textbf{h}} e^{-E(\textbf{x}, \textbf{h})}
\end{equation}</script><p></p>

<p>例如：如果<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-169-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>h</mi><mi>i</mi></msub><mo>&amp;#x2208;</mo><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>}</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-400" style="width: 5.523em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.583em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.333em, 1004.52em, 2.646em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-401"><span class="msubsup" id="MathJax-Span-402"><span style="display: inline-block; position: relative; width: 0.895em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.56em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-403" style="font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.576em;"><span class="mi" id="MathJax-Span-404" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-405" style="font-family: MathJax_Main; padding-left: 0.278em;">∈</span><span class="mo" id="MathJax-Span-406" style="font-family: MathJax_Main; padding-left: 0.278em;">{</span><span class="mn" id="MathJax-Span-407" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-408" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-409" style="font-family: MathJax_Main; padding-left: 0.167em;">1</span><span class="mo" id="MathJax-Span-410" style="font-family: MathJax_Main;">}</span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.362em; border-left: 0px solid; width: 0px; height: 1.325em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>h</mi><mi>i</mi></msub><mo>∈</mo><mo fence="false" stretchy="false">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo fence="false" stretchy="false">}</mo></math></span></span><script type="math/tex" id="MathJax-Element-169">h_i\in \{0,1\}</script>： <br>
<span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"></div><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-170-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtable columnalign=&quot;right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em&quot; displaystyle=&quot;true&quot;><mtr><mtd /><mtd><mi>F</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>E</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>y</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mo>&amp;#x2212;</mo><mi>l</mi><mi>o</mi><mi>g</mi><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow></mrow></munder><msup><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x2212;</mo><mi>E</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>=</mo><mo>&amp;#x2212;</mo><mi>l</mi><mi>o</mi><mi>g</mi><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow></mrow></munder><msup><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>W</mtext></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>+</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>c</mtext></mrow><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>+</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>b</mtext></mrow><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow></mrow></msup></mtd></mtr><mtr><mtd /><mtd><mi></mi><mo>=</mo><mo>&amp;#x2212;</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>c</mtext></mrow><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>&amp;#x2212;</mo><mi>l</mi><mi>o</mi><mi>g</mi><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow></mrow></munder><msup><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>W</mtext></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>+</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>b</mtext></mrow><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow></mrow></msup><mo>=</mo><mo>&amp;#x2212;</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>c</mtext></mrow><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>&amp;#x2212;</mo><mi>l</mi><mi>o</mi><mi>g</mi><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow></mrow></munder><msup><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>h</mi><mn>1</mn></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>W</mtext></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>&amp;#x22C5;</mo></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>+</mo><msub><mi>b</mi><mn>1</mn></msub><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>&amp;#x22EF;</mo><msup><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>h</mi><mi>n</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>W</mtext></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>&amp;#x22C5;</mo></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>+</mo><msub><mi>b</mi><mi>n</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow></msup></mtd></mtr><mtr><mtd /><mtd><mi></mi><mo>=</mo><mo>&amp;#x2212;</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>c</mtext></mrow><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>&amp;#x2212;</mo><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></munder><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>W</mtext></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>&amp;#x22C5;</mo></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>+</mo><msub><mi>b</mi><mi>i</mi></msub></mrow></msup><mo stretchy=&quot;false&quot;>)</mo></mtd></mtr></mtable></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-411" style="width: 38.648em; display: inline-block;"><span style="display: inline-block; position: relative; width: 32.188em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(-1.842em, 1032.02em, 5.717em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-412"><span class="mtable" id="MathJax-Span-413" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 31.833em; height: 0px;"><span style="position: absolute; clip: rect(3.005em, 1000em, 8.327em, -1000em); top: -5.99em; left: 0em;"><span style="display: inline-block; position: relative; width: 0em; height: 0px;"><span style="position: absolute; clip: rect(3.854em, 1000em, 4.167em, -1000em); top: -6.839em; right: 0em;"><span class="mtd" id="MathJax-Span-414"><span class="mrow" id="MathJax-Span-415"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.854em, 1000em, 4.167em, -1000em); top: -4.287em; right: 0em;"><span class="mtd" id="MathJax-Span-505"><span class="mrow" id="MathJax-Span-506"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.854em, 1000em, 4.167em, -1000em); top: -1.829em; right: 0em;"><span class="mtd" id="MathJax-Span-625"><span class="mrow" id="MathJax-Span-626"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.99em;"></span></span><span style="position: absolute; clip: rect(4.2em, 1031.83em, 11.758em, -1000em); top: -8.229em; left: 0em;"><span style="display: inline-block; position: relative; width: 31.833em; height: 0px;"><span style="position: absolute; clip: rect(2.81em, 1026.72em, 5.374em, -1000em); top: -6.839em; left: 0em;"><span class="mtd" id="MathJax-Span-416"><span class="mrow" id="MathJax-Span-417"><span class="mi" id="MathJax-Span-418" style="font-family: MathJax_Math; font-style: italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mi" id="MathJax-Span-419" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-420" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-421" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-422" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mi" id="MathJax-Span-423" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-424" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-425" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-426" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-427" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-428" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-429"><span class="mrow" id="MathJax-Span-430"><span class="mtext" id="MathJax-Span-431" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-432" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-433" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-434" style="font-family: MathJax_Main; padding-left: 0.278em;">−</span><span class="mi" id="MathJax-Span-435" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-436" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-437" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="munderover" id="MathJax-Span-438" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.444em; height: 0px;"><span style="position: absolute; clip: rect(2.904em, 1001.39em, 4.617em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-439" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.363em, 1000.44em, 4.267em, -1000em); top: -2.903em; left: 0.496em;"><span class="texatom" id="MathJax-Span-440"><span class="mrow" id="MathJax-Span-441"><span class="texatom" id="MathJax-Span-442"><span class="mrow" id="MathJax-Span-443"><span class="mtext" id="MathJax-Span-444" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">h</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-445" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 3.259em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-446" style="font-family: MathJax_Math; font-style: italic;">e</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.423em; left: 0.466em;"><span class="texatom" id="MathJax-Span-447"><span class="mrow" id="MathJax-Span-448"><span class="mo" id="MathJax-Span-449" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-450" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.018em;"></span></span><span class="mo" id="MathJax-Span-451" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-452"><span class="mrow" id="MathJax-Span-453"><span class="mtext" id="MathJax-Span-454" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-455" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-456"><span class="mrow" id="MathJax-Span-457"><span class="mtext" id="MathJax-Span-458" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span class="mo" id="MathJax-Span-459" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-460" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-461" style="font-family: MathJax_Main; padding-left: 0.278em;">−</span><span class="mi" id="MathJax-Span-462" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-463" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-464" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="munderover" id="MathJax-Span-465" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.444em; height: 0px;"><span style="position: absolute; clip: rect(2.904em, 1001.39em, 4.617em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-466" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.363em, 1000.44em, 4.267em, -1000em); top: -2.903em; left: 0.496em;"><span class="texatom" id="MathJax-Span-467"><span class="mrow" id="MathJax-Span-468"><span class="texatom" id="MathJax-Span-469"><span class="mrow" id="MathJax-Span-470"><span class="mtext" id="MathJax-Span-471" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">h</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-472" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 6.383em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-473" style="font-family: MathJax_Math; font-style: italic;">e</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.423em; left: 0.466em;"><span class="texatom" id="MathJax-Span-474"><span class="mrow" id="MathJax-Span-475"><span class="msubsup" id="MathJax-Span-476"><span style="display: inline-block; position: relative; width: 0.894em; height: 0px;"><span style="position: absolute; clip: rect(3.363em, 1000.44em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-477"><span class="mrow" id="MathJax-Span-478"><span class="mtext" id="MathJax-Span-479" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.308em; left: 0.452em;"><span class="mi" id="MathJax-Span-480" style="font-size: 50%; font-family: MathJax_Main;">⊤</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="texatom" id="MathJax-Span-481"><span class="mrow" id="MathJax-Span-482"><span class="mtext" id="MathJax-Span-483" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">W</span></span></span><span class="texatom" id="MathJax-Span-484"><span class="mrow" id="MathJax-Span-485"><span class="mtext" id="MathJax-Span-486" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-487" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="msubsup" id="MathJax-Span-488"><span style="display: inline-block; position: relative; width: 0.803em; height: 0px;"><span style="position: absolute; clip: rect(3.534em, 1000.34em, 4.171em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-489"><span class="mrow" id="MathJax-Span-490"><span class="mtext" id="MathJax-Span-491" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">c</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.267em; left: 0.361em;"><span class="mi" id="MathJax-Span-492" style="font-size: 50%; font-family: MathJax_Main;">⊤</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="texatom" id="MathJax-Span-493"><span class="mrow" id="MathJax-Span-494"><span class="mtext" id="MathJax-Span-495" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-496" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="msubsup" id="MathJax-Span-497"><span style="display: inline-block; position: relative; width: 0.894em; height: 0px;"><span style="position: absolute; clip: rect(3.363em, 1000.42em, 4.171em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-498"><span class="mrow" id="MathJax-Span-499"><span class="mtext" id="MathJax-Span-500" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">b</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.308em; left: 0.452em;"><span class="mi" id="MathJax-Span-501" style="font-size: 50%; font-family: MathJax_Main;">⊤</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="texatom" id="MathJax-Span-502"><span class="mrow" id="MathJax-Span-503"><span class="mtext" id="MathJax-Span-504" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">h</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(2.81em, 1031.83em, 5.374em, -1000em); top: -4.287em; left: 0em;"><span class="mtd" id="MathJax-Span-507"><span class="mrow" id="MathJax-Span-508"><span class="mi" id="MathJax-Span-509"></span><span class="mo" id="MathJax-Span-510" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-511" style="font-family: MathJax_Main; padding-left: 0.278em;">−</span><span class="msubsup" id="MathJax-Span-512"><span style="display: inline-block; position: relative; width: 1.136em; height: 0px;"><span style="position: absolute; clip: rect(3.401em, 1000.48em, 4.173em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-513"><span class="mrow" id="MathJax-Span-514"><span class="mtext" id="MathJax-Span-515" style="font-family: MathJax_Main; font-weight: bold;">c</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.423em; left: 0.511em;"><span class="mi" id="MathJax-Span-516" style="font-size: 70.7%; font-family: MathJax_Main;">⊤</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="texatom" id="MathJax-Span-517"><span class="mrow" id="MathJax-Span-518"><span class="mtext" id="MathJax-Span-519" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-520" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-521" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">l</span><span class="mi" id="MathJax-Span-522" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-523" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="munderover" id="MathJax-Span-524" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.444em; height: 0px;"><span style="position: absolute; clip: rect(2.904em, 1001.39em, 4.617em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-525" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.363em, 1000.44em, 4.267em, -1000em); top: -2.903em; left: 0.496em;"><span class="texatom" id="MathJax-Span-526"><span class="mrow" id="MathJax-Span-527"><span class="texatom" id="MathJax-Span-528"><span class="mrow" id="MathJax-Span-529"><span class="mtext" id="MathJax-Span-530" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">h</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-531" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 4.601em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-532" style="font-family: MathJax_Math; font-style: italic;">e</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.423em; left: 0.466em;"><span class="texatom" id="MathJax-Span-533"><span class="mrow" id="MathJax-Span-534"><span class="msubsup" id="MathJax-Span-535"><span style="display: inline-block; position: relative; width: 0.894em; height: 0px;"><span style="position: absolute; clip: rect(3.363em, 1000.44em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-536"><span class="mrow" id="MathJax-Span-537"><span class="mtext" id="MathJax-Span-538" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.308em; left: 0.452em;"><span class="mi" id="MathJax-Span-539" style="font-size: 50%; font-family: MathJax_Main;">⊤</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="texatom" id="MathJax-Span-540"><span class="mrow" id="MathJax-Span-541"><span class="mtext" id="MathJax-Span-542" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">W</span></span></span><span class="texatom" id="MathJax-Span-543"><span class="mrow" id="MathJax-Span-544"><span class="mtext" id="MathJax-Span-545" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-546" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="msubsup" id="MathJax-Span-547"><span style="display: inline-block; position: relative; width: 0.894em; height: 0px;"><span style="position: absolute; clip: rect(3.363em, 1000.42em, 4.171em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-548"><span class="mrow" id="MathJax-Span-549"><span class="mtext" id="MathJax-Span-550" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">b</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.308em; left: 0.452em;"><span class="mi" id="MathJax-Span-551" style="font-size: 50%; font-family: MathJax_Main;">⊤</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="texatom" id="MathJax-Span-552"><span class="mrow" id="MathJax-Span-553"><span class="mtext" id="MathJax-Span-554" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">h</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-555" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-556" style="font-family: MathJax_Main; padding-left: 0.278em;">−</span><span class="msubsup" id="MathJax-Span-557"><span style="display: inline-block; position: relative; width: 1.136em; height: 0px;"><span style="position: absolute; clip: rect(3.401em, 1000.48em, 4.173em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-558"><span class="mrow" id="MathJax-Span-559"><span class="mtext" id="MathJax-Span-560" style="font-family: MathJax_Main; font-weight: bold;">c</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.423em; left: 0.511em;"><span class="mi" id="MathJax-Span-561" style="font-size: 70.7%; font-family: MathJax_Main;">⊤</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="texatom" id="MathJax-Span-562"><span class="mrow" id="MathJax-Span-563"><span class="mtext" id="MathJax-Span-564" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-565" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-566" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">l</span><span class="mi" id="MathJax-Span-567" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-568" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="munderover" id="MathJax-Span-569" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.444em; height: 0px;"><span style="position: absolute; clip: rect(2.904em, 1001.39em, 4.617em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-570" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.363em, 1000.44em, 4.267em, -1000em); top: -2.903em; left: 0.496em;"><span class="texatom" id="MathJax-Span-571"><span class="mrow" id="MathJax-Span-572"><span class="texatom" id="MathJax-Span-573"><span class="mrow" id="MathJax-Span-574"><span class="mtext" id="MathJax-Span-575" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">h</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-576" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 4.67em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-577" style="font-family: MathJax_Math; font-style: italic;">e</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.423em; left: 0.466em;"><span class="texatom" id="MathJax-Span-578"><span class="mrow" id="MathJax-Span-579"><span class="msubsup" id="MathJax-Span-580"><span style="display: inline-block; position: relative; width: 0.71em; height: 0px;"><span style="position: absolute; clip: rect(3.363em, 1000.39em, 4.174em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-581" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.904em; left: 0.407em;"><span class="mn" id="MathJax-Span-582" style="font-size: 50%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-583" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-584"><span style="display: inline-block; position: relative; width: 1.283em; height: 0px;"><span style="position: absolute; clip: rect(3.369em, 1000.82em, 4.172em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-585"><span class="mrow" id="MathJax-Span-586"><span class="mtext" id="MathJax-Span-587" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">W</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.904em; left: 0.841em;"><span class="texatom" id="MathJax-Span-588"><span class="mrow" id="MathJax-Span-589"><span class="mn" id="MathJax-Span-590" style="font-size: 50%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-591" style="font-size: 50%; font-family: MathJax_Main;">⋅</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="texatom" id="MathJax-Span-592"><span class="mrow" id="MathJax-Span-593"><span class="mtext" id="MathJax-Span-594" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-595" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="msubsup" id="MathJax-Span-596"><span style="display: inline-block; position: relative; width: 0.606em; height: 0px;"><span style="position: absolute; clip: rect(3.363em, 1000.3em, 4.174em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-597" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.904em; left: 0.303em;"><span class="mn" id="MathJax-Span-598" style="font-size: 50%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-599" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-600" style="font-family: MathJax_Main; padding-left: 0.167em;">⋯</span><span class="msubsup" id="MathJax-Span-601" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 4.82em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-602" style="font-family: MathJax_Math; font-style: italic;">e</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.423em; left: 0.466em;"><span class="texatom" id="MathJax-Span-603"><span class="mrow" id="MathJax-Span-604"><span class="msubsup" id="MathJax-Span-605"><span style="display: inline-block; position: relative; width: 0.76em; height: 0px;"><span style="position: absolute; clip: rect(3.363em, 1000.39em, 4.174em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-606" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.904em; left: 0.407em;"><span class="mi" id="MathJax-Span-607" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-608" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-609"><span style="display: inline-block; position: relative; width: 1.333em; height: 0px;"><span style="position: absolute; clip: rect(3.369em, 1000.82em, 4.172em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-610"><span class="mrow" id="MathJax-Span-611"><span class="mtext" id="MathJax-Span-612" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">W</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.904em; left: 0.841em;"><span class="texatom" id="MathJax-Span-613"><span class="mrow" id="MathJax-Span-614"><span class="mi" id="MathJax-Span-615" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-616" style="font-size: 50%; font-family: MathJax_Main;">⋅</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="texatom" id="MathJax-Span-617"><span class="mrow" id="MathJax-Span-618"><span class="mtext" id="MathJax-Span-619" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-620" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="msubsup" id="MathJax-Span-621"><span style="display: inline-block; position: relative; width: 0.656em; height: 0px;"><span style="position: absolute; clip: rect(3.363em, 1000.3em, 4.174em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-622" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.904em; left: 0.303em;"><span class="mi" id="MathJax-Span-623" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-624" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(2.904em, 1013.61em, 5.359em, -1000em); top: -1.829em; left: 0em;"><span class="mtd" id="MathJax-Span-627"><span class="mrow" id="MathJax-Span-628"><span class="mi" id="MathJax-Span-629"></span><span class="mo" id="MathJax-Span-630" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-631" style="font-family: MathJax_Main; padding-left: 0.278em;">−</span><span class="msubsup" id="MathJax-Span-632"><span style="display: inline-block; position: relative; width: 1.136em; height: 0px;"><span style="position: absolute; clip: rect(3.401em, 1000.48em, 4.173em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-633"><span class="mrow" id="MathJax-Span-634"><span class="mtext" id="MathJax-Span-635" style="font-family: MathJax_Main; font-weight: bold;">c</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.423em; left: 0.511em;"><span class="mi" id="MathJax-Span-636" style="font-size: 70.7%; font-family: MathJax_Main;">⊤</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="texatom" id="MathJax-Span-637"><span class="mrow" id="MathJax-Span-638"><span class="mtext" id="MathJax-Span-639" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-640" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="munderover" id="MathJax-Span-641" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.444em; height: 0px;"><span style="position: absolute; clip: rect(2.904em, 1001.39em, 4.617em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-642" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.387em, 1000.21em, 4.274em, -1000em); top: -2.926em; left: 0.6em;"><span class="texatom" id="MathJax-Span-643"><span class="mrow" id="MathJax-Span-644"><span class="mi" id="MathJax-Span-645" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mi" id="MathJax-Span-646" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">l</span><span class="mi" id="MathJax-Span-647" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-648" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-649" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-650" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-651" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msubsup" id="MathJax-Span-652" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 3.255em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-653" style="font-family: MathJax_Math; font-style: italic;">e</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.423em; left: 0.466em;"><span class="texatom" id="MathJax-Span-654"><span class="mrow" id="MathJax-Span-655"><span class="msubsup" id="MathJax-Span-656"><span style="display: inline-block; position: relative; width: 1.205em; height: 0px;"><span style="position: absolute; clip: rect(3.369em, 1000.82em, 4.172em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-657"><span class="mrow" id="MathJax-Span-658"><span class="mtext" id="MathJax-Span-659" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">W</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.904em; left: 0.841em;"><span class="texatom" id="MathJax-Span-660"><span class="mrow" id="MathJax-Span-661"><span class="mi" id="MathJax-Span-662" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-663" style="font-size: 50%; font-family: MathJax_Main;">⋅</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="texatom" id="MathJax-Span-664"><span class="mrow" id="MathJax-Span-665"><span class="mtext" id="MathJax-Span-666" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-667" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="msubsup" id="MathJax-Span-668"><span style="display: inline-block; position: relative; width: 0.529em; height: 0px;"><span style="position: absolute; clip: rect(3.363em, 1000.3em, 4.174em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-669" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.904em; left: 0.303em;"><span class="mi" id="MathJax-Span-670" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-671" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span><span style="display: inline-block; width: 0px; height: 8.229em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -4.11em; border-left: 0px solid; width: 0px; height: 8.82em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left" rowspacing="3pt" columnspacing="0em" displaystyle="true"><mtr><mtd></mtd><mtd><mi>F</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>E</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>y</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mi>l</mi><mi>o</mi><mi>g</mi><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow></mrow></munder><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mi>E</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><mo>−</mo><mi>l</mi><mi>o</mi><mi>g</mi><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow></mrow></munder><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><mi mathvariant="normal">⊤</mi></msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">W</mtext></mrow><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>+</mo><msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">c</mtext></mrow><mi mathvariant="normal">⊤</mi></msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>+</mo><msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">b</mtext></mrow><mi mathvariant="normal">⊤</mi></msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow></mrow></msup></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><mo>−</mo><msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">c</mtext></mrow><mi mathvariant="normal">⊤</mi></msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>−</mo><mi>l</mi><mi>o</mi><mi>g</mi><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow></mrow></munder><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><mi mathvariant="normal">⊤</mi></msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">W</mtext></mrow><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>+</mo><msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">b</mtext></mrow><mi mathvariant="normal">⊤</mi></msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow></mrow></msup><mo>=</mo><mo>−</mo><msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">c</mtext></mrow><mi mathvariant="normal">⊤</mi></msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>−</mo><mi>l</mi><mi>o</mi><mi>g</mi><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow></mrow></munder><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>h</mi><mn>1</mn></msub><mo stretchy="false">(</mo><msub><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">W</mtext></mrow><mrow class="MJX-TeXAtom-ORD"><mn>1</mn><mo>⋅</mo></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>+</mo><msub><mi>b</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow></msup><mo>⋯</mo><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>h</mi><mi>n</mi></msub><mo stretchy="false">(</mo><msub><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">W</mtext></mrow><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>⋅</mo></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>+</mo><msub><mi>b</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow></msup></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><mo>−</mo><msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">c</mtext></mrow><mi mathvariant="normal">⊤</mi></msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>−</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></munder><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><msub><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">W</mtext></mrow><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>⋅</mo></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>+</mo><msub><mi>b</mi><mi>i</mi></msub></mrow></msup><mo stretchy="false">)</mo></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-170">\begin{equation}
    \begin{split}
    &FreeEnergy(\textbf{x}) = -log \sum_{\textbf{h}} e^{-E(\textbf{x}, \textbf{h})}=-log \sum_{\textbf{h}} e^{\textbf{h}^\top \textbf{W} \textbf{x} + \textbf{c}^\top \textbf{x} + \textbf{b}^\top \textbf{h}}\\
    &=-\textbf{c}^\top \textbf{x}-log \sum_{\textbf{h}} e^{\textbf{h}^\top \textbf{W} \textbf{x} + \textbf{b}^\top \textbf{h}} = -\textbf{c}^\top \textbf{x}-log \sum_{\textbf{h}} e^{h_1( \textbf{W}_{1\cdot} \textbf{x} + b_1)}\cdots e^{h_n( \textbf{W}_{n\cdot} \textbf{x} + b_n)}\\
    &=-\textbf{c}^\top \textbf{x}- \sum_{i} log (1+e^{ \textbf{W}_{i\cdot} \textbf{x} + b_i})\\
    \end{split}
\end{equation}</script> <br>
给定参数和<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-171-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-672" style="width: 0.784em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.625em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.639em, 1000.6em, 2.396em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-673"><span class="texatom" id="MathJax-Span-674"><span class="mrow" id="MathJax-Span-675"><span class="mtext" id="MathJax-Span-676" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.658em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow></math></span></span><script type="math/tex" id="MathJax-Element-171">\textbf{x}</script>就可以很容易的计算出Free Energy的值，不依赖于隐单元<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-172-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-677" style="width: 0.784em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.625em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.389em, 1000.61em, 2.396em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-678"><span class="texatom" id="MathJax-Span-679"><span class="mrow" id="MathJax-Span-680"><span class="mtext" id="MathJax-Span-681" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.958em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow></math></span></span><script type="math/tex" id="MathJax-Element-172">\textbf{h}</script>的具体取值。<p></p>

<h3 id="梯度方法进行优化"><a name="t5"></a><strong>梯度方法进行优化：</strong></h3>

<p>&nbsp;  &nbsp;  &nbsp;&nbsp;用梯度算法学习RBMs模型参数<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-105-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B8;</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-682" style="width: 0.576em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.469em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.43em, 1000.46em, 2.458em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-683"><span class="mi" id="MathJax-Span-684" style="font-family: MathJax_Math; font-style: italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.074em; border-left: 0px solid; width: 0px; height: 0.983em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-105">\theta</script>(<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-106-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B8;</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-685" style="width: 0.576em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.469em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.43em, 1000.46em, 2.458em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-686"><span class="mi" id="MathJax-Span-687" style="font-family: MathJax_Math; font-style: italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.074em; border-left: 0px solid; width: 0px; height: 0.983em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-106">\theta</script>包括<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-107-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>W</mtext></mrow><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>c</mtext></mrow><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>b</mtext></mrow></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-688" style="width: 3.909em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.229em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.389em, 1003.19em, 2.59em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-689"><span class="texatom" id="MathJax-Span-690"><span class="mrow" id="MathJax-Span-691"><span class="mtext" id="MathJax-Span-692" style="font-family: MathJax_Main; font-weight: bold;">W</span></span></span><span class="mo" id="MathJax-Span-693" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-694" style="padding-left: 0.167em;"><span class="mrow" id="MathJax-Span-695"><span class="mtext" id="MathJax-Span-696" style="font-family: MathJax_Main; font-weight: bold;">c</span></span></span><span class="mo" id="MathJax-Span-697" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-698" style="padding-left: 0.167em;"><span class="mrow" id="MathJax-Span-699"><span class="mtext" id="MathJax-Span-700" style="font-family: MathJax_Main; font-weight: bold;">b</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.295em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">W</mtext></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">c</mtext></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">b</mtext></mrow></math></span></span><script type="math/tex" id="MathJax-Element-107">\textbf{W},\textbf{c},\textbf{b}</script>)，目标函数是<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-108-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-701" style="width: 2.607em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.135em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.385em, 1002.04em, 2.698em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-702"><span class="mi" id="MathJax-Span-703" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span class="mo" id="MathJax-Span-704" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-705"><span class="mrow" id="MathJax-Span-706"><span class="mtext" id="MathJax-Span-707" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-708" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.362em; border-left: 0px solid; width: 0px; height: 1.325em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-108">P(\textbf{x})</script>（这里是梯度上升，因为要求的是似然的极大值）。<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-109-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-709" style="width: 2.607em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.135em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.385em, 1002.04em, 2.698em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-710"><span class="mi" id="MathJax-Span-711" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span class="mo" id="MathJax-Span-712" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-713"><span class="mrow" id="MathJax-Span-714"><span class="mtext" id="MathJax-Span-715" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-716" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.362em; border-left: 0px solid; width: 0px; height: 1.325em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-109">P(\textbf{x})</script>取对数求偏导： <br>
<span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"></div><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-110-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>l</mi><mi>o</mi><mi>g</mi><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mo>&amp;#x2212;</mo><mi>F</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>E</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>y</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mi>l</mi><mi>o</mi><mi>g</mi><mi>Z</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-717" style="width: 18.596em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.469em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.385em, 1015.47em, 2.698em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-718"><span class="mi" id="MathJax-Span-719" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-720" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-721" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-722" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span class="mo" id="MathJax-Span-723" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-724"><span class="mrow" id="MathJax-Span-725"><span class="mtext" id="MathJax-Span-726" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-727" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-728" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-729" style="font-family: MathJax_Main; padding-left: 0.278em;">−</span><span class="mi" id="MathJax-Span-730" style="font-family: MathJax_Math; font-style: italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mi" id="MathJax-Span-731" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-732" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-733" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-734" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mi" id="MathJax-Span-735" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-736" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-737" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-738" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-739" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-740" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-741"><span class="mrow" id="MathJax-Span-742"><span class="mtext" id="MathJax-Span-743" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-744" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-745" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-746" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">l</span><span class="mi" id="MathJax-Span-747" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-748" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-749" style="font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.362em; border-left: 0px solid; width: 0px; height: 1.325em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>l</mi><mi>o</mi><mi>g</mi><mi>P</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mi>F</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>E</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>y</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo stretchy="false">)</mo><mo>−</mo><mi>l</mi><mi>o</mi><mi>g</mi><mi>Z</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-110">\begin{equation}
    log P(\textbf{x}) = -FreeEnergy(\textbf{x}) - log Z
\end{equation}</script> <br>
对数似然梯度（log-likelihood gradient）： <br>
<span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"></div><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-111-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtable columnalign=&quot;right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em&quot; displaystyle=&quot;true&quot;><mtr><mtd /><mtd><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>&amp;#x03B8;</mi></mrow></mfrac><mo>=</mo><mo>&amp;#x2212;</mo><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>F</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>E</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>y</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>&amp;#x03B8;</mi></mrow></mfrac><mo>+</mo><mfrac><mn>1</mn><mi>Z</mi></mfrac><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo stretchy=&quot;false&quot;>&amp;#x007E;</mo></mover></mrow></mrow></munder><msup><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x2212;</mo><mi>F</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>E</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>y</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo stretchy=&quot;false&quot;>&amp;#x007E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>F</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>E</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>y</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo stretchy=&quot;false&quot;>&amp;#x007E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>&amp;#x03B8;</mi></mrow></mfrac></mtd></mtr><mtr><mtd /><mtd><mi></mi><mspace width=&quot;thickmathspace&quot; /><mspace width=&quot;thickmathspace&quot; /><mspace width=&quot;thickmathspace&quot; /><mspace width=&quot;thickmathspace&quot; /><mo>=</mo><mo>&amp;#x2212;</mo><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>F</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>E</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>y</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>&amp;#x03B8;</mi></mrow></mfrac><mo>+</mo><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo stretchy=&quot;false&quot;>&amp;#x007E;</mo></mover></mrow></mrow></munder><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo stretchy=&quot;false&quot;>&amp;#x007E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>)</mo><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>F</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>E</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>y</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo stretchy=&quot;false&quot;>&amp;#x007E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>&amp;#x03B8;</mi></mrow></mfrac></mtd></mtr></mtable></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-750" style="width: 38.596em; display: inline-block;"><span style="display: inline-block; position: relative; width: 32.135em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(-1.189em, 1031.97em, 5.064em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-751"><span class="mtable" id="MathJax-Span-752" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 31.801em; height: 0px;"><span style="position: absolute; clip: rect(2.208em, 1000em, 5.641em, -1000em); top: -4.115em; left: 0em;"><span style="display: inline-block; position: relative; width: 0em; height: 0px;"><span style="position: absolute; clip: rect(3.854em, 1000em, 4.167em, -1000em); top: -5.761em; right: 0em;"><span class="mtd" id="MathJax-Span-753"><span class="mrow" id="MathJax-Span-754"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.854em, 1000em, 4.167em, -1000em); top: -2.64em; right: 0em;"><span class="mtd" id="MathJax-Span-859"><span class="mrow" id="MathJax-Span-860"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.115em;"></span></span><span style="position: absolute; clip: rect(3.55em, 1031.8em, 9.804em, -1000em); top: -6.927em; left: 0em;"><span style="display: inline-block; position: relative; width: 31.801em; height: 0px;"><span style="position: absolute; clip: rect(2.384em, 1031.8em, 5.517em, -1000em); top: -5.761em; left: 0em;"><span class="mtd" id="MathJax-Span-755"><span class="mrow" id="MathJax-Span-756"><span class="mfrac" id="MathJax-Span-757"><span style="display: inline-block; position: relative; width: 4.085em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.104em, 1003.87em, 4.417em, -1000em); top: -4.731em; left: 50%; margin-left: -1.982em;"><span class="mrow" id="MathJax-Span-758"><span class="mi" id="MathJax-Span-759" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.035em;"></span></span><span class="mi" id="MathJax-Span-760" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-761" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-762" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-763" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span class="mo" id="MathJax-Span-764" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-765"><span class="mrow" id="MathJax-Span-766"><span class="mtext" id="MathJax-Span-767" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-768" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.139em, 1001.03em, 4.189em, -1000em); top: -3.324em; left: 50%; margin-left: -0.517em;"><span class="mrow" id="MathJax-Span-769"><span class="mi" id="MathJax-Span-770" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.035em;"></span></span><span class="mi" id="MathJax-Span-771" style="font-family: MathJax_Math; font-style: italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1004.09em, 1.198em, -1000em); top: -1.262em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.085em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span><span class="mo" id="MathJax-Span-772" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-773" style="font-family: MathJax_Main; padding-left: 0.278em;">−</span><span class="mfrac" id="MathJax-Span-774"><span style="display: inline-block; position: relative; width: 7.46em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.104em, 1007.25em, 4.417em, -1000em); top: -4.731em; left: 50%; margin-left: -3.67em;"><span class="mrow" id="MathJax-Span-775"><span class="mi" id="MathJax-Span-776" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.035em;"></span></span><span class="mi" id="MathJax-Span-777" style="font-family: MathJax_Math; font-style: italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mi" id="MathJax-Span-778" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-779" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-780" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-781" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mi" id="MathJax-Span-782" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-783" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-784" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-785" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-786" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-787" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-788"><span class="mrow" id="MathJax-Span-789"><span class="mtext" id="MathJax-Span-790" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-791" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.139em, 1001.03em, 4.189em, -1000em); top: -3.324em; left: 50%; margin-left: -0.517em;"><span class="mrow" id="MathJax-Span-792"><span class="mi" id="MathJax-Span-793" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.035em;"></span></span><span class="mi" id="MathJax-Span-794" style="font-family: MathJax_Math; font-style: italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1007.46em, 1.198em, -1000em); top: -1.262em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 7.46em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span><span class="mo" id="MathJax-Span-795" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mfrac" id="MathJax-Span-796" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.843em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.188em, 1000.43em, 4.167em, -1000em); top: -4.687em; left: 50%; margin-left: -0.25em;"><span class="mn" id="MathJax-Span-797" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.171em, 1000.72em, 4.167em, -1000em); top: -3.324em; left: 50%; margin-left: -0.361em;"><span class="mi" id="MathJax-Span-798" style="font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1000.84em, 1.198em, -1000em); top: -1.262em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.843em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span><span class="munderover" id="MathJax-Span-799" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.444em; height: 0px;"><span style="position: absolute; clip: rect(2.904em, 1001.39em, 4.617em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-800" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.221em, 1000.41em, 4.267em, -1000em); top: -2.76em; left: 0.507em;"><span class="texatom" id="MathJax-Span-801"><span class="mrow" id="MathJax-Span-802"><span class="texatom" id="MathJax-Span-803"><span class="mrow" id="MathJax-Span-804"><span class="munderover" id="MathJax-Span-805"><span style="display: inline-block; position: relative; width: 0.429em; height: 0px;"><span style="position: absolute; clip: rect(3.424em, 1000.41em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-806"><span class="mrow" id="MathJax-Span-807"><span class="mtext" id="MathJax-Span-808" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.629em, 1000.29em, 4.015em, -1000em); top: -4.419em; left: 0.038em;"><span class="mo" id="MathJax-Span-809" style="font-size: 70.7%; font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-810" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 5.881em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-811" style="font-family: MathJax_Math; font-style: italic;">e</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.423em; left: 0.466em;"><span class="texatom" id="MathJax-Span-812"><span class="mrow" id="MathJax-Span-813"><span class="mo" id="MathJax-Span-814" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-815" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.075em;"></span></span><span class="mi" id="MathJax-Span-816" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-817" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-818" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-819" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.018em;"></span></span><span class="mi" id="MathJax-Span-820" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-821" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-822" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-823" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-824" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span><span class="mo" id="MathJax-Span-825" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-826"><span class="mrow" id="MathJax-Span-827"><span class="munderover" id="MathJax-Span-828"><span style="display: inline-block; position: relative; width: 0.429em; height: 0px;"><span style="position: absolute; clip: rect(3.424em, 1000.41em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-829"><span class="mrow" id="MathJax-Span-830"><span class="mtext" id="MathJax-Span-831" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.629em, 1000.29em, 4.015em, -1000em); top: -4.419em; left: 0.038em;"><span class="mo" id="MathJax-Span-832" style="font-size: 70.7%; font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-833" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-834"><span style="display: inline-block; position: relative; width: 7.46em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.104em, 1007.25em, 4.417em, -1000em); top: -4.731em; left: 50%; margin-left: -3.67em;"><span class="mrow" id="MathJax-Span-835"><span class="mi" id="MathJax-Span-836" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.035em;"></span></span><span class="mi" id="MathJax-Span-837" style="font-family: MathJax_Math; font-style: italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mi" id="MathJax-Span-838" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-839" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-840" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-841" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mi" id="MathJax-Span-842" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-843" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-844" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-845" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-846" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-847" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-848"><span class="mrow" id="MathJax-Span-849"><span class="munderover" id="MathJax-Span-850"><span style="display: inline-block; position: relative; width: 0.607em; height: 0px;"><span style="position: absolute; clip: rect(3.41em, 1000.59em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-851"><span class="mrow" id="MathJax-Span-852"><span class="mtext" id="MathJax-Span-853" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.536em, 1000.42em, 3.952em, -1000em); top: -4.37em; left: 0.053em;"><span class="mo" id="MathJax-Span-854" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-855" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.139em, 1001.03em, 4.189em, -1000em); top: -3.324em; left: 50%; margin-left: -0.517em;"><span class="mrow" id="MathJax-Span-856"><span class="mi" id="MathJax-Span-857" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.035em;"></span></span><span class="mi" id="MathJax-Span-858" style="font-family: MathJax_Math; font-style: italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1007.46em, 1.198em, -1000em); top: -1.262em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 7.46em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(2.384em, 1023.59em, 5.517em, -1000em); top: -2.64em; left: 0em;"><span class="mtd" id="MathJax-Span-861"><span class="mrow" id="MathJax-Span-862"><span class="mi" id="MathJax-Span-863"></span><span class="mspace" id="MathJax-Span-864" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-865" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-866" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-867" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-868" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-869" style="font-family: MathJax_Main; padding-left: 0.278em;">−</span><span class="mfrac" id="MathJax-Span-870"><span style="display: inline-block; position: relative; width: 7.46em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.104em, 1007.25em, 4.417em, -1000em); top: -4.731em; left: 50%; margin-left: -3.67em;"><span class="mrow" id="MathJax-Span-871"><span class="mi" id="MathJax-Span-872" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.035em;"></span></span><span class="mi" id="MathJax-Span-873" style="font-family: MathJax_Math; font-style: italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mi" id="MathJax-Span-874" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-875" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-876" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-877" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mi" id="MathJax-Span-878" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-879" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-880" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-881" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-882" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-883" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-884"><span class="mrow" id="MathJax-Span-885"><span class="mtext" id="MathJax-Span-886" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-887" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.139em, 1001.03em, 4.189em, -1000em); top: -3.324em; left: 50%; margin-left: -0.517em;"><span class="mrow" id="MathJax-Span-888"><span class="mi" id="MathJax-Span-889" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.035em;"></span></span><span class="mi" id="MathJax-Span-890" style="font-family: MathJax_Math; font-style: italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1007.46em, 1.198em, -1000em); top: -1.262em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 7.46em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span><span class="mo" id="MathJax-Span-891" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="munderover" id="MathJax-Span-892" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.444em; height: 0px;"><span style="position: absolute; clip: rect(2.904em, 1001.39em, 4.617em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-893" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.221em, 1000.41em, 4.267em, -1000em); top: -2.76em; left: 0.507em;"><span class="texatom" id="MathJax-Span-894"><span class="mrow" id="MathJax-Span-895"><span class="texatom" id="MathJax-Span-896"><span class="mrow" id="MathJax-Span-897"><span class="munderover" id="MathJax-Span-898"><span style="display: inline-block; position: relative; width: 0.429em; height: 0px;"><span style="position: absolute; clip: rect(3.424em, 1000.41em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-899"><span class="mrow" id="MathJax-Span-900"><span class="mtext" id="MathJax-Span-901" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.629em, 1000.29em, 4.015em, -1000em); top: -4.419em; left: 0.038em;"><span class="mo" id="MathJax-Span-902" style="font-size: 70.7%; font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mi" id="MathJax-Span-903" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span class="mo" id="MathJax-Span-904" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-905"><span class="mrow" id="MathJax-Span-906"><span class="munderover" id="MathJax-Span-907"><span style="display: inline-block; position: relative; width: 0.607em; height: 0px;"><span style="position: absolute; clip: rect(3.41em, 1000.59em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-908"><span class="mrow" id="MathJax-Span-909"><span class="mtext" id="MathJax-Span-910" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.536em, 1000.42em, 3.952em, -1000em); top: -4.37em; left: 0.053em;"><span class="mo" id="MathJax-Span-911" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-912" style="font-family: MathJax_Main;">)</span><span class="mfrac" id="MathJax-Span-913"><span style="display: inline-block; position: relative; width: 7.46em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.104em, 1007.25em, 4.417em, -1000em); top: -4.731em; left: 50%; margin-left: -3.67em;"><span class="mrow" id="MathJax-Span-914"><span class="mi" id="MathJax-Span-915" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.035em;"></span></span><span class="mi" id="MathJax-Span-916" style="font-family: MathJax_Math; font-style: italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mi" id="MathJax-Span-917" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-918" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-919" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-920" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mi" id="MathJax-Span-921" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-922" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-923" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-924" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-925" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-926" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-927"><span class="mrow" id="MathJax-Span-928"><span class="munderover" id="MathJax-Span-929"><span style="display: inline-block; position: relative; width: 0.607em; height: 0px;"><span style="position: absolute; clip: rect(3.41em, 1000.59em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-930"><span class="mrow" id="MathJax-Span-931"><span class="mtext" id="MathJax-Span-932" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.536em, 1000.42em, 3.952em, -1000em); top: -4.37em; left: 0.053em;"><span class="mo" id="MathJax-Span-933" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-934" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.139em, 1001.03em, 4.189em, -1000em); top: -3.324em; left: 50%; margin-left: -0.517em;"><span class="mrow" id="MathJax-Span-935"><span class="mi" id="MathJax-Span-936" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.035em;"></span></span><span class="mi" id="MathJax-Span-937" style="font-family: MathJax_Math; font-style: italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1007.46em, 1.198em, -1000em); top: -1.262em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 7.46em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.927em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -3.327em; border-left: 0px solid; width: 0px; height: 7.254em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left" rowspacing="3pt" columnspacing="0em" displaystyle="true"><mtr><mtd></mtd><mtd><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>P</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac><mo>=</mo><mo>−</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>F</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>E</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>y</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac><mo>+</mo><mfrac><mn>1</mn><mi>Z</mi></mfrac><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mover><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo stretchy="false">~</mo></mover></mrow></mrow></munder><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mi>F</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>E</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>y</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mover><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo stretchy="false">~</mo></mover></mrow><mo stretchy="false">)</mo></mrow></msup><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>F</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>E</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>y</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mover><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo stretchy="false">~</mo></mover></mrow><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mspace width="thickmathspace"></mspace><mspace width="thickmathspace"></mspace><mspace width="thickmathspace"></mspace><mspace width="thickmathspace"></mspace><mo>=</mo><mo>−</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>F</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>E</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>y</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac><mo>+</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mover><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo stretchy="false">~</mo></mover></mrow></mrow></munder><mi>P</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mover><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo stretchy="false">~</mo></mover></mrow><mo stretchy="false">)</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>F</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>E</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>y</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mover><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo stretchy="false">~</mo></mover></mrow><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-111">\begin{equation}
    \begin{split}
    &\frac{\partial log P(\textbf{x})}{\partial \theta} = - \frac{\partial FreeEnergy(\textbf{x})}{\partial \theta} + \frac{1}{Z} \sum_{\tilde{\textbf{x}}} e^{-FreeEnergy(\tilde{\textbf{x}})} \frac{\partial FreeEnergy(\tilde{\textbf{x}})}{\partial \theta}\\
    &\;\;\;\;= - \frac{\partial FreeEnergy(\textbf{x})}{\partial \theta} + \sum_{\tilde{\textbf{x}}} P(\tilde{\textbf{x}}) \frac{\partial FreeEnergy(\tilde{\textbf{x}})}{\partial \theta}\\
    \end{split}
\end{equation}</script> <br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-112-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>&amp;#x03B8;</mi></mrow></mfrac></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-938" style="width: 3.857em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.177em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.916em, 1003.18em, 2.773em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-939"><span class="mfrac" id="MathJax-Span-940"><span style="display: inline-block; position: relative; width: 2.924em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.324em, 1002.74em, 4.343em, -1000em); top: -4.595em; left: 50%; margin-left: -1.402em;"><span class="mrow" id="MathJax-Span-941"><span class="mi" id="MathJax-Span-942" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span class="mi" id="MathJax-Span-943" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-944" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-945" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-946" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mo" id="MathJax-Span-947" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-948"><span class="mrow" id="MathJax-Span-949"><span class="mtext" id="MathJax-Span-950" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-951" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.349em, 1000.73em, 4.182em, -1000em); top: -3.597em; left: 50%; margin-left: -0.366em;"><span class="mrow" id="MathJax-Span-952"><span class="mi" id="MathJax-Span-953" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span class="mi" id="MathJax-Span-954" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1002.92em, 1.198em, -1000em); top: -1.262em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.924em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.577em; border-left: 0px solid; width: 0px; height: 1.977em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>P</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-112">\frac{\partial log P(\textbf{x})}{\partial \theta}</script> 是对 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-113-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>W</mtext></mrow></mrow></mfrac><mo>,</mo><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>c</mtext></mrow></mrow></mfrac><mo>,</mo><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>b</mtext></mrow></mrow></mfrac></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-955" style="width: 12.451em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.365em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.969em, 1010.37em, 2.825em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-956"><span class="mfrac" id="MathJax-Span-957"><span style="display: inline-block; position: relative; width: 2.924em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.324em, 1002.74em, 4.343em, -1000em); top: -4.595em; left: 50%; margin-left: -1.402em;"><span class="mrow" id="MathJax-Span-958"><span class="mi" id="MathJax-Span-959" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span class="mi" id="MathJax-Span-960" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-961" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-962" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-963" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mo" id="MathJax-Span-964" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-965"><span class="mrow" id="MathJax-Span-966"><span class="mtext" id="MathJax-Span-967" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-968" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.349em, 1001.22em, 4.182em, -1000em); top: -3.597em; left: 50%; margin-left: -0.62em;"><span class="mrow" id="MathJax-Span-969"><span class="mi" id="MathJax-Span-970" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span class="texatom" id="MathJax-Span-971"><span class="mrow" id="MathJax-Span-972"><span class="mtext" id="MathJax-Span-973" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">W</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1002.92em, 1.198em, -1000em); top: -1.262em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.924em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span><span class="mo" id="MathJax-Span-974" style="font-family: MathJax_Main;">,</span><span class="mfrac" id="MathJax-Span-975" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 2.924em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.324em, 1002.74em, 4.343em, -1000em); top: -4.595em; left: 50%; margin-left: -1.402em;"><span class="mrow" id="MathJax-Span-976"><span class="mi" id="MathJax-Span-977" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span class="mi" id="MathJax-Span-978" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-979" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-980" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-981" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mo" id="MathJax-Span-982" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-983"><span class="mrow" id="MathJax-Span-984"><span class="mtext" id="MathJax-Span-985" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-986" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.349em, 1000.74em, 4.182em, -1000em); top: -3.597em; left: 50%; margin-left: -0.381em;"><span class="mrow" id="MathJax-Span-987"><span class="mi" id="MathJax-Span-988" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span class="texatom" id="MathJax-Span-989"><span class="mrow" id="MathJax-Span-990"><span class="mtext" id="MathJax-Span-991" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">c</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1002.92em, 1.198em, -1000em); top: -1.262em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.924em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span><span class="mo" id="MathJax-Span-992" style="font-family: MathJax_Main;">,</span><span class="mfrac" id="MathJax-Span-993" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 2.924em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.324em, 1002.74em, 4.343em, -1000em); top: -4.595em; left: 50%; margin-left: -1.402em;"><span class="mrow" id="MathJax-Span-994"><span class="mi" id="MathJax-Span-995" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span class="mi" id="MathJax-Span-996" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-997" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-998" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-999" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mo" id="MathJax-Span-1000" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-1001"><span class="mrow" id="MathJax-Span-1002"><span class="mtext" id="MathJax-Span-1003" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1004" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.349em, 1000.82em, 4.182em, -1000em); top: -3.597em; left: 50%; margin-left: -0.426em;"><span class="mrow" id="MathJax-Span-1005"><span class="mi" id="MathJax-Span-1006" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span class="texatom" id="MathJax-Span-1007"><span class="mrow" id="MathJax-Span-1008"><span class="mtext" id="MathJax-Span-1009" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">b</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1002.92em, 1.198em, -1000em); top: -1.262em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.924em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.577em; border-left: 0px solid; width: 0px; height: 1.977em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>P</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">W</mtext></mrow></mrow></mfrac><mo>,</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>P</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">c</mtext></mrow></mrow></mfrac><mo>,</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>P</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">b</mtext></mrow></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-113">\frac{\partial log P(\textbf{x})}{\partial \textbf{W}}, \frac{\partial log P(\textbf{x})}{\partial \textbf{c}}, \frac{\partial log P(\textbf{x})}{\partial \textbf{b}} </script> 的统一表示，编写代码时需要分别求偏导。求偏导都没有太大难度，其中<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-114-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>E</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>W</mtext></mrow></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mo>&amp;#x2212;</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>W</mtext></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>W</mtext></mrow></mrow></mfrac><mo>=</mo><mo>&amp;#x2212;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></msup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1010" style="width: 14.065em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.719em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.969em, 1011.72em, 2.825em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-1011"><span class="mfrac" id="MathJax-Span-1012"><span style="display: inline-block; position: relative; width: 2.688em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.324em, 1002.5em, 4.343em, -1000em); top: -4.595em; left: 50%; margin-left: -1.284em;"><span class="mrow" id="MathJax-Span-1013"><span class="mi" id="MathJax-Span-1014" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span class="mi" id="MathJax-Span-1015" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.018em;"></span></span><span class="mo" id="MathJax-Span-1016" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-1017"><span class="mrow" id="MathJax-Span-1018"><span class="mtext" id="MathJax-Span-1019" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1020" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-1021"><span class="mrow" id="MathJax-Span-1022"><span class="mtext" id="MathJax-Span-1023" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span class="mo" id="MathJax-Span-1024" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.349em, 1001.22em, 4.182em, -1000em); top: -3.597em; left: 50%; margin-left: -0.62em;"><span class="mrow" id="MathJax-Span-1025"><span class="mi" id="MathJax-Span-1026" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span class="texatom" id="MathJax-Span-1027"><span class="mrow" id="MathJax-Span-1028"><span class="mtext" id="MathJax-Span-1029" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">W</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1002.69em, 1.198em, -1000em); top: -1.262em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.688em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span><span class="mo" id="MathJax-Span-1030" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mfrac" id="MathJax-Span-1031" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 3.234em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.222em, 1003.1em, 4.225em, -1000em); top: -4.476em; left: 50%; margin-left: -1.557em;"><span class="mrow" id="MathJax-Span-1032"><span class="mi" id="MathJax-Span-1033" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span class="mo" id="MathJax-Span-1034" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-1035"><span style="display: inline-block; position: relative; width: 0.894em; height: 0px;"><span style="position: absolute; clip: rect(3.363em, 1000.44em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-1036"><span class="mrow" id="MathJax-Span-1037"><span class="mtext" id="MathJax-Span-1038" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.308em; left: 0.452em;"><span class="mi" id="MathJax-Span-1039" style="font-size: 50%; font-family: MathJax_Main;">⊤</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1040"><span class="mrow" id="MathJax-Span-1041"><span class="mtext" id="MathJax-Span-1042" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">W</span></span></span><span class="texatom" id="MathJax-Span-1043"><span class="mrow" id="MathJax-Span-1044"><span class="mtext" id="MathJax-Span-1045" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.349em, 1001.22em, 4.182em, -1000em); top: -3.597em; left: 50%; margin-left: -0.62em;"><span class="mrow" id="MathJax-Span-1046"><span class="mi" id="MathJax-Span-1047" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span class="texatom" id="MathJax-Span-1048"><span class="mrow" id="MathJax-Span-1049"><span class="mtext" id="MathJax-Span-1050" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">W</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1003.23em, 1.198em, -1000em); top: -1.262em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.234em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span><span class="mo" id="MathJax-Span-1051" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-1052" style="font-family: MathJax_Main; padding-left: 0.278em;">−</span><span class="texatom" id="MathJax-Span-1053"><span class="mrow" id="MathJax-Span-1054"><span class="mtext" id="MathJax-Span-1055" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span class="msubsup" id="MathJax-Span-1056"><span style="display: inline-block; position: relative; width: 1.232em; height: 0px;"><span style="position: absolute; clip: rect(3.41em, 1000.59em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-1057"><span class="mrow" id="MathJax-Span-1058"><span class="mtext" id="MathJax-Span-1059" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.607em;"><span class="mi" id="MathJax-Span-1060" style="font-size: 70.7%; font-family: MathJax_Main;">⊤</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.577em; border-left: 0px solid; width: 0px; height: 1.977em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>E</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">W</mtext></mrow></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mo>−</mo><msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><mi mathvariant="normal">⊤</mi></msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">W</mtext></mrow><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow></mrow><mrow><mi mathvariant="normal">∂</mi><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">W</mtext></mrow></mrow></mfrac><mo>=</mo><mo>−</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mi mathvariant="normal">⊤</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-114">\frac{\partial E(\textbf{x}, \textbf{h})}{\partial \textbf{W}} = \frac{\partial -\textbf{h}^\top \textbf{W} \textbf{x}}{\partial \textbf{W}} = -\textbf{h}\textbf{x}^\top</script>。<p></p>

<p>&nbsp;  &nbsp; &nbsp; &nbsp;  很多文章里喜欢写成负对数似然梯度（negative log-likelihood gradient）的形式，<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-115-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo>&amp;#x2212;</mo><mi>l</mi><mi>o</mi><mi>g</mi><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1061" style="width: 5.003em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.167em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.385em, 1004.07em, 2.698em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-1062"><span class="mo" id="MathJax-Span-1063" style="font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-1064" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-1065" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-1066" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1067" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span class="mo" id="MathJax-Span-1068" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-1069"><span class="mrow" id="MathJax-Span-1070"><span class="mtext" id="MathJax-Span-1071" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1072" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.362em; border-left: 0px solid; width: 0px; height: 1.325em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>−</mo><mi>l</mi><mi>o</mi><mi>g</mi><mi>P</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-115">-log P(\textbf{x})</script>就应该用梯度下降方法来更新参数了： <br>
<span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"></div><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-116-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mo>&amp;#x2212;</mo><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>&amp;#x03B8;</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>F</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>E</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>y</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>&amp;#x03B8;</mi></mrow></mfrac><mo>&amp;#x2212;</mo><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo stretchy=&quot;false&quot;>&amp;#x007E;</mo></mover></mrow></mrow></munder><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo stretchy=&quot;false&quot;>&amp;#x007E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>)</mo><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>F</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>E</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>y</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo stretchy=&quot;false&quot;>&amp;#x007E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>&amp;#x03B8;</mi></mrow></mfrac></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1073" style="width: 32.19em; display: inline-block;"><span style="display: inline-block; position: relative; width: 26.823em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.665em, 1026.82em, 3.798em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-1074"><span class="mo" id="MathJax-Span-1075" style="font-family: MathJax_Main;">−</span><span class="mfrac" id="MathJax-Span-1076"><span style="display: inline-block; position: relative; width: 4.085em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.104em, 1003.87em, 4.417em, -1000em); top: -4.731em; left: 50%; margin-left: -1.982em;"><span class="mrow" id="MathJax-Span-1077"><span class="mi" id="MathJax-Span-1078" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.035em;"></span></span><span class="mi" id="MathJax-Span-1079" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-1080" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-1081" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1082" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span class="mo" id="MathJax-Span-1083" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-1084"><span class="mrow" id="MathJax-Span-1085"><span class="mtext" id="MathJax-Span-1086" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1087" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.139em, 1001.03em, 4.189em, -1000em); top: -3.324em; left: 50%; margin-left: -0.517em;"><span class="mrow" id="MathJax-Span-1088"><span class="mi" id="MathJax-Span-1089" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.035em;"></span></span><span class="mi" id="MathJax-Span-1090" style="font-family: MathJax_Math; font-style: italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1004.09em, 1.198em, -1000em); top: -1.262em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.085em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span><span class="mo" id="MathJax-Span-1091" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mfrac" id="MathJax-Span-1092" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 7.46em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.104em, 1007.25em, 4.417em, -1000em); top: -4.731em; left: 50%; margin-left: -3.67em;"><span class="mrow" id="MathJax-Span-1093"><span class="mi" id="MathJax-Span-1094" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.035em;"></span></span><span class="mi" id="MathJax-Span-1095" style="font-family: MathJax_Math; font-style: italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mi" id="MathJax-Span-1096" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-1097" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-1098" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-1099" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mi" id="MathJax-Span-1100" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-1101" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-1102" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-1103" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1104" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-1105" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-1106"><span class="mrow" id="MathJax-Span-1107"><span class="mtext" id="MathJax-Span-1108" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1109" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.139em, 1001.03em, 4.189em, -1000em); top: -3.324em; left: 50%; margin-left: -0.517em;"><span class="mrow" id="MathJax-Span-1110"><span class="mi" id="MathJax-Span-1111" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.035em;"></span></span><span class="mi" id="MathJax-Span-1112" style="font-family: MathJax_Math; font-style: italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1007.46em, 1.198em, -1000em); top: -1.262em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 7.46em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span><span class="mo" id="MathJax-Span-1113" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="munderover" id="MathJax-Span-1114" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.444em; height: 0px;"><span style="position: absolute; clip: rect(2.904em, 1001.39em, 4.617em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-1115" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.221em, 1000.41em, 4.267em, -1000em); top: -2.76em; left: 0.507em;"><span class="texatom" id="MathJax-Span-1116"><span class="mrow" id="MathJax-Span-1117"><span class="texatom" id="MathJax-Span-1118"><span class="mrow" id="MathJax-Span-1119"><span class="munderover" id="MathJax-Span-1120"><span style="display: inline-block; position: relative; width: 0.429em; height: 0px;"><span style="position: absolute; clip: rect(3.424em, 1000.41em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-1121"><span class="mrow" id="MathJax-Span-1122"><span class="mtext" id="MathJax-Span-1123" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.629em, 1000.29em, 4.015em, -1000em); top: -4.419em; left: 0.038em;"><span class="mo" id="MathJax-Span-1124" style="font-size: 70.7%; font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mi" id="MathJax-Span-1125" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span class="mo" id="MathJax-Span-1126" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-1127"><span class="mrow" id="MathJax-Span-1128"><span class="munderover" id="MathJax-Span-1129"><span style="display: inline-block; position: relative; width: 0.607em; height: 0px;"><span style="position: absolute; clip: rect(3.41em, 1000.59em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-1130"><span class="mrow" id="MathJax-Span-1131"><span class="mtext" id="MathJax-Span-1132" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.536em, 1000.42em, 3.952em, -1000em); top: -4.37em; left: 0.053em;"><span class="mo" id="MathJax-Span-1133" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-1134" style="font-family: MathJax_Main;">)</span><span class="mfrac" id="MathJax-Span-1135"><span style="display: inline-block; position: relative; width: 7.46em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.104em, 1007.25em, 4.417em, -1000em); top: -4.731em; left: 50%; margin-left: -3.67em;"><span class="mrow" id="MathJax-Span-1136"><span class="mi" id="MathJax-Span-1137" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.035em;"></span></span><span class="mi" id="MathJax-Span-1138" style="font-family: MathJax_Math; font-style: italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mi" id="MathJax-Span-1139" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-1140" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-1141" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-1142" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mi" id="MathJax-Span-1143" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-1144" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-1145" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-1146" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1147" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-1148" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-1149"><span class="mrow" id="MathJax-Span-1150"><span class="munderover" id="MathJax-Span-1151"><span style="display: inline-block; position: relative; width: 0.607em; height: 0px;"><span style="position: absolute; clip: rect(3.41em, 1000.59em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-1152"><span class="mrow" id="MathJax-Span-1153"><span class="mtext" id="MathJax-Span-1154" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.536em, 1000.42em, 3.952em, -1000em); top: -4.37em; left: 0.053em;"><span class="mo" id="MathJax-Span-1155" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-1156" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.139em, 1001.03em, 4.189em, -1000em); top: -3.324em; left: 50%; margin-left: -0.517em;"><span class="mrow" id="MathJax-Span-1157"><span class="mi" id="MathJax-Span-1158" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.035em;"></span></span><span class="mi" id="MathJax-Span-1159" style="font-family: MathJax_Math; font-style: italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1007.46em, 1.198em, -1000em); top: -1.262em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 7.46em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.683em; border-left: 0px solid; width: 0px; height: 3.51em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo>−</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>P</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>F</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>E</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>y</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac><mo>−</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mover><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo stretchy="false">~</mo></mover></mrow></mrow></munder><mi>P</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mover><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo stretchy="false">~</mo></mover></mrow><mo stretchy="false">)</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>F</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>E</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>y</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mover><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo stretchy="false">~</mo></mover></mrow><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-116">\begin{equation}
    - \frac{\partial log P(\textbf{x})}{\partial \theta} = \frac{\partial FreeEnergy(\textbf{x})}{\partial \theta} - \sum_{\tilde{\textbf{x}}} P(\tilde{\textbf{x}}) \frac{\partial FreeEnergy(\tilde{\textbf{x}})}{\partial \theta}
\end{equation}</script><p></p>

<p>训练集上的平均负对数似然梯度等于： <br>
<span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"></div><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-117-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>E</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>P</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow></mrow></msub><mo stretchy=&quot;false&quot;>[</mo><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mo>&amp;#x2212;</mo><mi>l</mi><mi>o</mi><mi>g</mi><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>&amp;#x03B8;</mi></mrow></mfrac><mo stretchy=&quot;false&quot;>]</mo><mo>=</mo><msub><mi>E</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>P</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow></mrow></msub><mo stretchy=&quot;false&quot;>[</mo><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>F</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>E</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>y</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>&amp;#x03B8;</mi></mrow></mfrac><mo stretchy=&quot;false&quot;>]</mo><mo>&amp;#x2212;</mo><msub><mi>E</mi><mi>P</mi></msub><mo stretchy=&quot;false&quot;>[</mo><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>F</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>E</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>y</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo stretchy=&quot;false&quot;>&amp;#x007E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>&amp;#x03B8;</mi></mrow></mfrac><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1160" style="width: 35.211em; display: inline-block;"><span style="display: inline-block; position: relative; width: 29.323em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.613em, 1029.2em, 3.104em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-1161"><span class="msubsup" id="MathJax-Span-1162"><span style="display: inline-block; position: relative; width: 1.414em; height: 0px;"><span style="position: absolute; clip: rect(3.174em, 1000.76em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-1163" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.626em; left: 0.738em;"><span class="texatom" id="MathJax-Span-1164"><span class="mrow" id="MathJax-Span-1165"><span class="texatom" id="MathJax-Span-1166"><span class="mrow" id="MathJax-Span-1167"><span class="munderover" id="MathJax-Span-1168"><span style="display: inline-block; position: relative; width: 0.601em; height: 0px;"><span style="position: absolute; clip: rect(3.371em, 1000.53em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-1169" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.363em, 1000.27em, 3.791em, -1000em); top: -4.248em; left: 0.247em;"><span class="mo" id="MathJax-Span-1170" style="font-size: 70.7%; font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-1171" style="font-family: MathJax_Main;">[</span><span class="mfrac" id="MathJax-Span-1172"><span style="display: inline-block; position: relative; width: 5.307em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.104em, 1005.09em, 4.417em, -1000em); top: -4.731em; left: 50%; margin-left: -2.594em;"><span class="mrow" id="MathJax-Span-1173"><span class="mi" id="MathJax-Span-1174" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.035em;"></span></span><span class="mo" id="MathJax-Span-1175" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-1176" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">l</span><span class="mi" id="MathJax-Span-1177" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-1178" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1179" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span class="mo" id="MathJax-Span-1180" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-1181"><span class="mrow" id="MathJax-Span-1182"><span class="mtext" id="MathJax-Span-1183" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1184" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.139em, 1001.03em, 4.189em, -1000em); top: -3.324em; left: 50%; margin-left: -0.517em;"><span class="mrow" id="MathJax-Span-1185"><span class="mi" id="MathJax-Span-1186" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.035em;"></span></span><span class="mi" id="MathJax-Span-1187" style="font-family: MathJax_Math; font-style: italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1005.31em, 1.198em, -1000em); top: -1.262em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 5.307em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span><span class="mo" id="MathJax-Span-1188" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-1189" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-1190" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.414em; height: 0px;"><span style="position: absolute; clip: rect(3.174em, 1000.76em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-1191" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.626em; left: 0.738em;"><span class="texatom" id="MathJax-Span-1192"><span class="mrow" id="MathJax-Span-1193"><span class="texatom" id="MathJax-Span-1194"><span class="mrow" id="MathJax-Span-1195"><span class="munderover" id="MathJax-Span-1196"><span style="display: inline-block; position: relative; width: 0.601em; height: 0px;"><span style="position: absolute; clip: rect(3.371em, 1000.53em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-1197" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.363em, 1000.27em, 3.791em, -1000em); top: -4.248em; left: 0.247em;"><span class="mo" id="MathJax-Span-1198" style="font-size: 70.7%; font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-1199" style="font-family: MathJax_Main;">[</span><span class="mfrac" id="MathJax-Span-1200"><span style="display: inline-block; position: relative; width: 7.46em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.104em, 1007.25em, 4.417em, -1000em); top: -4.731em; left: 50%; margin-left: -3.67em;"><span class="mrow" id="MathJax-Span-1201"><span class="mi" id="MathJax-Span-1202" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.035em;"></span></span><span class="mi" id="MathJax-Span-1203" style="font-family: MathJax_Math; font-style: italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mi" id="MathJax-Span-1204" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-1205" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-1206" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-1207" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mi" id="MathJax-Span-1208" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-1209" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-1210" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-1211" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1212" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-1213" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-1214"><span class="mrow" id="MathJax-Span-1215"><span class="mtext" id="MathJax-Span-1216" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1217" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.139em, 1001.03em, 4.189em, -1000em); top: -3.324em; left: 50%; margin-left: -0.517em;"><span class="mrow" id="MathJax-Span-1218"><span class="mi" id="MathJax-Span-1219" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.035em;"></span></span><span class="mi" id="MathJax-Span-1220" style="font-family: MathJax_Math; font-style: italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1007.46em, 1.198em, -1000em); top: -1.262em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 7.46em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span><span class="mo" id="MathJax-Span-1221" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-1222" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-1223" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.344em; height: 0px;"><span style="position: absolute; clip: rect(3.174em, 1000.76em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-1224" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.738em;"><span class="mi" id="MathJax-Span-1225" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-1226" style="font-family: MathJax_Main;">[</span><span class="mfrac" id="MathJax-Span-1227"><span style="display: inline-block; position: relative; width: 7.46em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.104em, 1007.25em, 4.417em, -1000em); top: -4.731em; left: 50%; margin-left: -3.67em;"><span class="mrow" id="MathJax-Span-1228"><span class="mi" id="MathJax-Span-1229" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.035em;"></span></span><span class="mi" id="MathJax-Span-1230" style="font-family: MathJax_Math; font-style: italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mi" id="MathJax-Span-1231" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-1232" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-1233" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-1234" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mi" id="MathJax-Span-1235" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-1236" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-1237" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-1238" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1239" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-1240" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-1241"><span class="mrow" id="MathJax-Span-1242"><span class="munderover" id="MathJax-Span-1243"><span style="display: inline-block; position: relative; width: 0.607em; height: 0px;"><span style="position: absolute; clip: rect(3.41em, 1000.59em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-1244"><span class="mrow" id="MathJax-Span-1245"><span class="mtext" id="MathJax-Span-1246" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.536em, 1000.42em, 3.952em, -1000em); top: -4.37em; left: 0.053em;"><span class="mo" id="MathJax-Span-1247" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-1248" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.139em, 1001.03em, 4.189em, -1000em); top: -3.324em; left: 50%; margin-left: -0.517em;"><span class="mrow" id="MathJax-Span-1249"><span class="mi" id="MathJax-Span-1250" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.035em;"></span></span><span class="mi" id="MathJax-Span-1251" style="font-family: MathJax_Math; font-style: italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1007.46em, 1.198em, -1000em); top: -1.262em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 7.46em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span><span class="mo" id="MathJax-Span-1252" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.912em; border-left: 0px solid; width: 0px; height: 2.739em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>E</mi><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mover><mi>P</mi><mo stretchy="false">^</mo></mover></mrow></mrow></msub><mo stretchy="false">[</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mo>−</mo><mi>l</mi><mi>o</mi><mi>g</mi><mi>P</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac><mo stretchy="false">]</mo><mo>=</mo><msub><mi>E</mi><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mover><mi>P</mi><mo stretchy="false">^</mo></mover></mrow></mrow></msub><mo stretchy="false">[</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>F</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>E</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>y</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac><mo stretchy="false">]</mo><mo>−</mo><msub><mi>E</mi><mi>P</mi></msub><mo stretchy="false">[</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>F</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>E</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>y</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mover><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo stretchy="false">~</mo></mover></mrow><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac><mo stretchy="false">]</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-117">\begin{equation}
    E_{\hat{P}}[\frac{\partial -log P(\textbf{x})}{\partial \theta}] =  E_{\hat{P}}[\frac{\partial FreeEnergy(\textbf{x})}{\partial \theta}] - E_P[\frac{\partial FreeEnergy(\tilde{\textbf{x}})}{\partial \theta}]
\end{equation}</script> <br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-118-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>P</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1253" style="width: 0.94em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.781em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.055em, 1000.73em, 2.344em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-1254"><span class="texatom" id="MathJax-Span-1255"><span class="mrow" id="MathJax-Span-1256"><span class="munderover" id="MathJax-Span-1257"><span style="display: inline-block; position: relative; width: 0.805em; height: 0px;"><span style="position: absolute; clip: rect(3.171em, 1000.75em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-1258" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.16em, 1000.39em, 3.636em, -1000em); top: -4.293em; left: 0.305em;"><span class="mo" id="MathJax-Span-1259" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 1.296em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><mi>P</mi><mo stretchy="false">^</mo></mover></mrow></math></span></span><script type="math/tex" id="MathJax-Element-118">\hat{P}</script>是训练集对应的分布，<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-119-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1260" style="width: 0.888em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.729em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.452em, 1000.73em, 2.448em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-1261"><span class="mi" id="MathJax-Span-1262" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.945em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi></math></span></span><script type="math/tex" id="MathJax-Element-119">P</script>是模型分布，<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-120-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>E</mi><mi>P</mi></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1263" style="width: 1.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.354em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.351em, 1001.35em, 2.494em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-1264"><span class="msubsup" id="MathJax-Span-1265"><span style="display: inline-block; position: relative; width: 1.344em; height: 0px;"><span style="position: absolute; clip: rect(3.174em, 1000.76em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-1266" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.738em;"><span class="mi" id="MathJax-Span-1267" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.242em; border-left: 0px solid; width: 0px; height: 1.121em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>E</mi><mi>P</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-120">E_P</script>表示在模型分布上求期望。（这里顺便解释一下为什么大家都喜欢负对数似然而不是直接最大化似然，其实如果你有一台可以表示任何数值的超级计算机，那么取不取对数真的没什么关系，但是现实中的计算机表示能力有限，N个训练样本似然乘积很小很小，小到计算机都无法表示了，所以最好取log，概率的和不会有这样的问题；另外，在优化理论中，优化问题的标准形式就是最小化某个目标函数，所以最好加个负号，最小化负对数似然）。<p></p>

<blockquote>
  <p>&nbsp;  &nbsp;  <font size="4" color="#0033ff" face="黑体"><strong>式子的第一项称为positive phrase，通过减小对应的FreeEnergy增大训练样本的概率；第二项是negative phrase，作用是增大对应的FreeEnergy来减小模型产生的样本的概率。</strong></font>句话不难理解，因为两项分别是往<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-121-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>F</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>E</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>y</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1268" style="width: 8.158em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.786em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.393em, 1006.69em, 2.75em, -1000em); top: -2.321em; left: 0em;"><span class="mrow" id="MathJax-Span-1269"><span class="mi" id="MathJax-Span-1270" style="font-family: MathJax_Math; font-style: italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mi" id="MathJax-Span-1271" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-1272" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-1273" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-1274" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mi" id="MathJax-Span-1275" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-1276" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-1277" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-1278" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1279" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-1280" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-1281"><span class="mrow" id="MathJax-Span-1282"><span class="mtext" id="MathJax-Span-1283" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1284" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.321em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.371em; border-left: 0px solid; width: 0px; height: 1.343em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>F</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>E</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>y</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-121">FreeEnergy(\textbf{x})</script>的梯度下降和<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-122-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>F</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>E</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>y</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo stretchy=&quot;false&quot;>&amp;#x007E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1285" style="width: 8.158em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.786em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.393em, 1006.69em, 2.75em, -1000em); top: -2.321em; left: 0em;"><span class="mrow" id="MathJax-Span-1286"><span class="mi" id="MathJax-Span-1287" style="font-family: MathJax_Math; font-style: italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mi" id="MathJax-Span-1288" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-1289" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-1290" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-1291" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mi" id="MathJax-Span-1292" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-1293" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-1294" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-1295" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1296" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-1297" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-1298"><span class="mrow" id="MathJax-Span-1299"><span class="munderover" id="MathJax-Span-1300"><span style="display: inline-block; position: relative; width: 0.607em; height: 0px;"><span style="position: absolute; clip: rect(3.366em, 1000.59em, 4.167em, -1000em); top: -3.988em; left: 0em;"><span class="texatom" id="MathJax-Span-1301"><span class="mrow" id="MathJax-Span-1302"><span class="mtext" id="MathJax-Span-1303" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 3.988em;"></span></span><span style="position: absolute; clip: rect(3.492em, 1000.42em, 3.952em, -1000em); top: -4.366em; left: 0.053em;"><span class="mo" id="MathJax-Span-1304" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.988em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-1305" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.321em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.371em; border-left: 0px solid; width: 0px; height: 1.343em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>F</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>E</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>y</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mover><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo stretchy="false">~</mo></mover></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-122">FreeEnergy(\tilde{\textbf{x}})</script>的梯度上升方向改变。这也符合最大似然标准，在训练样本上有较大的似然而在其他样本上概率较小。从分类的角度来看，训练样本是正样本，而模型样本是<font size="4" color="#ff0000" face="黑体"><strong>负样本(Negative samples)</strong></font>。 <br>
  </p><center><img src="https://img-blog.csdn.net/20151207175806917" alt="负样本" title=""></center><p></p>
</blockquote>

<p>&nbsp;  &nbsp;  把训练样本代入求均值即可得到梯度公式的第一项<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-123-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>E</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>P</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow></mrow></msub><mo stretchy=&quot;false&quot;>[</mo><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>F</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>E</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>y</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>&amp;#x03B8;</mi></mrow></mfrac><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1306" style="width: 9.013em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.5em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.969em, 1007.38em, 2.825em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-1307"><span class="msubsup" id="MathJax-Span-1308"><span style="display: inline-block; position: relative; width: 1.414em; height: 0px;"><span style="position: absolute; clip: rect(3.174em, 1000.76em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-1309" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.626em; left: 0.738em;"><span class="texatom" id="MathJax-Span-1310"><span class="mrow" id="MathJax-Span-1311"><span class="texatom" id="MathJax-Span-1312"><span class="mrow" id="MathJax-Span-1313"><span class="munderover" id="MathJax-Span-1314"><span style="display: inline-block; position: relative; width: 0.601em; height: 0px;"><span style="position: absolute; clip: rect(3.371em, 1000.53em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-1315" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.363em, 1000.27em, 3.791em, -1000em); top: -4.248em; left: 0.247em;"><span class="mo" id="MathJax-Span-1316" style="font-size: 70.7%; font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-1317" style="font-family: MathJax_Main;">[</span><span class="mfrac" id="MathJax-Span-1318"><span style="display: inline-block; position: relative; width: 5.31em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.324em, 1005.12em, 4.343em, -1000em); top: -4.595em; left: 50%; margin-left: -2.595em;"><span class="mrow" id="MathJax-Span-1319"><span class="mi" id="MathJax-Span-1320" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span class="mi" id="MathJax-Span-1321" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.075em;"></span></span><span class="mi" id="MathJax-Span-1322" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-1323" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-1324" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-1325" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.018em;"></span></span><span class="mi" id="MathJax-Span-1326" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-1327" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-1328" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-1329" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1330" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span><span class="mo" id="MathJax-Span-1331" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-1332"><span class="mrow" id="MathJax-Span-1333"><span class="mtext" id="MathJax-Span-1334" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1335" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.349em, 1000.73em, 4.182em, -1000em); top: -3.597em; left: 50%; margin-left: -0.366em;"><span class="mrow" id="MathJax-Span-1336"><span class="mi" id="MathJax-Span-1337" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span class="mi" id="MathJax-Span-1338" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1005.31em, 1.198em, -1000em); top: -1.262em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 5.31em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span><span class="mo" id="MathJax-Span-1339" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.577em; border-left: 0px solid; width: 0px; height: 1.977em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>E</mi><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mover><mi>P</mi><mo stretchy="false">^</mo></mover></mrow></mrow></msub><mo stretchy="false">[</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>F</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>E</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>y</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-123"> E_{\hat{P}}[\frac{\partial FreeEnergy(\textbf{x})}{\partial \theta}]</script>的值，第二项<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-124-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>E</mi><mi>P</mi></msub><mo stretchy=&quot;false&quot;>[</mo><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>F</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>E</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>y</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo stretchy=&quot;false&quot;>&amp;#x007E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>&amp;#x03B8;</mi></mrow></mfrac><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1340" style="width: 8.961em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.448em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.865em, 1007.33em, 2.825em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-1341"><span class="msubsup" id="MathJax-Span-1342"><span style="display: inline-block; position: relative; width: 1.344em; height: 0px;"><span style="position: absolute; clip: rect(3.174em, 1000.76em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-1343" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.738em;"><span class="mi" id="MathJax-Span-1344" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-1345" style="font-family: MathJax_Main;">[</span><span class="mfrac" id="MathJax-Span-1346"><span style="display: inline-block; position: relative; width: 5.31em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.221em, 1005.12em, 4.343em, -1000em); top: -4.595em; left: 50%; margin-left: -2.595em;"><span class="mrow" id="MathJax-Span-1347"><span class="mi" id="MathJax-Span-1348" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span class="mi" id="MathJax-Span-1349" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.075em;"></span></span><span class="mi" id="MathJax-Span-1350" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-1351" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-1352" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-1353" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.018em;"></span></span><span class="mi" id="MathJax-Span-1354" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-1355" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-1356" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-1357" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1358" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span><span class="mo" id="MathJax-Span-1359" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-1360"><span class="mrow" id="MathJax-Span-1361"><span class="munderover" id="MathJax-Span-1362"><span style="display: inline-block; position: relative; width: 0.429em; height: 0px;"><span style="position: absolute; clip: rect(3.424em, 1000.41em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-1363"><span class="mrow" id="MathJax-Span-1364"><span class="mtext" id="MathJax-Span-1365" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.629em, 1000.29em, 4.015em, -1000em); top: -4.419em; left: 0.038em;"><span class="mo" id="MathJax-Span-1366" style="font-size: 70.7%; font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-1367" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.349em, 1000.73em, 4.182em, -1000em); top: -3.597em; left: 50%; margin-left: -0.366em;"><span class="mrow" id="MathJax-Span-1368"><span class="mi" id="MathJax-Span-1369" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span class="mi" id="MathJax-Span-1370" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1005.31em, 1.198em, -1000em); top: -1.262em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 5.31em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span><span class="mo" id="MathJax-Span-1371" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.577em; border-left: 0px solid; width: 0px; height: 2.101em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>E</mi><mi>P</mi></msub><mo stretchy="false">[</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>F</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>E</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>y</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mover><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo stretchy="false">~</mo></mover></mrow><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-124">E_P[\frac{\partial FreeEnergy(\tilde{\textbf{x}})}{\partial \theta}]</script>计算模型分布上的期望，这就比较困难了，因为这需要取遍所有可能的<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-125-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1372" style="width: 0.784em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.625em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.639em, 1000.6em, 2.396em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-1373"><span class="texatom" id="MathJax-Span-1374"><span class="mrow" id="MathJax-Span-1375"><span class="mtext" id="MathJax-Span-1376" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.658em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow></math></span></span><script type="math/tex" id="MathJax-Element-125">\textbf{x}</script>的值。所以接下来我们就需要用到MCMC 采样来近似估计了。用MCMC采样得到的一组样本来近似估计整体的样本分布，梯度公式第二项在采样得到的样本上求近似期望（平均值）得到估计值。在实际中，常用Gibbs采样，Gibbs 采样是MCMC 算法的一种。用Gibbs从模型分布中采样n个样本，然后负对数似然梯度在训练集上的期望就可以近似为： <br>
<span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"></div><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-126-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>E</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>P</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow></mrow></msub><mo stretchy=&quot;false&quot;>[</mo><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mo>&amp;#x2212;</mo><mi>l</mi><mi>o</mi><mi>g</mi><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>&amp;#x03B8;</mi></mrow></mfrac><mo stretchy=&quot;false&quot;>]</mo><mo>&amp;#x2248;</mo><msub><mi>E</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>P</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow></mrow></msub><mo stretchy=&quot;false&quot;>[</mo><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>F</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>E</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>y</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>&amp;#x03B8;</mi></mrow></mfrac><mo stretchy=&quot;false&quot;>]</mo><mo>&amp;#x2212;</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mfrac><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>F</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>E</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>y</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mi>i</mi></msub><mo stretchy=&quot;false&quot;>&amp;#x007E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2202;</mi><mi>&amp;#x03B8;</mi></mrow></mfrac></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1377" style="width: 36.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 30.521em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.521em, 1030.52em, 3.591em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-1378"><span class="msubsup" id="MathJax-Span-1379"><span style="display: inline-block; position: relative; width: 1.414em; height: 0px;"><span style="position: absolute; clip: rect(3.174em, 1000.76em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-1380" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.626em; left: 0.738em;"><span class="texatom" id="MathJax-Span-1381"><span class="mrow" id="MathJax-Span-1382"><span class="texatom" id="MathJax-Span-1383"><span class="mrow" id="MathJax-Span-1384"><span class="munderover" id="MathJax-Span-1385"><span style="display: inline-block; position: relative; width: 0.601em; height: 0px;"><span style="position: absolute; clip: rect(3.371em, 1000.53em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-1386" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.363em, 1000.27em, 3.791em, -1000em); top: -4.248em; left: 0.247em;"><span class="mo" id="MathJax-Span-1387" style="font-size: 70.7%; font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-1388" style="font-family: MathJax_Main;">[</span><span class="mfrac" id="MathJax-Span-1389"><span style="display: inline-block; position: relative; width: 5.307em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.104em, 1005.09em, 4.417em, -1000em); top: -4.731em; left: 50%; margin-left: -2.594em;"><span class="mrow" id="MathJax-Span-1390"><span class="mi" id="MathJax-Span-1391" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.035em;"></span></span><span class="mo" id="MathJax-Span-1392" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-1393" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">l</span><span class="mi" id="MathJax-Span-1394" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-1395" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1396" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span class="mo" id="MathJax-Span-1397" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-1398"><span class="mrow" id="MathJax-Span-1399"><span class="mtext" id="MathJax-Span-1400" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1401" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.139em, 1001.03em, 4.189em, -1000em); top: -3.324em; left: 50%; margin-left: -0.517em;"><span class="mrow" id="MathJax-Span-1402"><span class="mi" id="MathJax-Span-1403" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.035em;"></span></span><span class="mi" id="MathJax-Span-1404" style="font-family: MathJax_Math; font-style: italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1005.31em, 1.198em, -1000em); top: -1.262em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 5.307em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span><span class="mo" id="MathJax-Span-1405" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-1406" style="font-family: MathJax_Main; padding-left: 0.278em;">≈</span><span class="msubsup" id="MathJax-Span-1407" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.414em; height: 0px;"><span style="position: absolute; clip: rect(3.174em, 1000.76em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-1408" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.626em; left: 0.738em;"><span class="texatom" id="MathJax-Span-1409"><span class="mrow" id="MathJax-Span-1410"><span class="texatom" id="MathJax-Span-1411"><span class="mrow" id="MathJax-Span-1412"><span class="munderover" id="MathJax-Span-1413"><span style="display: inline-block; position: relative; width: 0.601em; height: 0px;"><span style="position: absolute; clip: rect(3.371em, 1000.53em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-1414" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.363em, 1000.27em, 3.791em, -1000em); top: -4.248em; left: 0.247em;"><span class="mo" id="MathJax-Span-1415" style="font-size: 70.7%; font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-1416" style="font-family: MathJax_Main;">[</span><span class="mfrac" id="MathJax-Span-1417"><span style="display: inline-block; position: relative; width: 7.46em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.104em, 1007.25em, 4.417em, -1000em); top: -4.731em; left: 50%; margin-left: -3.67em;"><span class="mrow" id="MathJax-Span-1418"><span class="mi" id="MathJax-Span-1419" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.035em;"></span></span><span class="mi" id="MathJax-Span-1420" style="font-family: MathJax_Math; font-style: italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mi" id="MathJax-Span-1421" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-1422" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-1423" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-1424" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mi" id="MathJax-Span-1425" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-1426" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-1427" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-1428" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1429" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-1430" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-1431"><span class="mrow" id="MathJax-Span-1432"><span class="mtext" id="MathJax-Span-1433" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1434" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.139em, 1001.03em, 4.189em, -1000em); top: -3.324em; left: 50%; margin-left: -0.517em;"><span class="mrow" id="MathJax-Span-1435"><span class="mi" id="MathJax-Span-1436" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.035em;"></span></span><span class="mi" id="MathJax-Span-1437" style="font-family: MathJax_Math; font-style: italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1007.46em, 1.198em, -1000em); top: -1.262em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 7.46em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span><span class="mo" id="MathJax-Span-1438" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-1439" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mfrac" id="MathJax-Span-1440" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.188em, 1000.43em, 4.167em, -1000em); top: -4.687em; left: 50%; margin-left: -0.25em;"><span class="mn" id="MathJax-Span-1441" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.412em, 1000.58em, 4.178em, -1000em); top: -3.324em; left: 50%; margin-left: -0.3em;"><span class="mi" id="MathJax-Span-1442" style="font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1000.72em, 1.198em, -1000em); top: -1.262em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.72em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1443" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.444em; height: 0px;"><span style="position: absolute; clip: rect(2.904em, 1001.39em, 4.617em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-1444" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.383em, 1001.1em, 4.274em, -1000em); top: -2.923em; left: 0.148em;"><span class="texatom" id="MathJax-Span-1445"><span class="mrow" id="MathJax-Span-1446"><span class="mi" id="MathJax-Span-1447" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-1448" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1449" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.442em, 1000.41em, 4.174em, -1000em); top: -5.16em; left: 0.51em;"><span class="mi" id="MathJax-Span-1450" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-1451" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 7.779em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.104em, 1007.56em, 4.417em, -1000em); top: -4.731em; left: 50%; margin-left: -3.829em;"><span class="mrow" id="MathJax-Span-1452"><span class="mi" id="MathJax-Span-1453" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.035em;"></span></span><span class="mi" id="MathJax-Span-1454" style="font-family: MathJax_Math; font-style: italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mi" id="MathJax-Span-1455" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-1456" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-1457" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-1458" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mi" id="MathJax-Span-1459" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-1460" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-1461" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-1462" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1463" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-1464" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-1465"><span class="mrow" id="MathJax-Span-1466"><span class="munderover" id="MathJax-Span-1467"><span style="display: inline-block; position: relative; width: 0.926em; height: 0px;"><span style="position: absolute; clip: rect(3.41em, 1000.93em, 4.324em, -1000em); top: -4.01em; left: 0em;"><span class="msubsup" id="MathJax-Span-1468"><span style="display: inline-block; position: relative; width: 0.926em; height: 0px;"><span style="position: absolute; clip: rect(3.41em, 1000.59em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-1469"><span class="mrow" id="MathJax-Span-1470"><span class="mtext" id="MathJax-Span-1471" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.607em;"><span class="mi" id="MathJax-Span-1472" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.536em, 1000.42em, 3.952em, -1000em); top: -4.37em; left: 0.213em;"><span class="mo" id="MathJax-Span-1473" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-1474" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.139em, 1001.03em, 4.189em, -1000em); top: -3.324em; left: 50%; margin-left: -0.517em;"><span class="mrow" id="MathJax-Span-1475"><span class="mi" id="MathJax-Span-1476" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.035em;"></span></span><span class="mi" id="MathJax-Span-1477" style="font-family: MathJax_Math; font-style: italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1007.78em, 1.198em, -1000em); top: -1.262em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 7.779em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.497em; border-left: 0px solid; width: 0px; height: 3.435em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>E</mi><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mover><mi>P</mi><mo stretchy="false">^</mo></mover></mrow></mrow></msub><mo stretchy="false">[</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mo>−</mo><mi>l</mi><mi>o</mi><mi>g</mi><mi>P</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac><mo stretchy="false">]</mo><mo>≈</mo><msub><mi>E</mi><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mover><mi>P</mi><mo stretchy="false">^</mo></mover></mrow></mrow></msub><mo stretchy="false">[</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>F</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>E</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>y</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac><mo stretchy="false">]</mo><mo>−</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>F</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>E</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>y</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mover><msub><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mi>i</mi></msub><mo stretchy="false">~</mo></mover></mrow><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><mi>θ</mi></mrow></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-126">\begin{equation}
    E_{\hat{P}}[\frac{\partial -log P(\textbf{x})}{\partial \theta}] \approx  E_{\hat{P}}[\frac{\partial FreeEnergy(\textbf{x})}{\partial \theta}] - \frac{1}{n}\sum_{i=1}^n\frac{\partial FreeEnergy(\tilde{\textbf{x}_i})}{\partial \theta}
\end{equation}</script><p></p>

<p>&nbsp; &nbsp; &nbsp; &nbsp; 最后，简要概括一下RBMs模型学习方法的步骤：（1）、求偏导，（2）、采样，（3）、估计负对数似然梯度，（4）、梯度下降方法更新参数。</p>

<h2 id="五gibbs采样"><a name="t6"></a><strong>五、Gibbs采样：</strong></h2>

<p>&nbsp;  &nbsp; &nbsp;&nbsp;对RBMs模型来说， Gibbs主要有两个作用：一是估计negative log-likelihood gradient；二是在训练完模型之后（如DBN，DBN是由多个RBMs叠加而成的），用Gibbs进行采样，可以看到模型对数据的拟合以及网络中间隐含层的抽象效果。</p>

<p>&nbsp;  &nbsp; &nbsp;&nbsp; 在RBMs模型训练过程中，Gibbs就是用来对negative log-likelihood gradient进行估计的。Gibbs采样分两个小步对<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1478" style="width: 2.971em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.448em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.333em, 1002.35em, 2.646em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-1479"><span class="mo" id="MathJax-Span-1480" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-1481"><span class="mrow" id="MathJax-Span-1482"><span class="mtext" id="MathJax-Span-1483" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1484" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-1485" style="padding-left: 0.167em;"><span class="mrow" id="MathJax-Span-1486"><span class="mtext" id="MathJax-Span-1487" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span class="mo" id="MathJax-Span-1488" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.362em; border-left: 0px solid; width: 0px; height: 1.325em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-31">(\textbf{x}, \textbf{h})</script>进行采样，第一步固定<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1489" style="width: 0.784em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.625em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.639em, 1000.6em, 2.396em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-1490"><span class="texatom" id="MathJax-Span-1491"><span class="mrow" id="MathJax-Span-1492"><span class="mtext" id="MathJax-Span-1493" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.658em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow></math></span></span><script type="math/tex" id="MathJax-Element-32">\textbf{x}</script>对<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-33-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1494" style="width: 0.784em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.625em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.389em, 1000.61em, 2.396em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-1495"><span class="texatom" id="MathJax-Span-1496"><span class="mrow" id="MathJax-Span-1497"><span class="mtext" id="MathJax-Span-1498" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.958em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow></math></span></span><script type="math/tex" id="MathJax-Element-33">\textbf{h}</script>进行采样，第二步固定<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-34-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1499" style="width: 0.784em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.625em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.389em, 1000.61em, 2.396em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-1500"><span class="texatom" id="MathJax-Span-1501"><span class="mrow" id="MathJax-Span-1502"><span class="mtext" id="MathJax-Span-1503" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.958em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow></math></span></span><script type="math/tex" id="MathJax-Element-34">\textbf{h}</script>对<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-35-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1504" style="width: 0.784em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.625em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.639em, 1000.6em, 2.396em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-1505"><span class="texatom" id="MathJax-Span-1506"><span class="mrow" id="MathJax-Span-1507"><span class="mtext" id="MathJax-Span-1508" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.658em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow></math></span></span><script type="math/tex" id="MathJax-Element-35">\textbf{x}</script>进行采样，<strong>交替进行直到收敛</strong>： <br>
<span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"></div><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-36-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtable columnalign=&quot;right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em&quot; displaystyle=&quot;true&quot;><mtr><mtd /><mtd><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mn>1</mn></msub><mo>&amp;#x223C;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>P</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></mtd></mtr><mtr><mtd /><mtd><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><mn>1</mn></msub><mo>&amp;#x223C;</mo><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mn>1</mn></msub><mo stretchy=&quot;false&quot;>)</mo></mtd></mtr><mtr><mtd /><mtd><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mn>2</mn></msub><mo>&amp;#x223C;</mo><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><mn>1</mn></msub><mo stretchy=&quot;false&quot;>)</mo></mtd></mtr><mtr><mtd /><mtd><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><mn>2</mn></msub><mo>&amp;#x223C;</mo><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mn>2</mn></msub><mo stretchy=&quot;false&quot;>)</mo></mtd></mtr><mtr><mtd /><mtd><mi></mi><mspace width=&quot;thickmathspace&quot; /><mspace width=&quot;thickmathspace&quot; /><mspace width=&quot;thickmathspace&quot; /><mspace width=&quot;thickmathspace&quot; /><mspace width=&quot;thickmathspace&quot; /><mspace width=&quot;thickmathspace&quot; /><mspace width=&quot;thickmathspace&quot; /><mspace width=&quot;thickmathspace&quot; /><mspace width=&quot;thickmathspace&quot; /><mspace width=&quot;thickmathspace&quot; /><mo>&amp;#x22EE;</mo></mtd></mtr><mtr><mtd /><mtd><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>&amp;#x223C;</mo><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><mi>k</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mtd></mtr></mtable></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1509" style="width: 8.596em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.135em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(-2.432em, 1006.87em, 6.307em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-1510"><span class="mtable" id="MathJax-Span-1511" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 6.784em; height: 0px;"><span style="position: absolute; clip: rect(4.534em, 1000em, 12.046em, -1000em); top: -8.177em; left: 0em;"><span style="display: inline-block; position: relative; width: 0em; height: 0px;"><span style="position: absolute; clip: rect(3.854em, 1000em, 4.167em, -1000em); top: -7.497em; right: 0em;"><span class="mtd" id="MathJax-Span-1512"><span class="mrow" id="MathJax-Span-1513"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.854em, 1000em, 4.167em, -1000em); top: -6.147em; right: 0em;"><span class="mtd" id="MathJax-Span-1530"><span class="mrow" id="MathJax-Span-1531"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.854em, 1000em, 4.167em, -1000em); top: -4.797em; right: 0em;"><span class="mtd" id="MathJax-Span-1554"><span class="mrow" id="MathJax-Span-1555"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.854em, 1000em, 4.167em, -1000em); top: -3.447em; right: 0em;"><span class="mtd" id="MathJax-Span-1578"><span class="mrow" id="MathJax-Span-1579"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.854em, 1000em, 4.167em, -1000em); top: -1.597em; right: 0em;"><span class="mtd" id="MathJax-Span-1602"><span class="mrow" id="MathJax-Span-1603"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.854em, 1000em, 4.167em, -1000em); top: -0.297em; right: 0em;"><span class="mtd" id="MathJax-Span-1618"><span class="mrow" id="MathJax-Span-1619"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span><span style="display: inline-block; width: 0px; height: 8.177em;"></span></span><span style="position: absolute; clip: rect(4.808em, 1006.69em, 13.546em, -1000em); top: -9.427em; left: 0em;"><span style="display: inline-block; position: relative; width: 6.784em; height: 0px;"><span style="position: absolute; clip: rect(2.878em, 1004.43em, 4.417em, -1000em); top: -7.497em; left: 0em;"><span class="mtd" id="MathJax-Span-1514"><span class="mrow" id="MathJax-Span-1515"><span class="msubsup" id="MathJax-Span-1516"><span style="display: inline-block; position: relative; width: 1.036em; height: 0px;"><span style="position: absolute; clip: rect(3.41em, 1000.59em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-1517"><span class="mrow" id="MathJax-Span-1518"><span class="mtext" id="MathJax-Span-1519" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.607em;"><span class="mn" id="MathJax-Span-1520" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-1521" style="font-family: MathJax_Main; padding-left: 0.278em;">∼</span><span class="texatom" id="MathJax-Span-1522" style="padding-left: 0.278em;"><span class="mrow" id="MathJax-Span-1523"><span class="munderover" id="MathJax-Span-1524"><span style="display: inline-block; position: relative; width: 0.805em; height: 0px;"><span style="position: absolute; clip: rect(3.171em, 1000.75em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-1525" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.16em, 1000.39em, 3.636em, -1000em); top: -4.293em; left: 0.305em;"><span class="mo" id="MathJax-Span-1526" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-1527" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1528" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-1529" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.104em, 1005.79em, 4.417em, -1000em); top: -6.147em; left: 0em;"><span class="mtd" id="MathJax-Span-1532"><span class="mrow" id="MathJax-Span-1533"><span class="msubsup" id="MathJax-Span-1534"><span style="display: inline-block; position: relative; width: 1.068em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.62em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-1535"><span class="mrow" id="MathJax-Span-1536"><span class="mtext" id="MathJax-Span-1537" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.639em;"><span class="mn" id="MathJax-Span-1538" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-1539" style="font-family: MathJax_Main; padding-left: 0.278em;">∼</span><span class="mi" id="MathJax-Span-1540" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span class="mo" id="MathJax-Span-1541" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-1542"><span class="mrow" id="MathJax-Span-1543"><span class="mtext" id="MathJax-Span-1544" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span class="texatom" id="MathJax-Span-1545"><span class="mrow" id="MathJax-Span-1546"><span class="mo" id="MathJax-Span-1547" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-1548"><span style="display: inline-block; position: relative; width: 1.036em; height: 0px;"><span style="position: absolute; clip: rect(3.41em, 1000.59em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-1549"><span class="mrow" id="MathJax-Span-1550"><span class="mtext" id="MathJax-Span-1551" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.607em;"><span class="mn" id="MathJax-Span-1552" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-1553" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.104em, 1005.76em, 4.417em, -1000em); top: -4.797em; left: 0em;"><span class="mtd" id="MathJax-Span-1556"><span class="mrow" id="MathJax-Span-1557"><span class="msubsup" id="MathJax-Span-1558"><span style="display: inline-block; position: relative; width: 1.036em; height: 0px;"><span style="position: absolute; clip: rect(3.41em, 1000.59em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-1559"><span class="mrow" id="MathJax-Span-1560"><span class="mtext" id="MathJax-Span-1561" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.607em;"><span class="mn" id="MathJax-Span-1562" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-1563" style="font-family: MathJax_Main; padding-left: 0.278em;">∼</span><span class="mi" id="MathJax-Span-1564" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span class="mo" id="MathJax-Span-1565" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-1566"><span class="mrow" id="MathJax-Span-1567"><span class="mtext" id="MathJax-Span-1568" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="texatom" id="MathJax-Span-1569"><span class="mrow" id="MathJax-Span-1570"><span class="mo" id="MathJax-Span-1571" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-1572"><span style="display: inline-block; position: relative; width: 1.068em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.62em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-1573"><span class="mrow" id="MathJax-Span-1574"><span class="mtext" id="MathJax-Span-1575" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.639em;"><span class="mn" id="MathJax-Span-1576" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-1577" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.104em, 1005.79em, 4.417em, -1000em); top: -3.447em; left: 0em;"><span class="mtd" id="MathJax-Span-1580"><span class="mrow" id="MathJax-Span-1581"><span class="msubsup" id="MathJax-Span-1582"><span style="display: inline-block; position: relative; width: 1.068em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.62em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-1583"><span class="mrow" id="MathJax-Span-1584"><span class="mtext" id="MathJax-Span-1585" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.639em;"><span class="mn" id="MathJax-Span-1586" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-1587" style="font-family: MathJax_Main; padding-left: 0.278em;">∼</span><span class="mi" id="MathJax-Span-1588" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span class="mo" id="MathJax-Span-1589" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-1590"><span class="mrow" id="MathJax-Span-1591"><span class="mtext" id="MathJax-Span-1592" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span class="texatom" id="MathJax-Span-1593"><span class="mrow" id="MathJax-Span-1594"><span class="mo" id="MathJax-Span-1595" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-1596"><span style="display: inline-block; position: relative; width: 1.036em; height: 0px;"><span style="position: absolute; clip: rect(3.41em, 1000.59em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-1597"><span class="mrow" id="MathJax-Span-1598"><span class="mtext" id="MathJax-Span-1599" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.607em;"><span class="mn" id="MathJax-Span-1600" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-1601" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(2.554em, 1002.98em, 4.197em, -1000em); top: -1.597em; left: 0em;"><span class="mtd" id="MathJax-Span-1604"><span class="mrow" id="MathJax-Span-1605"><span class="mi" id="MathJax-Span-1606"></span><span class="mspace" id="MathJax-Span-1607" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-1608" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-1609" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-1610" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-1611" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-1612" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-1613" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-1614" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-1615" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-1616" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-1617" style="font-family: MathJax_Main;">⋮</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.104em, 1006.69em, 4.417em, -1000em); top: -0.297em; left: 0em;"><span class="mtd" id="MathJax-Span-1620"><span class="mrow" id="MathJax-Span-1621"><span class="msubsup" id="MathJax-Span-1622"><span style="display: inline-block; position: relative; width: 1.954em; height: 0px;"><span style="position: absolute; clip: rect(3.41em, 1000.59em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-1623"><span class="mrow" id="MathJax-Span-1624"><span class="mtext" id="MathJax-Span-1625" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.607em;"><span class="texatom" id="MathJax-Span-1626"><span class="mrow" id="MathJax-Span-1627"><span class="mi" id="MathJax-Span-1628" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span class="mo" id="MathJax-Span-1629" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1630" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-1631" style="font-family: MathJax_Main; padding-left: 0.278em;">∼</span><span class="mi" id="MathJax-Span-1632" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span class="mo" id="MathJax-Span-1633" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-1634"><span class="mrow" id="MathJax-Span-1635"><span class="mtext" id="MathJax-Span-1636" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="texatom" id="MathJax-Span-1637"><span class="mrow" id="MathJax-Span-1638"><span class="mo" id="MathJax-Span-1639" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-1640"><span style="display: inline-block; position: relative; width: 1.082em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.62em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-1641"><span class="mrow" id="MathJax-Span-1642"><span class="mtext" id="MathJax-Span-1643" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.639em;"><span class="mi" id="MathJax-Span-1644" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-1645" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span><span style="display: inline-block; width: 0px; height: 9.427em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -4.818em; border-left: 0px solid; width: 0px; height: 10.236em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left" rowspacing="3pt" columnspacing="0em" displaystyle="true"><mtr><mtd></mtd><mtd><msub><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mn>1</mn></msub><mo>∼</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>P</mi><mo stretchy="false">^</mo></mover></mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd></mtd><mtd><msub><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><mn>1</mn></msub><mo>∼</mo><mi>P</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mn>1</mn></msub><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd></mtd><mtd><msub><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mn>2</mn></msub><mo>∼</mo><mi>P</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><mn>1</mn></msub><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd></mtd><mtd><msub><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><mn>2</mn></msub><mo>∼</mo><mi>P</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mn>2</mn></msub><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mspace width="thickmathspace"></mspace><mspace width="thickmathspace"></mspace><mspace width="thickmathspace"></mspace><mspace width="thickmathspace"></mspace><mspace width="thickmathspace"></mspace><mspace width="thickmathspace"></mspace><mspace width="thickmathspace"></mspace><mspace width="thickmathspace"></mspace><mspace width="thickmathspace"></mspace><mspace width="thickmathspace"></mspace><mo>⋮</mo></mtd></mtr><mtr><mtd></mtd><mtd><msub><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>∼</mo><mi>P</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><mi>k</mi></msub><mo stretchy="false">)</mo></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-36">\begin{equation}
    \begin{split}
        &\textbf{x}_1 \sim \hat{P}(x)\\
        &\textbf{h}_1 \sim P(\textbf{h}|\textbf{x}_1)\\
        &\textbf{x}_2 \sim P(\textbf{x}|\textbf{h}_1)\\
        &\textbf{h}_2 \sim P(\textbf{h}|\textbf{x}_2)\\
        &\;\;\;\;\;\;\;\;\;\;\vdots \\
        &\textbf{x}_{k+1} \sim P(\textbf{x}|\textbf{h}_k)\\
    \end{split}
\end{equation}</script> <br>
&nbsp;  &nbsp;  因为在训练过程中，训练模型分布会逐渐逼近训练样本分布，所以第一步可以从训练样本的分布<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-37-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>P</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1646" style="width: 0.94em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.781em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.055em, 1000.73em, 2.344em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-1647"><span class="texatom" id="MathJax-Span-1648"><span class="mrow" id="MathJax-Span-1649"><span class="munderover" id="MathJax-Span-1650"><span style="display: inline-block; position: relative; width: 0.805em; height: 0px;"><span style="position: absolute; clip: rect(3.171em, 1000.75em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-1651" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.16em, 1000.39em, 3.636em, -1000em); top: -4.293em; left: 0.305em;"><span class="mo" id="MathJax-Span-1652" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 1.296em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><mi>P</mi><mo stretchy="false">^</mo></mover></mrow></math></span></span><script type="math/tex" id="MathJax-Element-37">\hat{P}</script>抽取样本作为<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-38-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mn>1</mn></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1653" style="width: 1.253em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.042em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.587em, 1001.04em, 2.494em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-1654"><span class="msubsup" id="MathJax-Span-1655"><span style="display: inline-block; position: relative; width: 1.036em; height: 0px;"><span style="position: absolute; clip: rect(3.41em, 1000.59em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-1656"><span class="mrow" id="MathJax-Span-1657"><span class="mtext" id="MathJax-Span-1658" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.607em;"><span class="mn" id="MathJax-Span-1659" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.242em; border-left: 0px solid; width: 0px; height: 0.838em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-38">\textbf{x}_1</script>。如果第一步直接从模型<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-39-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1660" style="width: 0.888em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.729em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.452em, 1000.73em, 2.448em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-1661"><span class="mi" id="MathJax-Span-1662" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.945em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi></math></span></span><script type="math/tex" id="MathJax-Element-39">P</script> 中采样，Gibbs采样会迅速收敛。<p></p>

<p>&nbsp;&nbsp;&nbsp;&nbsp;<em>例如:假设<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-40-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><mo>&amp;#x2208;</mo><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>{</mo><mn>0</mn><mo>,</mo><mn>1</mn><msup><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>}</mo><mi>H</mi></msup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1663" style="width: 6.044em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.237em, 1005em, 2.646em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-1664"><span class="texatom" id="MathJax-Span-1665"><span class="mrow" id="MathJax-Span-1666"><span class="mtext" id="MathJax-Span-1667" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span class="mo" id="MathJax-Span-1668" style="font-family: MathJax_Main; padding-left: 0.278em;">∈</span><span class="mo" id="MathJax-Span-1669" style="font-family: MathJax_Main; padding-left: 0.278em;">{</span><span class="mn" id="MathJax-Span-1670" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-1671" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-1672" style="font-family: MathJax_Main; padding-left: 0.167em;">1</span><span class="msubsup" id="MathJax-Span-1673"><span style="display: inline-block; position: relative; width: 1.203em; height: 0px;"><span style="position: absolute; clip: rect(3.104em, 1000.43em, 4.417em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-1674" style="font-family: MathJax_Main;">}</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.5em;"><span class="mi" id="MathJax-Span-1675" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.362em; border-left: 0px solid; width: 0px; height: 1.44em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><mo>∈</mo><mo fence="false" stretchy="false">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><msup><mo fence="false" stretchy="false">}</mo><mi>H</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-40">\textbf{h} \in \{0,1\}^H</script>,已经得到<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-41-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mn>1</mn></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1676" style="width: 1.253em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.042em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.587em, 1001.04em, 2.494em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-1677"><span class="msubsup" id="MathJax-Span-1678"><span style="display: inline-block; position: relative; width: 1.036em; height: 0px;"><span style="position: absolute; clip: rect(3.41em, 1000.59em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-1679"><span class="mrow" id="MathJax-Span-1680"><span class="mtext" id="MathJax-Span-1681" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.607em;"><span class="mn" id="MathJax-Span-1682" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.242em; border-left: 0px solid; width: 0px; height: 0.838em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-41">\textbf{x}_1</script>，需要对<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-42-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><mn>1</mn></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1683" style="width: 1.357em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.094em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.337em, 1001.09em, 2.494em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-1684"><span class="msubsup" id="MathJax-Span-1685"><span style="display: inline-block; position: relative; width: 1.068em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.62em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-1686"><span class="mrow" id="MathJax-Span-1687"><span class="mtext" id="MathJax-Span-1688" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.639em;"><span class="mn" id="MathJax-Span-1689" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.242em; border-left: 0px solid; width: 0px; height: 1.138em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-42">\textbf{h}_1</script>采样。<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-43-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><munder><mo>&amp;#x220F;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi></mrow></munder><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>h</mi><mi>j</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1690" style="width: 10.784em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.958em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.385em, 1008.86em, 2.878em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-1691"><span class="mi" id="MathJax-Span-1692" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span class="mo" id="MathJax-Span-1693" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-1694"><span class="mrow" id="MathJax-Span-1695"><span class="mtext" id="MathJax-Span-1696" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span class="texatom" id="MathJax-Span-1697"><span class="mrow" id="MathJax-Span-1698"><span class="mo" id="MathJax-Span-1699" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-1700"><span class="mrow" id="MathJax-Span-1701"><span class="mtext" id="MathJax-Span-1702" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1703" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1704" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="munderover" id="MathJax-Span-1705" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.31em; height: 0px;"><span style="position: absolute; clip: rect(3.104em, 1000.89em, 4.417em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-1706" style="font-family: MathJax_Size1; vertical-align: 0em;">∏</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.725em; left: 0.944em;"><span class="texatom" id="MathJax-Span-1707"><span class="mrow" id="MathJax-Span-1708"><span class="mi" id="MathJax-Span-1709" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mi" id="MathJax-Span-1710" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">p</span><span class="mo" id="MathJax-Span-1711" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1712"><span style="display: inline-block; position: relative; width: 0.942em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.56em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-1713" style="font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.576em;"><span class="mi" id="MathJax-Span-1714" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1715"><span class="mrow" id="MathJax-Span-1716"><span class="mo" id="MathJax-Span-1717" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-1718"><span class="mrow" id="MathJax-Span-1719"><span class="mtext" id="MathJax-Span-1720" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1721" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.578em; border-left: 0px solid; width: 0px; height: 1.541em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo stretchy="false">)</mo><mo>=</mo><munder><mo>∏</mo><mrow class="MJX-TeXAtom-ORD"><mi>j</mi></mrow></munder><mi>p</mi><mo stretchy="false">(</mo><msub><mi>h</mi><mi>j</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-43">P(\textbf{h}| \textbf{x}) = \prod_{j}p(h_j|\textbf{x})</script>（注：条件分布的具体推导过程见下一小节内容），<u><strong>由于隐单元之间是相互独立的，所以可以采用block Gibbs采样，对所有的隐单元同时进行采样，加快采样收敛</strong></u>。分别求<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-44-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>h</mi><mi>j</mi></msub><mo>=</mo><mn>1</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1722" style="width: 5.94em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.948em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.385em, 1004.85em, 2.742em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-1723"><span class="mi" id="MathJax-Span-1724" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-1725" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1726"><span style="display: inline-block; position: relative; width: 0.942em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.56em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-1727" style="font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.576em;"><span class="mi" id="MathJax-Span-1728" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-1729" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-1730" style="font-family: MathJax_Main; padding-left: 0.278em;">1</span><span class="texatom" id="MathJax-Span-1731"><span class="mrow" id="MathJax-Span-1732"><span class="mo" id="MathJax-Span-1733" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-1734"><span class="mrow" id="MathJax-Span-1735"><span class="mtext" id="MathJax-Span-1736" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1737" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.416em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><msub><mi>h</mi><mi>j</mi></msub><mo>=</mo><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-44">p(h_j=1|\textbf{x})</script>，如果<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-45-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>h</mi><mi>j</mi></msub><mo>=</mo><mn>1</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2265;</mo><mi>U</mi><mo stretchy=&quot;false&quot;>[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1738" style="width: 10.888em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.063em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.385em, 1008.94em, 2.742em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-1739"><span class="mi" id="MathJax-Span-1740" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-1741" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1742"><span style="display: inline-block; position: relative; width: 0.942em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.56em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-1743" style="font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.576em;"><span class="mi" id="MathJax-Span-1744" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-1745" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-1746" style="font-family: MathJax_Main; padding-left: 0.278em;">1</span><span class="texatom" id="MathJax-Span-1747"><span class="mrow" id="MathJax-Span-1748"><span class="mo" id="MathJax-Span-1749" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-1750"><span class="mrow" id="MathJax-Span-1751"><span class="mtext" id="MathJax-Span-1752" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1753" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1754" style="font-family: MathJax_Main; padding-left: 0.278em;">≥</span><span class="mi" id="MathJax-Span-1755" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">U<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.084em;"></span></span><span class="mo" id="MathJax-Span-1756" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-1757" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-1758" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-1759" style="font-family: MathJax_Main; padding-left: 0.167em;">1</span><span class="mo" id="MathJax-Span-1760" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.416em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><msub><mi>h</mi><mi>j</mi></msub><mo>=</mo><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo stretchy="false">)</mo><mo>≥</mo><mi>U</mi><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-45">p(h_j=1|\textbf{x})\ge U[0,1]</script>（大于等于均匀分布的一个采样），就设置<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-46-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>h</mi><mi>j</mi></msub><mo>=</mo><mn>1</mn></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1761" style="width: 3.336em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.76em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.389em, 1002.69em, 2.69em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-1762"><span class="msubsup" id="MathJax-Span-1763"><span style="display: inline-block; position: relative; width: 0.942em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.56em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-1764" style="font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.576em;"><span class="mi" id="MathJax-Span-1765" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-1766" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-1767" style="font-family: MathJax_Main; padding-left: 0.278em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.416em; border-left: 0px solid; width: 0px; height: 1.311em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>h</mi><mi>j</mi></msub><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-46">h_j = 1</script>，否则设置<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-47-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>h</mi><mi>j</mi></msub><mo>=</mo><mn>0</mn></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1768" style="width: 3.336em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.76em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.389em, 1002.72em, 2.69em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-1769"><span class="msubsup" id="MathJax-Span-1770"><span style="display: inline-block; position: relative; width: 0.942em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.56em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-1771" style="font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.576em;"><span class="mi" id="MathJax-Span-1772" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-1773" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-1774" style="font-family: MathJax_Main; padding-left: 0.278em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.416em; border-left: 0px solid; width: 0px; height: 1.311em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>h</mi><mi>j</mi></msub><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-47">h_j = 0</script>。</em></p>



<h3 id="条件分布"><a name="t7"></a><strong>条件分布：</strong></h3>

<p>&nbsp;&nbsp;&nbsp;&nbsp;Gibbs采样主要是根据条件分布迭代进行采样的，所以在采样之前要先推导出条件分布公式。 <br>
<span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"></div><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-48-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtable columnalign=&quot;right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em&quot; displaystyle=&quot;true&quot;><mtr><mtd /><mtd><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><mo>&amp;#x2032;</mo></msup></mrow></munder><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>,</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><mo>&amp;#x2032;</mo></msup><mo stretchy=&quot;false&quot;>)</mo></mtd></mtr><mtr><mtd /><mtd><mi></mi><mspace width=&quot;thickmathspace&quot; /><mspace width=&quot;thickmathspace&quot; /><mo>=</mo><mfrac><mrow><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>W</mtext></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>+</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>c</mtext></mrow><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>+</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>b</mtext></mrow><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mi>Z</mi></mrow><mrow><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><mo>&amp;#x2032;</mo></msup></mrow></munder><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><mrow><mo class=&quot;MJX-variant&quot;>&amp;#x2032;</mo><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></mrow></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>W</mtext></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>+</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>c</mtext></mrow><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>+</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>b</mtext></mrow><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></msup><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><mo>&amp;#x2032;</mo></msup><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mi>Z</mi></mrow></mfrac></mtd></mtr><mtr><mtd /><mtd><mi></mi><mspace width=&quot;thickmathspace&quot; /><mspace width=&quot;thickmathspace&quot; /><mo>=</mo><mfrac><mrow><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>W</mtext></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>+</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>b</mtext></mrow><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><mo>&amp;#x2032;</mo></msup></mrow></munder><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><mrow><mo class=&quot;MJX-variant&quot;>&amp;#x2032;</mo><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></mrow></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>W</mtext></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>+</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>b</mtext></mrow><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></msup><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><mo>&amp;#x2032;</mo></msup><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac><mspace width=&quot;thickmathspace&quot; /><mspace width=&quot;thickmathspace&quot; /><mtext>&amp;#x5206;&amp;#x5B50;&amp;#x5206;&amp;#x6BCD;&amp;#x540C;&amp;#x65F6;&amp;#x7EA6;&amp;#x53BB;h&amp;#x65E0;&amp;#x5173;&amp;#x9879;</mtext></mtd></mtr><mtr><mtd /><mtd><mi></mi><mspace width=&quot;thickmathspace&quot; /><mspace width=&quot;thickmathspace&quot; /><mo>=</mo><mfrac><mrow><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>h</mi></mrow><mi>j</mi></msub></mrow></munder><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>h</mi></mrow><mi>j</mi></msub><msub><mi>W</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi><mo>&amp;#x22C5;</mo></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>+</mo><msub><mi>b</mi><mi>j</mi></msub><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>h</mi></mrow><mi>j</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><mo>&amp;#x2032;</mo></msup></mrow></munder><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>h</mi><mo>&amp;#x2032;</mo></msup></mrow><mi>j</mi></msub></mrow></munder><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>h</mi><mo>&amp;#x2032;</mo></msup></mrow><mi>j</mi></msub><msub><mi>W</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi><mo>&amp;#x22C5;</mo></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>+</mo><msub><mi>b</mi><mi>j</mi></msub><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>h</mi><mo>&amp;#x2032;</mo></msup></mrow><mi>j</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac><mspace width=&quot;thickmathspace&quot; /><mspace width=&quot;thickmathspace&quot; /><msub><mi>W</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi><mo>&amp;#x22C5;</mo></mrow></msub><mtext>&amp;#x662F;W&amp;#x7684;&amp;#x7B2C;j&amp;#x884C;</mtext></mtd></mtr><mtr><mtd /><mtd><mi></mi><mspace width=&quot;thickmathspace&quot; /><mspace width=&quot;thickmathspace&quot; /><mo>=</mo><mfrac><mrow><munder><mo>&amp;#x220F;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi></mrow></munder><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>h</mi></mrow><mi>j</mi></msub><msub><mi>W</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi><mo>&amp;#x22C5;</mo></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>+</mo><msub><mi>b</mi><mi>j</mi></msub><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>h</mi></mrow><mi>j</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>h</mi><mo>&amp;#x2032;</mo></msup></mrow><mn>1</mn></msub></mrow></munder><mo>.</mo><mo>.</mo><mo>.</mo><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>h</mi><mo>&amp;#x2032;</mo></msup></mrow><mi>H</mi></msub></mrow></munder><munder><mo>&amp;#x220F;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi></mrow></munder><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>h</mi><mo>&amp;#x2032;</mo></msup></mrow><mi>j</mi></msub><msub><mi>W</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi><mo>&amp;#x22C5;</mo></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>+</mo><msub><mi>b</mi><mi>j</mi></msub><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>h</mi><mo>&amp;#x2032;</mo></msup></mrow><mi>j</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac></mtd></mtr><mtr><mtd /><mtd><mi></mi><mspace width=&quot;thickmathspace&quot; /><mspace width=&quot;thickmathspace&quot; /><mo>=</mo><mfrac><mrow><munder><mo>&amp;#x220F;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi></mrow></munder><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>h</mi></mrow><mi>j</mi></msub><msub><mi>W</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi><mo>&amp;#x22C5;</mo></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>+</mo><msub><mi>b</mi><mi>j</mi></msub><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>h</mi></mrow><mi>j</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><munder><mo>&amp;#x220F;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi></mrow></munder><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>h</mi><mo>&amp;#x2032;</mo></msup></mrow><mi>j</mi></msub></mrow></munder><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>h</mi><mo>&amp;#x2032;</mo></msup></mrow><mi>j</mi></msub><msub><mi>W</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi><mo>&amp;#x22C5;</mo></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>+</mo><msub><mi>b</mi><mi>j</mi></msub><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>h</mi><mo>&amp;#x2032;</mo></msup></mrow><mi>j</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac></mtd></mtr><mtr><mtd /><mtd><mi></mi><mspace width=&quot;thickmathspace&quot; /><mspace width=&quot;thickmathspace&quot; /><mo>=</mo><munder><mo>&amp;#x220F;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi></mrow></munder><mfrac><mrow><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>h</mi></mrow><mi>j</mi></msub><msub><mi>W</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi><mo>&amp;#x22C5;</mo></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>+</mo><msub><mi>b</mi><mi>j</mi></msub><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>h</mi></mrow><mi>j</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>h</mi><mo>&amp;#x2032;</mo></msup></mrow><mi>j</mi></msub></mrow></munder><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>h</mi><mo>&amp;#x2032;</mo></msup></mrow><mi>j</mi></msub><msub><mi>W</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi><mo>&amp;#x22C5;</mo></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>+</mo><msub><mi>b</mi><mi>j</mi></msub><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>h</mi><mo>&amp;#x2032;</mo></msup></mrow><mi>j</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac></mtd></mtr><mtr><mtd /><mtd><mi></mi><mspace width=&quot;thickmathspace&quot; /><mspace width=&quot;thickmathspace&quot; /><mo>=</mo><munder><mo>&amp;#x220F;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi></mrow></munder><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>h</mi><mi>j</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo></mtd></mtr></mtable></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1775" style="width: 25.159em; display: inline-block;"><span style="display: inline-block; position: relative; width: 20.938em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(-10.009em, 1020.77em, 13.884em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-1776"><span class="mtable" id="MathJax-Span-1777" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 20.615em; height: 0px;"><span style="position: absolute; clip: rect(11.045em, 1000em, 32.66em, -1000em); top: -22.292em; left: 0em;"><span style="display: inline-block; position: relative; width: 0em; height: 0px;"><span style="position: absolute; clip: rect(3.854em, 1000em, 4.167em, -1000em); top: -15.101em; right: 0em;"><span class="mtd" id="MathJax-Span-1778"><span class="mrow" id="MathJax-Span-1779"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.854em, 1000em, 4.167em, -1000em); top: -11.893em; right: 0em;"><span class="mtd" id="MathJax-Span-1829"><span class="mrow" id="MathJax-Span-1830"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.854em, 1000em, 4.167em, -1000em); top: -8.83em; right: 0em;"><span class="mtd" id="MathJax-Span-1929"><span class="mrow" id="MathJax-Span-1930"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.854em, 1000em, 4.167em, -1000em); top: -5.668em; right: 0em;"><span class="mtd" id="MathJax-Span-2006"><span class="mrow" id="MathJax-Span-2007"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.854em, 1000em, 4.167em, -1000em); top: -2.504em; right: 0em;"><span class="mtd" id="MathJax-Span-2115"><span class="mrow" id="MathJax-Span-2116"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.854em, 1000em, 4.167em, -1000em); top: 0.595em; right: 0em;"><span class="mtd" id="MathJax-Span-2221"><span class="mrow" id="MathJax-Span-2222"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.854em, 1000em, 4.167em, -1000em); top: 3.623em; right: 0em;"><span class="mtd" id="MathJax-Span-2313"><span class="mrow" id="MathJax-Span-2314"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.854em, 1000em, 4.167em, -1000em); top: 6.202em; right: 0em;"><span class="mtd" id="MathJax-Span-2400"><span class="mrow" id="MathJax-Span-2401"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span><span style="display: inline-block; width: 0px; height: 22.292em;"></span></span><span style="position: absolute; clip: rect(12.387em, 1020.62em, 36.28em, -1000em); top: -24.583em; left: 0em;"><span style="display: inline-block; position: relative; width: 20.615em; height: 0px;"><span style="position: absolute; clip: rect(2.904em, 1013.28em, 5.461em, -1000em); top: -15.101em; left: 0em;"><span class="mtd" id="MathJax-Span-1780"><span class="mrow" id="MathJax-Span-1781"><span class="mi" id="MathJax-Span-1782" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span class="mo" id="MathJax-Span-1783" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-1784"><span class="mrow" id="MathJax-Span-1785"><span class="mtext" id="MathJax-Span-1786" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span class="texatom" id="MathJax-Span-1787"><span class="mrow" id="MathJax-Span-1788"><span class="mo" id="MathJax-Span-1789" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-1790"><span class="mrow" id="MathJax-Span-1791"><span class="mtext" id="MathJax-Span-1792" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1793" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1794" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-1795" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span class="mo" id="MathJax-Span-1796" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-1797"><span class="mrow" id="MathJax-Span-1798"><span class="mtext" id="MathJax-Span-1799" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1800" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-1801" style="padding-left: 0.167em;"><span class="mrow" id="MathJax-Span-1802"><span class="mtext" id="MathJax-Span-1803" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span class="mo" id="MathJax-Span-1804" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-1805"><span class="mrow" id="MathJax-Span-1806"><span class="mo" id="MathJax-Span-1807" style="font-family: MathJax_Main;">/</span></span></span><span class="munderover" id="MathJax-Span-1808" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.444em; height: 0px;"><span style="position: absolute; clip: rect(2.904em, 1001.39em, 4.617em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-1809" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.276em, 1000.64em, 4.267em, -1000em); top: -2.816em; left: 0.401em;"><span class="texatom" id="MathJax-Span-1810"><span class="mrow" id="MathJax-Span-1811"><span class="msup" id="MathJax-Span-1812"><span style="display: inline-block; position: relative; width: 0.642em; height: 0px;"><span style="position: absolute; clip: rect(3.363em, 1000.44em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-1813"><span class="mrow" id="MathJax-Span-1814"><span class="mtext" id="MathJax-Span-1815" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.308em; left: 0.452em;"><span class="mo" id="MathJax-Span-1816" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mi" id="MathJax-Span-1817" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span class="mo" id="MathJax-Span-1818" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-1819"><span class="mrow" id="MathJax-Span-1820"><span class="mtext" id="MathJax-Span-1821" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1822" style="font-family: MathJax_Main;">,</span><span class="msup" id="MathJax-Span-1823" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.908em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.62em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-1824"><span class="mrow" id="MathJax-Span-1825"><span class="mtext" id="MathJax-Span-1826" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.431em; left: 0.639em;"><span class="mo" id="MathJax-Span-1827" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-1828" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(2.241em, 1017.35em, 5.316em, -1000em); top: -11.893em; left: 0em;"><span class="mtd" id="MathJax-Span-1831"><span class="mrow" id="MathJax-Span-1832"><span class="mi" id="MathJax-Span-1833"></span><span class="mspace" id="MathJax-Span-1834" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-1835" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-1836" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mfrac" id="MathJax-Span-1837" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 15.217em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(2.961em, 1012.69em, 4.417em, -1000em); top: -4.731em; left: 50%; margin-left: -6.346em;"><span class="mrow" id="MathJax-Span-1838"><span class="mi" id="MathJax-Span-1839" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-1840" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mi" id="MathJax-Span-1841" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-1842" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1843"><span style="display: inline-block; position: relative; width: 1.264em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.62em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-1844"><span class="mrow" id="MathJax-Span-1845"><span class="mtext" id="MathJax-Span-1846" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.431em; left: 0.639em;"><span class="mi" id="MathJax-Span-1847" style="font-size: 70.7%; font-family: MathJax_Main;">⊤</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1848"><span class="mrow" id="MathJax-Span-1849"><span class="mtext" id="MathJax-Span-1850" style="font-family: MathJax_Main; font-weight: bold;">W</span></span></span><span class="texatom" id="MathJax-Span-1851"><span class="mrow" id="MathJax-Span-1852"><span class="mtext" id="MathJax-Span-1853" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1854" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msubsup" id="MathJax-Span-1855" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.136em; height: 0px;"><span style="position: absolute; clip: rect(3.401em, 1000.48em, 4.173em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-1856"><span class="mrow" id="MathJax-Span-1857"><span class="mtext" id="MathJax-Span-1858" style="font-family: MathJax_Main; font-weight: bold;">c</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.511em;"><span class="mi" id="MathJax-Span-1859" style="font-size: 70.7%; font-family: MathJax_Main;">⊤</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1860"><span class="mrow" id="MathJax-Span-1861"><span class="mtext" id="MathJax-Span-1862" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1863" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msubsup" id="MathJax-Span-1864" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.264em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.6em, 4.173em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-1865"><span class="mrow" id="MathJax-Span-1866"><span class="mtext" id="MathJax-Span-1867" style="font-family: MathJax_Main; font-weight: bold;">b</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.431em; left: 0.639em;"><span class="mi" id="MathJax-Span-1868" style="font-size: 70.7%; font-family: MathJax_Main;">⊤</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1869"><span class="mrow" id="MathJax-Span-1870"><span class="mtext" id="MathJax-Span-1871" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span class="mo" id="MathJax-Span-1872" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-1873"><span class="mrow" id="MathJax-Span-1874"><span class="mo" id="MathJax-Span-1875" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-1876" style="font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(2.961em, 1015.1em, 4.452em, -1000em); top: -3.147em; left: 50%; margin-left: -7.548em;"><span class="mrow" id="MathJax-Span-1877"><span class="munderover" id="MathJax-Span-1878"><span style="display: inline-block; position: relative; width: 1.773em; height: 0px;"><span style="position: absolute; clip: rect(3.104em, 1001em, 4.417em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-1879" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.725em; left: 1.056em;"><span class="texatom" id="MathJax-Span-1880"><span class="mrow" id="MathJax-Span-1881"><span class="msup" id="MathJax-Span-1882"><span style="display: inline-block; position: relative; width: 0.642em; height: 0px;"><span style="position: absolute; clip: rect(3.363em, 1000.44em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-1883"><span class="mrow" id="MathJax-Span-1884"><span class="mtext" id="MathJax-Span-1885" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.308em; left: 0.452em;"><span class="mo" id="MathJax-Span-1886" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mi" id="MathJax-Span-1887" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">e</span><span class="mi" id="MathJax-Span-1888" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mi" id="MathJax-Span-1889" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-1890" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1891"><span style="display: inline-block; position: relative; width: 1.459em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.62em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-1892"><span class="mrow" id="MathJax-Span-1893"><span class="mtext" id="MathJax-Span-1894" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.431em; left: 0.639em;"><span class="mrow" id="MathJax-Span-1895"><span class="mo" id="MathJax-Span-1896" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span class="mi" id="MathJax-Span-1897" style="font-size: 70.7%; font-family: MathJax_Main;">⊤</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1898"><span class="mrow" id="MathJax-Span-1899"><span class="mtext" id="MathJax-Span-1900" style="font-family: MathJax_Main; font-weight: bold;">W</span></span></span><span class="texatom" id="MathJax-Span-1901"><span class="mrow" id="MathJax-Span-1902"><span class="mtext" id="MathJax-Span-1903" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1904" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msubsup" id="MathJax-Span-1905" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.136em; height: 0px;"><span style="position: absolute; clip: rect(3.401em, 1000.48em, 4.173em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-1906"><span class="mrow" id="MathJax-Span-1907"><span class="mtext" id="MathJax-Span-1908" style="font-family: MathJax_Main; font-weight: bold;">c</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.299em; left: 0.511em;"><span class="mi" id="MathJax-Span-1909" style="font-size: 70.7%; font-family: MathJax_Main;">⊤</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1910"><span class="mrow" id="MathJax-Span-1911"><span class="mtext" id="MathJax-Span-1912" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1913" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msubsup" id="MathJax-Span-1914" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.264em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.6em, 4.173em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-1915"><span class="mrow" id="MathJax-Span-1916"><span class="mtext" id="MathJax-Span-1917" style="font-family: MathJax_Main; font-weight: bold;">b</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.431em; left: 0.639em;"><span class="mi" id="MathJax-Span-1918" style="font-size: 70.7%; font-family: MathJax_Main;">⊤</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="msup" id="MathJax-Span-1919"><span style="display: inline-block; position: relative; width: 0.908em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.62em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-1920"><span class="mrow" id="MathJax-Span-1921"><span class="mtext" id="MathJax-Span-1922" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.431em; left: 0.639em;"><span class="mo" id="MathJax-Span-1923" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-1924" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-1925"><span class="mrow" id="MathJax-Span-1926"><span class="mo" id="MathJax-Span-1927" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-1928" style="font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1015.22em, 1.198em, -1000em); top: -1.262em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 15.217em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(2.241em, 1019.77em, 5.316em, -1000em); top: -8.83em; left: 0em;"><span class="mtd" id="MathJax-Span-1931"><span class="mrow" id="MathJax-Span-1932"><span class="mi" id="MathJax-Span-1933"></span><span class="mspace" id="MathJax-Span-1934" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-1935" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-1936" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mfrac" id="MathJax-Span-1937" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 11.029em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(2.961em, 1008.41em, 4.417em, -1000em); top: -4.731em; left: 50%; margin-left: -4.252em;"><span class="mrow" id="MathJax-Span-1938"><span class="mi" id="MathJax-Span-1939" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-1940" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mi" id="MathJax-Span-1941" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-1942" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1943"><span style="display: inline-block; position: relative; width: 1.264em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.62em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-1944"><span class="mrow" id="MathJax-Span-1945"><span class="mtext" id="MathJax-Span-1946" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.431em; left: 0.639em;"><span class="mi" id="MathJax-Span-1947" style="font-size: 70.7%; font-family: MathJax_Main;">⊤</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1948"><span class="mrow" id="MathJax-Span-1949"><span class="mtext" id="MathJax-Span-1950" style="font-family: MathJax_Main; font-weight: bold;">W</span></span></span><span class="texatom" id="MathJax-Span-1951"><span class="mrow" id="MathJax-Span-1952"><span class="mtext" id="MathJax-Span-1953" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1954" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msubsup" id="MathJax-Span-1955" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.264em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.6em, 4.173em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-1956"><span class="mrow" id="MathJax-Span-1957"><span class="mtext" id="MathJax-Span-1958" style="font-family: MathJax_Main; font-weight: bold;">b</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.431em; left: 0.639em;"><span class="mi" id="MathJax-Span-1959" style="font-size: 70.7%; font-family: MathJax_Main;">⊤</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1960"><span class="mrow" id="MathJax-Span-1961"><span class="mtext" id="MathJax-Span-1962" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span class="mo" id="MathJax-Span-1963" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(2.961em, 1010.81em, 4.452em, -1000em); top: -3.147em; left: 50%; margin-left: -5.454em;"><span class="mrow" id="MathJax-Span-1964"><span class="munderover" id="MathJax-Span-1965"><span style="display: inline-block; position: relative; width: 1.773em; height: 0px;"><span style="position: absolute; clip: rect(3.104em, 1001em, 4.417em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-1966" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.725em; left: 1.056em;"><span class="texatom" id="MathJax-Span-1967"><span class="mrow" id="MathJax-Span-1968"><span class="msup" id="MathJax-Span-1969"><span style="display: inline-block; position: relative; width: 0.642em; height: 0px;"><span style="position: absolute; clip: rect(3.363em, 1000.44em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-1970"><span class="mrow" id="MathJax-Span-1971"><span class="mtext" id="MathJax-Span-1972" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.308em; left: 0.452em;"><span class="mo" id="MathJax-Span-1973" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mi" id="MathJax-Span-1974" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">e</span><span class="mi" id="MathJax-Span-1975" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mi" id="MathJax-Span-1976" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-1977" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1978"><span style="display: inline-block; position: relative; width: 1.459em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.62em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-1979"><span class="mrow" id="MathJax-Span-1980"><span class="mtext" id="MathJax-Span-1981" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.431em; left: 0.639em;"><span class="mrow" id="MathJax-Span-1982"><span class="mo" id="MathJax-Span-1983" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span class="mi" id="MathJax-Span-1984" style="font-size: 70.7%; font-family: MathJax_Main;">⊤</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1985"><span class="mrow" id="MathJax-Span-1986"><span class="mtext" id="MathJax-Span-1987" style="font-family: MathJax_Main; font-weight: bold;">W</span></span></span><span class="texatom" id="MathJax-Span-1988"><span class="mrow" id="MathJax-Span-1989"><span class="mtext" id="MathJax-Span-1990" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-1991" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msubsup" id="MathJax-Span-1992" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.264em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.6em, 4.173em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-1993"><span class="mrow" id="MathJax-Span-1994"><span class="mtext" id="MathJax-Span-1995" style="font-family: MathJax_Main; font-weight: bold;">b</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.431em; left: 0.639em;"><span class="mi" id="MathJax-Span-1996" style="font-size: 70.7%; font-family: MathJax_Main;">⊤</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="msup" id="MathJax-Span-1997"><span style="display: inline-block; position: relative; width: 0.908em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.62em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-1998"><span class="mrow" id="MathJax-Span-1999"><span class="mtext" id="MathJax-Span-2000" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.431em; left: 0.639em;"><span class="mo" id="MathJax-Span-2001" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-2002" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1011.03em, 1.198em, -1000em); top: -1.262em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 11.029em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span><span class="mspace" id="MathJax-Span-2003" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-2004" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mtext" id="MathJax-Span-2005"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">分</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">子</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">分</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">母</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">同</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">时</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">约</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">去</span><span style="font-family: MathJax_Main; font-style: normal; font-weight: normal;">h</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">无</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">关</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">项</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(2.141em, 1020.62em, 5.38em, -1000em); top: -5.668em; left: 0em;"><span class="mtd" id="MathJax-Span-2008"><span class="mrow" id="MathJax-Span-2009"><span class="mi" id="MathJax-Span-2010"></span><span class="mspace" id="MathJax-Span-2011" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-2012" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-2013" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mfrac" id="MathJax-Span-2014" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 13.089em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.104em, 1010.2em, 4.66em, -1000em); top: -4.974em; left: 50%; margin-left: -5.15em;"><span class="mrow" id="MathJax-Span-2015"><span class="mi" id="MathJax-Span-2016" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-2017" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mi" id="MathJax-Span-2018" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-2019" style="font-family: MathJax_Main;">(</span><span class="munderover" id="MathJax-Span-2020"><span style="display: inline-block; position: relative; width: 1.797em; height: 0px;"><span style="position: absolute; clip: rect(3.104em, 1001em, 4.417em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-2021" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.725em; left: 1.056em;"><span class="texatom" id="MathJax-Span-2022"><span class="mrow" id="MathJax-Span-2023"><span class="msubsup" id="MathJax-Span-2024"><span style="display: inline-block; position: relative; width: 0.666em; height: 0px;"><span style="position: absolute; clip: rect(3.363em, 1000.39em, 4.174em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-2025"><span class="mrow" id="MathJax-Span-2026"><span class="mi" id="MathJax-Span-2027" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.904em; left: 0.407em;"><span class="mi" id="MathJax-Span-2028" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2029" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.942em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.56em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-2030"><span class="mrow" id="MathJax-Span-2031"><span class="mi" id="MathJax-Span-2032" style="font-family: MathJax_Math; font-style: italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.576em;"><span class="mi" id="MathJax-Span-2033" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2034"><span style="display: inline-block; position: relative; width: 1.507em; height: 0px;"><span style="position: absolute; clip: rect(3.171em, 1001.05em, 4.189em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2035" style="font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.944em;"><span class="texatom" id="MathJax-Span-2036"><span class="mrow" id="MathJax-Span-2037"><span class="mi" id="MathJax-Span-2038" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span class="mo" id="MathJax-Span-2039" style="font-size: 70.7%; font-family: MathJax_Main;">⋅</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2040"><span class="mrow" id="MathJax-Span-2041"><span class="mtext" id="MathJax-Span-2042" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-2043" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msubsup" id="MathJax-Span-2044" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.795em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.42em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2045" style="font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.429em;"><span class="mi" id="MathJax-Span-2046" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2047"><span style="display: inline-block; position: relative; width: 0.942em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.56em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-2048"><span class="mrow" id="MathJax-Span-2049"><span class="mi" id="MathJax-Span-2050" style="font-family: MathJax_Math; font-style: italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.576em;"><span class="mi" id="MathJax-Span-2051" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-2052" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.104em, 1012.87em, 4.66em, -1000em); top: -3.29em; left: 50%; margin-left: -6.485em;"><span class="mrow" id="MathJax-Span-2053"><span class="munderover" id="MathJax-Span-2054"><span style="display: inline-block; position: relative; width: 1.773em; height: 0px;"><span style="position: absolute; clip: rect(3.104em, 1001em, 4.417em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-2055" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.725em; left: 1.056em;"><span class="texatom" id="MathJax-Span-2056"><span class="mrow" id="MathJax-Span-2057"><span class="msup" id="MathJax-Span-2058"><span style="display: inline-block; position: relative; width: 0.642em; height: 0px;"><span style="position: absolute; clip: rect(3.363em, 1000.44em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-2059"><span class="mrow" id="MathJax-Span-2060"><span class="mtext" id="MathJax-Span-2061" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.308em; left: 0.452em;"><span class="mo" id="MathJax-Span-2062" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mi" id="MathJax-Span-2063" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">e</span><span class="mi" id="MathJax-Span-2064" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mi" id="MathJax-Span-2065" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-2066" style="font-family: MathJax_Main;">(</span><span class="munderover" id="MathJax-Span-2067"><span style="display: inline-block; position: relative; width: 1.988em; height: 0px;"><span style="position: absolute; clip: rect(3.104em, 1001em, 4.417em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-2068" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.725em; left: 1.056em;"><span class="texatom" id="MathJax-Span-2069"><span class="mrow" id="MathJax-Span-2070"><span class="msubsup" id="MathJax-Span-2071"><span style="display: inline-block; position: relative; width: 0.857em; height: 0px;"><span style="position: absolute; clip: rect(3.276em, 1000.6em, 4.174em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-2072"><span class="mrow" id="MathJax-Span-2073"><span class="msup" id="MathJax-Span-2074"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px;"><span style="position: absolute; clip: rect(3.363em, 1000.39em, 4.174em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2075" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.308em; left: 0.407em;"><span class="mo" id="MathJax-Span-2076" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.904em; left: 0.598em;"><span class="mi" id="MathJax-Span-2077" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2078" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.212em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.85em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-2079"><span class="mrow" id="MathJax-Span-2080"><span class="msup" id="MathJax-Span-2081"><span style="display: inline-block; position: relative; width: 0.845em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.56em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2082" style="font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.299em; left: 0.576em;"><span class="mo" id="MathJax-Span-2083" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.845em;"><span class="mi" id="MathJax-Span-2084" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2085"><span style="display: inline-block; position: relative; width: 1.507em; height: 0px;"><span style="position: absolute; clip: rect(3.171em, 1001.05em, 4.189em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2086" style="font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.944em;"><span class="texatom" id="MathJax-Span-2087"><span class="mrow" id="MathJax-Span-2088"><span class="mi" id="MathJax-Span-2089" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span class="mo" id="MathJax-Span-2090" style="font-size: 70.7%; font-family: MathJax_Main;">⋅</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2091"><span class="mrow" id="MathJax-Span-2092"><span class="mtext" id="MathJax-Span-2093" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-2094" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msubsup" id="MathJax-Span-2095" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.795em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.42em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2096" style="font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.429em;"><span class="mi" id="MathJax-Span-2097" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2098"><span style="display: inline-block; position: relative; width: 1.212em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.85em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-2099"><span class="mrow" id="MathJax-Span-2100"><span class="msup" id="MathJax-Span-2101"><span style="display: inline-block; position: relative; width: 0.845em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.56em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2102" style="font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.299em; left: 0.576em;"><span class="mo" id="MathJax-Span-2103" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.845em;"><span class="mi" id="MathJax-Span-2104" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-2105" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1013.09em, 1.198em, -1000em); top: -1.262em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 13.089em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span><span class="mspace" id="MathJax-Span-2106" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-2107" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="msubsup" id="MathJax-Span-2108"><span style="display: inline-block; position: relative; width: 1.507em; height: 0px;"><span style="position: absolute; clip: rect(3.171em, 1001.05em, 4.189em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2109" style="font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.944em;"><span class="texatom" id="MathJax-Span-2110"><span class="mrow" id="MathJax-Span-2111"><span class="mi" id="MathJax-Span-2112" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span class="mo" id="MathJax-Span-2113" style="font-size: 70.7%; font-family: MathJax_Main;">⋅</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mtext" id="MathJax-Span-2114"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">是</span><span style="font-family: MathJax_Main; font-style: normal; font-weight: normal;">W</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">的</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">第</span><span style="font-family: MathJax_Main; font-style: normal; font-weight: normal;">j</span><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 83%; font-style: normal; font-weight: normal;">行</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(2.204em, 1018.36em, 5.316em, -1000em); top: -2.504em; left: 0em;"><span class="mtd" id="MathJax-Span-2117"><span class="mrow" id="MathJax-Span-2118"><span class="mi" id="MathJax-Span-2119"></span><span class="mspace" id="MathJax-Span-2120" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-2121" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-2122" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mfrac" id="MathJax-Span-2123" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 16.231em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.104em, 1009.72em, 4.596em, -1000em); top: -4.91em; left: 50%; margin-left: -4.906em;"><span class="mrow" id="MathJax-Span-2124"><span class="munderover" id="MathJax-Span-2125"><span style="display: inline-block; position: relative; width: 1.31em; height: 0px;"><span style="position: absolute; clip: rect(3.104em, 1000.89em, 4.417em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-2126" style="font-family: MathJax_Size1; vertical-align: 0em;">∏</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.725em; left: 0.944em;"><span class="texatom" id="MathJax-Span-2127"><span class="mrow" id="MathJax-Span-2128"><span class="mi" id="MathJax-Span-2129" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mi" id="MathJax-Span-2130" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">e</span><span class="mi" id="MathJax-Span-2131" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mi" id="MathJax-Span-2132" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-2133" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2134"><span style="display: inline-block; position: relative; width: 0.942em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.56em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-2135"><span class="mrow" id="MathJax-Span-2136"><span class="mi" id="MathJax-Span-2137" style="font-family: MathJax_Math; font-style: italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.576em;"><span class="mi" id="MathJax-Span-2138" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2139"><span style="display: inline-block; position: relative; width: 1.507em; height: 0px;"><span style="position: absolute; clip: rect(3.171em, 1001.05em, 4.189em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2140" style="font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.944em;"><span class="texatom" id="MathJax-Span-2141"><span class="mrow" id="MathJax-Span-2142"><span class="mi" id="MathJax-Span-2143" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span class="mo" id="MathJax-Span-2144" style="font-size: 70.7%; font-family: MathJax_Main;">⋅</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2145"><span class="mrow" id="MathJax-Span-2146"><span class="mtext" id="MathJax-Span-2147" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-2148" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msubsup" id="MathJax-Span-2149" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.795em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.42em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2150" style="font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.429em;"><span class="mi" id="MathJax-Span-2151" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2152"><span style="display: inline-block; position: relative; width: 0.942em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.56em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-2153"><span class="mrow" id="MathJax-Span-2154"><span class="mi" id="MathJax-Span-2155" style="font-family: MathJax_Math; font-style: italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.576em;"><span class="mi" id="MathJax-Span-2156" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-2157" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.104em, 1016.02em, 4.596em, -1000em); top: -3.29em; left: 50%; margin-left: -8.055em;"><span class="mrow" id="MathJax-Span-2158"><span class="munderover" id="MathJax-Span-2159"><span style="display: inline-block; position: relative; width: 2.032em; height: 0px;"><span style="position: absolute; clip: rect(3.104em, 1001em, 4.417em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-2160" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.725em; left: 1.056em;"><span class="texatom" id="MathJax-Span-2161"><span class="mrow" id="MathJax-Span-2162"><span class="msubsup" id="MathJax-Span-2163"><span style="display: inline-block; position: relative; width: 0.901em; height: 0px;"><span style="position: absolute; clip: rect(3.276em, 1000.6em, 4.174em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-2164"><span class="mrow" id="MathJax-Span-2165"><span class="msup" id="MathJax-Span-2166"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px;"><span style="position: absolute; clip: rect(3.363em, 1000.39em, 4.174em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2167" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.308em; left: 0.407em;"><span class="mo" id="MathJax-Span-2168" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.904em; left: 0.598em;"><span class="mn" id="MathJax-Span-2169" style="font-size: 50%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-2170" style="font-family: MathJax_Main;">.</span><span class="mo" id="MathJax-Span-2171" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-2172" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="munderover" id="MathJax-Span-2173" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 2.226em; height: 0px;"><span style="position: absolute; clip: rect(3.104em, 1001em, 4.417em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-2174" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.725em; left: 1.056em;"><span class="texatom" id="MathJax-Span-2175"><span class="mrow" id="MathJax-Span-2176"><span class="msubsup" id="MathJax-Span-2177"><span style="display: inline-block; position: relative; width: 1.095em; height: 0px;"><span style="position: absolute; clip: rect(3.276em, 1000.6em, 4.174em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-2178"><span class="mrow" id="MathJax-Span-2179"><span class="msup" id="MathJax-Span-2180"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px;"><span style="position: absolute; clip: rect(3.363em, 1000.39em, 4.174em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2181" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.308em; left: 0.407em;"><span class="mo" id="MathJax-Span-2182" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.904em; left: 0.598em;"><span class="mi" id="MathJax-Span-2183" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.029em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="munderover" id="MathJax-Span-2184" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.31em; height: 0px;"><span style="position: absolute; clip: rect(3.104em, 1000.89em, 4.417em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-2185" style="font-family: MathJax_Size1; vertical-align: 0em;">∏</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.725em; left: 0.944em;"><span class="texatom" id="MathJax-Span-2186"><span class="mrow" id="MathJax-Span-2187"><span class="mi" id="MathJax-Span-2188" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mi" id="MathJax-Span-2189" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">e</span><span class="mi" id="MathJax-Span-2190" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mi" id="MathJax-Span-2191" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-2192" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2193"><span style="display: inline-block; position: relative; width: 1.212em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.85em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-2194"><span class="mrow" id="MathJax-Span-2195"><span class="msup" id="MathJax-Span-2196"><span style="display: inline-block; position: relative; width: 0.845em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.56em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2197" style="font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.299em; left: 0.576em;"><span class="mo" id="MathJax-Span-2198" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.845em;"><span class="mi" id="MathJax-Span-2199" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2200"><span style="display: inline-block; position: relative; width: 1.507em; height: 0px;"><span style="position: absolute; clip: rect(3.171em, 1001.05em, 4.189em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2201" style="font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.944em;"><span class="texatom" id="MathJax-Span-2202"><span class="mrow" id="MathJax-Span-2203"><span class="mi" id="MathJax-Span-2204" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span class="mo" id="MathJax-Span-2205" style="font-size: 70.7%; font-family: MathJax_Main;">⋅</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2206"><span class="mrow" id="MathJax-Span-2207"><span class="mtext" id="MathJax-Span-2208" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-2209" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msubsup" id="MathJax-Span-2210" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.795em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.42em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2211" style="font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.429em;"><span class="mi" id="MathJax-Span-2212" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2213"><span style="display: inline-block; position: relative; width: 1.212em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.85em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-2214"><span class="mrow" id="MathJax-Span-2215"><span class="msup" id="MathJax-Span-2216"><span style="display: inline-block; position: relative; width: 0.845em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.56em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2217" style="font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.299em; left: 0.576em;"><span class="mo" id="MathJax-Span-2218" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.845em;"><span class="mi" id="MathJax-Span-2219" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-2220" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1016.23em, 1.198em, -1000em); top: -1.262em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 16.231em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(2.204em, 1014.76em, 5.38em, -1000em); top: 0.595em; left: 0em;"><span class="mtd" id="MathJax-Span-2223"><span class="mrow" id="MathJax-Span-2224"><span class="mi" id="MathJax-Span-2225"></span><span class="mspace" id="MathJax-Span-2226" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-2227" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-2228" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mfrac" id="MathJax-Span-2229" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 12.626em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.104em, 1009.72em, 4.596em, -1000em); top: -4.91em; left: 50%; margin-left: -4.906em;"><span class="mrow" id="MathJax-Span-2230"><span class="munderover" id="MathJax-Span-2231"><span style="display: inline-block; position: relative; width: 1.31em; height: 0px;"><span style="position: absolute; clip: rect(3.104em, 1000.89em, 4.417em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-2232" style="font-family: MathJax_Size1; vertical-align: 0em;">∏</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.725em; left: 0.944em;"><span class="texatom" id="MathJax-Span-2233"><span class="mrow" id="MathJax-Span-2234"><span class="mi" id="MathJax-Span-2235" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mi" id="MathJax-Span-2236" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">e</span><span class="mi" id="MathJax-Span-2237" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mi" id="MathJax-Span-2238" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-2239" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2240"><span style="display: inline-block; position: relative; width: 0.942em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.56em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-2241"><span class="mrow" id="MathJax-Span-2242"><span class="mi" id="MathJax-Span-2243" style="font-family: MathJax_Math; font-style: italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.576em;"><span class="mi" id="MathJax-Span-2244" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2245"><span style="display: inline-block; position: relative; width: 1.507em; height: 0px;"><span style="position: absolute; clip: rect(3.171em, 1001.05em, 4.189em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2246" style="font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.944em;"><span class="texatom" id="MathJax-Span-2247"><span class="mrow" id="MathJax-Span-2248"><span class="mi" id="MathJax-Span-2249" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span class="mo" id="MathJax-Span-2250" style="font-size: 70.7%; font-family: MathJax_Main;">⋅</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2251"><span class="mrow" id="MathJax-Span-2252"><span class="mtext" id="MathJax-Span-2253" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-2254" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msubsup" id="MathJax-Span-2255" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.795em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.42em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2256" style="font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.429em;"><span class="mi" id="MathJax-Span-2257" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2258"><span style="display: inline-block; position: relative; width: 0.942em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.56em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-2259"><span class="mrow" id="MathJax-Span-2260"><span class="mi" id="MathJax-Span-2261" style="font-family: MathJax_Math; font-style: italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.576em;"><span class="mi" id="MathJax-Span-2262" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-2263" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.104em, 1012.41em, 4.66em, -1000em); top: -3.29em; left: 50%; margin-left: -6.253em;"><span class="mrow" id="MathJax-Span-2264"><span class="munderover" id="MathJax-Span-2265"><span style="display: inline-block; position: relative; width: 1.31em; height: 0px;"><span style="position: absolute; clip: rect(3.104em, 1000.89em, 4.417em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-2266" style="font-family: MathJax_Size1; vertical-align: 0em;">∏</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.725em; left: 0.944em;"><span class="texatom" id="MathJax-Span-2267"><span class="mrow" id="MathJax-Span-2268"><span class="mi" id="MathJax-Span-2269" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="munderover" id="MathJax-Span-2270" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.988em; height: 0px;"><span style="position: absolute; clip: rect(3.104em, 1001em, 4.417em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-2271" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.725em; left: 1.056em;"><span class="texatom" id="MathJax-Span-2272"><span class="mrow" id="MathJax-Span-2273"><span class="msubsup" id="MathJax-Span-2274"><span style="display: inline-block; position: relative; width: 0.857em; height: 0px;"><span style="position: absolute; clip: rect(3.276em, 1000.6em, 4.174em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-2275"><span class="mrow" id="MathJax-Span-2276"><span class="msup" id="MathJax-Span-2277"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px;"><span style="position: absolute; clip: rect(3.363em, 1000.39em, 4.174em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2278" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.308em; left: 0.407em;"><span class="mo" id="MathJax-Span-2279" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.904em; left: 0.598em;"><span class="mi" id="MathJax-Span-2280" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mi" id="MathJax-Span-2281" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">e</span><span class="mi" id="MathJax-Span-2282" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mi" id="MathJax-Span-2283" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-2284" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2285"><span style="display: inline-block; position: relative; width: 1.212em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.85em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-2286"><span class="mrow" id="MathJax-Span-2287"><span class="msup" id="MathJax-Span-2288"><span style="display: inline-block; position: relative; width: 0.845em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.56em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2289" style="font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.299em; left: 0.576em;"><span class="mo" id="MathJax-Span-2290" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.845em;"><span class="mi" id="MathJax-Span-2291" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2292"><span style="display: inline-block; position: relative; width: 1.507em; height: 0px;"><span style="position: absolute; clip: rect(3.171em, 1001.05em, 4.189em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2293" style="font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.944em;"><span class="texatom" id="MathJax-Span-2294"><span class="mrow" id="MathJax-Span-2295"><span class="mi" id="MathJax-Span-2296" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span class="mo" id="MathJax-Span-2297" style="font-size: 70.7%; font-family: MathJax_Main;">⋅</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2298"><span class="mrow" id="MathJax-Span-2299"><span class="mtext" id="MathJax-Span-2300" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-2301" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msubsup" id="MathJax-Span-2302" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.795em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.42em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2303" style="font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.429em;"><span class="mi" id="MathJax-Span-2304" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2305"><span style="display: inline-block; position: relative; width: 1.212em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.85em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-2306"><span class="mrow" id="MathJax-Span-2307"><span class="msup" id="MathJax-Span-2308"><span style="display: inline-block; position: relative; width: 0.845em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.56em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2309" style="font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.299em; left: 0.576em;"><span class="mo" id="MathJax-Span-2310" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.845em;"><span class="mi" id="MathJax-Span-2311" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-2312" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1012.63em, 1.198em, -1000em); top: -1.262em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 12.626em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(2.34em, 1014.72em, 5.495em, -1000em); top: 3.623em; left: 0em;"><span class="mtd" id="MathJax-Span-2315"><span class="mrow" id="MathJax-Span-2316"><span class="mi" id="MathJax-Span-2317"></span><span class="mspace" id="MathJax-Span-2318" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-2319" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-2320" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="munderover" id="MathJax-Span-2321" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.278em; height: 0px;"><span style="position: absolute; clip: rect(2.904em, 1001.22em, 4.617em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-2322" style="font-family: MathJax_Size2; vertical-align: 0em;">∏</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.387em, 1000.29em, 4.411em, -1000em); top: -2.926em; left: 0.493em;"><span class="texatom" id="MathJax-Span-2323"><span class="mrow" id="MathJax-Span-2324"><span class="mi" id="MathJax-Span-2325" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-2326" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 11.149em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.104em, 1008.24em, 4.461em, -1000em); top: -4.775em; left: 50%; margin-left: -4.167em;"><span class="mrow" id="MathJax-Span-2327"><span class="mi" id="MathJax-Span-2328" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-2329" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mi" id="MathJax-Span-2330" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-2331" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2332"><span style="display: inline-block; position: relative; width: 0.942em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.56em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-2333"><span class="mrow" id="MathJax-Span-2334"><span class="mi" id="MathJax-Span-2335" style="font-family: MathJax_Math; font-style: italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.576em;"><span class="mi" id="MathJax-Span-2336" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2337"><span style="display: inline-block; position: relative; width: 1.507em; height: 0px;"><span style="position: absolute; clip: rect(3.171em, 1001.05em, 4.189em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2338" style="font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.944em;"><span class="texatom" id="MathJax-Span-2339"><span class="mrow" id="MathJax-Span-2340"><span class="mi" id="MathJax-Span-2341" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span class="mo" id="MathJax-Span-2342" style="font-size: 70.7%; font-family: MathJax_Main;">⋅</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2343"><span class="mrow" id="MathJax-Span-2344"><span class="mtext" id="MathJax-Span-2345" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-2346" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msubsup" id="MathJax-Span-2347" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.795em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.42em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2348" style="font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.429em;"><span class="mi" id="MathJax-Span-2349" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2350"><span style="display: inline-block; position: relative; width: 0.942em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.56em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-2351"><span class="mrow" id="MathJax-Span-2352"><span class="mi" id="MathJax-Span-2353" style="font-family: MathJax_Math; font-style: italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.576em;"><span class="mi" id="MathJax-Span-2354" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-2355" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.104em, 1010.93em, 4.66em, -1000em); top: -3.29em; left: 50%; margin-left: -5.514em;"><span class="mrow" id="MathJax-Span-2356"><span class="munderover" id="MathJax-Span-2357"><span style="display: inline-block; position: relative; width: 1.988em; height: 0px;"><span style="position: absolute; clip: rect(3.104em, 1001em, 4.417em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-2358" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.725em; left: 1.056em;"><span class="texatom" id="MathJax-Span-2359"><span class="mrow" id="MathJax-Span-2360"><span class="msubsup" id="MathJax-Span-2361"><span style="display: inline-block; position: relative; width: 0.857em; height: 0px;"><span style="position: absolute; clip: rect(3.276em, 1000.6em, 4.174em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-2362"><span class="mrow" id="MathJax-Span-2363"><span class="msup" id="MathJax-Span-2364"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px;"><span style="position: absolute; clip: rect(3.363em, 1000.39em, 4.174em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2365" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.308em; left: 0.407em;"><span class="mo" id="MathJax-Span-2366" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.904em; left: 0.598em;"><span class="mi" id="MathJax-Span-2367" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mi" id="MathJax-Span-2368" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">e</span><span class="mi" id="MathJax-Span-2369" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mi" id="MathJax-Span-2370" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-2371" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2372"><span style="display: inline-block; position: relative; width: 1.212em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.85em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-2373"><span class="mrow" id="MathJax-Span-2374"><span class="msup" id="MathJax-Span-2375"><span style="display: inline-block; position: relative; width: 0.845em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.56em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2376" style="font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.299em; left: 0.576em;"><span class="mo" id="MathJax-Span-2377" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.845em;"><span class="mi" id="MathJax-Span-2378" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2379"><span style="display: inline-block; position: relative; width: 1.507em; height: 0px;"><span style="position: absolute; clip: rect(3.171em, 1001.05em, 4.189em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2380" style="font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.944em;"><span class="texatom" id="MathJax-Span-2381"><span class="mrow" id="MathJax-Span-2382"><span class="mi" id="MathJax-Span-2383" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span class="mo" id="MathJax-Span-2384" style="font-size: 70.7%; font-family: MathJax_Main;">⋅</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2385"><span class="mrow" id="MathJax-Span-2386"><span class="mtext" id="MathJax-Span-2387" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-2388" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msubsup" id="MathJax-Span-2389" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.795em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.42em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2390" style="font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.429em;"><span class="mi" id="MathJax-Span-2391" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2392"><span style="display: inline-block; position: relative; width: 1.212em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.85em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-2393"><span class="mrow" id="MathJax-Span-2394"><span class="msup" id="MathJax-Span-2395"><span style="display: inline-block; position: relative; width: 0.845em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.56em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2396" style="font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.299em; left: 0.576em;"><span class="mo" id="MathJax-Span-2397" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.845em;"><span class="mi" id="MathJax-Span-2398" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-2399" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1011.15em, 1.198em, -1000em); top: -1.262em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 11.149em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(2.904em, 1006.35em, 5.495em, -1000em); top: 6.202em; left: 0em;"><span class="mtd" id="MathJax-Span-2402"><span class="mrow" id="MathJax-Span-2403"><span class="mi" id="MathJax-Span-2404"></span><span class="mspace" id="MathJax-Span-2405" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-2406" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-2407" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="munderover" id="MathJax-Span-2408" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.278em; height: 0px;"><span style="position: absolute; clip: rect(2.904em, 1001.22em, 4.617em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-2409" style="font-family: MathJax_Size2; vertical-align: 0em;">∏</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.387em, 1000.29em, 4.411em, -1000em); top: -2.926em; left: 0.493em;"><span class="texatom" id="MathJax-Span-2410"><span class="mrow" id="MathJax-Span-2411"><span class="mi" id="MathJax-Span-2412" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mi" id="MathJax-Span-2413" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">p</span><span class="mo" id="MathJax-Span-2414" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2415"><span style="display: inline-block; position: relative; width: 0.942em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.56em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2416" style="font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.576em;"><span class="mi" id="MathJax-Span-2417" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2418"><span class="mrow" id="MathJax-Span-2419"><span class="mo" id="MathJax-Span-2420" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-2421"><span class="mrow" id="MathJax-Span-2422"><span class="mtext" id="MathJax-Span-2423" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-2424" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span><span style="display: inline-block; width: 0px; height: 24.583em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -13.911em; border-left: 0px solid; width: 0px; height: 28.422em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left" rowspacing="3pt" columnspacing="0em" displaystyle="true"><mtr><mtd></mtd><mtd><mi>P</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo stretchy="false">)</mo><mo>=</mo><mi>P</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><mo>′</mo></msup></mrow></munder><mi>P</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>,</mo><msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><mo>′</mo></msup><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mspace width="thickmathspace"></mspace><mspace width="thickmathspace"></mspace><mo>=</mo><mfrac><mrow><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="false">(</mo><msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><mi mathvariant="normal">⊤</mi></msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">W</mtext></mrow><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>+</mo><msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">c</mtext></mrow><mi mathvariant="normal">⊤</mi></msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>+</mo><msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">b</mtext></mrow><mi mathvariant="normal">⊤</mi></msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi>Z</mi></mrow><mrow><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><mo>′</mo></msup></mrow></munder><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="false">(</mo><msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><mrow><mo class="MJX-variant">′</mo><mi mathvariant="normal">⊤</mi></mrow></msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">W</mtext></mrow><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>+</mo><msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">c</mtext></mrow><mi mathvariant="normal">⊤</mi></msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>+</mo><msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">b</mtext></mrow><mi mathvariant="normal">⊤</mi></msup><msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><mo>′</mo></msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi>Z</mi></mrow></mfrac></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mspace width="thickmathspace"></mspace><mspace width="thickmathspace"></mspace><mo>=</mo><mfrac><mrow><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="false">(</mo><msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><mi mathvariant="normal">⊤</mi></msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">W</mtext></mrow><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>+</mo><msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">b</mtext></mrow><mi mathvariant="normal">⊤</mi></msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><mo stretchy="false">)</mo></mrow><mrow><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><mo>′</mo></msup></mrow></munder><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="false">(</mo><msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><mrow><mo class="MJX-variant">′</mo><mi mathvariant="normal">⊤</mi></mrow></msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">W</mtext></mrow><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>+</mo><msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">b</mtext></mrow><mi mathvariant="normal">⊤</mi></msup><msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><mo>′</mo></msup><mo stretchy="false">)</mo></mrow></mfrac><mspace width="thickmathspace"></mspace><mspace width="thickmathspace"></mspace><mtext>分子分母同时约去h无关项</mtext></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mspace width="thickmathspace"></mspace><mspace width="thickmathspace"></mspace><mo>=</mo><mfrac><mrow><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="false">(</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><msub><mrow class="MJX-TeXAtom-ORD"><mi>h</mi></mrow><mi>j</mi></msub></mrow></munder><msub><mrow class="MJX-TeXAtom-ORD"><mi>h</mi></mrow><mi>j</mi></msub><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>⋅</mo></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>+</mo><msub><mi>b</mi><mi>j</mi></msub><msub><mrow class="MJX-TeXAtom-ORD"><mi>h</mi></mrow><mi>j</mi></msub><mo stretchy="false">)</mo></mrow><mrow><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><msup><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><mo>′</mo></msup></mrow></munder><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="false">(</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><msub><mrow class="MJX-TeXAtom-ORD"><msup><mi>h</mi><mo>′</mo></msup></mrow><mi>j</mi></msub></mrow></munder><msub><mrow class="MJX-TeXAtom-ORD"><msup><mi>h</mi><mo>′</mo></msup></mrow><mi>j</mi></msub><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>⋅</mo></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>+</mo><msub><mi>b</mi><mi>j</mi></msub><msub><mrow class="MJX-TeXAtom-ORD"><msup><mi>h</mi><mo>′</mo></msup></mrow><mi>j</mi></msub><mo stretchy="false">)</mo></mrow></mfrac><mspace width="thickmathspace"></mspace><mspace width="thickmathspace"></mspace><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>⋅</mo></mrow></msub><mtext>是W的第j行</mtext></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mspace width="thickmathspace"></mspace><mspace width="thickmathspace"></mspace><mo>=</mo><mfrac><mrow><munder><mo>∏</mo><mrow class="MJX-TeXAtom-ORD"><mi>j</mi></mrow></munder><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="false">(</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi>h</mi></mrow><mi>j</mi></msub><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>⋅</mo></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>+</mo><msub><mi>b</mi><mi>j</mi></msub><msub><mrow class="MJX-TeXAtom-ORD"><mi>h</mi></mrow><mi>j</mi></msub><mo stretchy="false">)</mo></mrow><mrow><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><msub><mrow class="MJX-TeXAtom-ORD"><msup><mi>h</mi><mo>′</mo></msup></mrow><mn>1</mn></msub></mrow></munder><mo>.</mo><mo>.</mo><mo>.</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><msub><mrow class="MJX-TeXAtom-ORD"><msup><mi>h</mi><mo>′</mo></msup></mrow><mi>H</mi></msub></mrow></munder><munder><mo>∏</mo><mrow class="MJX-TeXAtom-ORD"><mi>j</mi></mrow></munder><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="false">(</mo><msub><mrow class="MJX-TeXAtom-ORD"><msup><mi>h</mi><mo>′</mo></msup></mrow><mi>j</mi></msub><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>⋅</mo></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>+</mo><msub><mi>b</mi><mi>j</mi></msub><msub><mrow class="MJX-TeXAtom-ORD"><msup><mi>h</mi><mo>′</mo></msup></mrow><mi>j</mi></msub><mo stretchy="false">)</mo></mrow></mfrac></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mspace width="thickmathspace"></mspace><mspace width="thickmathspace"></mspace><mo>=</mo><mfrac><mrow><munder><mo>∏</mo><mrow class="MJX-TeXAtom-ORD"><mi>j</mi></mrow></munder><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="false">(</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi>h</mi></mrow><mi>j</mi></msub><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>⋅</mo></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>+</mo><msub><mi>b</mi><mi>j</mi></msub><msub><mrow class="MJX-TeXAtom-ORD"><mi>h</mi></mrow><mi>j</mi></msub><mo stretchy="false">)</mo></mrow><mrow><munder><mo>∏</mo><mrow class="MJX-TeXAtom-ORD"><mi>j</mi></mrow></munder><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><msub><mrow class="MJX-TeXAtom-ORD"><msup><mi>h</mi><mo>′</mo></msup></mrow><mi>j</mi></msub></mrow></munder><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="false">(</mo><msub><mrow class="MJX-TeXAtom-ORD"><msup><mi>h</mi><mo>′</mo></msup></mrow><mi>j</mi></msub><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>⋅</mo></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>+</mo><msub><mi>b</mi><mi>j</mi></msub><msub><mrow class="MJX-TeXAtom-ORD"><msup><mi>h</mi><mo>′</mo></msup></mrow><mi>j</mi></msub><mo stretchy="false">)</mo></mrow></mfrac></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mspace width="thickmathspace"></mspace><mspace width="thickmathspace"></mspace><mo>=</mo><munder><mo>∏</mo><mrow class="MJX-TeXAtom-ORD"><mi>j</mi></mrow></munder><mfrac><mrow><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="false">(</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi>h</mi></mrow><mi>j</mi></msub><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>⋅</mo></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>+</mo><msub><mi>b</mi><mi>j</mi></msub><msub><mrow class="MJX-TeXAtom-ORD"><mi>h</mi></mrow><mi>j</mi></msub><mo stretchy="false">)</mo></mrow><mrow><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><msub><mrow class="MJX-TeXAtom-ORD"><msup><mi>h</mi><mo>′</mo></msup></mrow><mi>j</mi></msub></mrow></munder><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="false">(</mo><msub><mrow class="MJX-TeXAtom-ORD"><msup><mi>h</mi><mo>′</mo></msup></mrow><mi>j</mi></msub><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>⋅</mo></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>+</mo><msub><mi>b</mi><mi>j</mi></msub><msub><mrow class="MJX-TeXAtom-ORD"><msup><mi>h</mi><mo>′</mo></msup></mrow><mi>j</mi></msub><mo stretchy="false">)</mo></mrow></mfrac></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mspace width="thickmathspace"></mspace><mspace width="thickmathspace"></mspace><mo>=</mo><munder><mo>∏</mo><mrow class="MJX-TeXAtom-ORD"><mi>j</mi></mrow></munder><mi>p</mi><mo stretchy="false">(</mo><msub><mi>h</mi><mi>j</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo stretchy="false">)</mo></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-48">\begin{equation}
    \begin{split}
        &P(\textbf{h}| \textbf{x}) = P(\textbf{x}, \textbf{h})/\sum_{\textbf{h}'} P(\textbf{x}, \textbf{h}')\\
        &\;\;=\frac{exp(\textbf{h}^\top \textbf{W} \textbf{x} + \textbf{c}^\top \textbf{x} + \textbf{b}^\top \textbf{h})/Z}{\sum_{\textbf{h}'} exp(\textbf{h}'^\top \textbf{W} \textbf{x} + \textbf{c}^\top \textbf{x} + \textbf{b}^\top \textbf{h}')/Z}\\
        &\;\;=\frac{exp(\textbf{h}^\top \textbf{W} \textbf{x} + \textbf{b}^\top \textbf{h})}{\sum_{\textbf{h}'} exp(\textbf{h}'^\top \textbf{W} \textbf{x} + \textbf{b}^\top \textbf{h}')} \;\;\text{分子分母同时约去h无关项}\\
        &\;\;=\frac{exp(\sum_{{h}_j}{h}_j W_{j\cdot} \textbf{x} + b_j {h}_j)}{\sum_{\textbf{h}'} exp(\sum_{{h'}_j}{h'}_j W_{j\cdot} \textbf{x} + b_j {h'}_j)} \;\;W_{j\cdot}\text{是W的第j行}\\
        &\;\;=\frac{\prod_{j} exp({h}_j W_{j\cdot} \textbf{x} + b_j {h}_j)}{\sum_{{h'}_1}...\sum_{{h'}_H} \prod_{j} exp({h'}_j W_{j\cdot} \textbf{x} + b_j {h'}_j)} \\
        &\;\;=\frac{\prod_{j} exp({h}_j W_{j\cdot} \textbf{x} + b_j {h}_j)}{\prod_{j} \sum_{{h'}_j} exp({h'}_j W_{j\cdot} \textbf{x} + b_j {h'}_j)} \\
        &\;\;= \prod_{j} \frac{ exp({h}_j W_{j\cdot} \textbf{x} + b_j {h}_j)}{ \sum_{{h'}_j} exp({h'}_j W_{j\cdot} \textbf{x} + b_j {h'}_j)} \\
        &\;\;= \prod_{j}p(h_j|\textbf{x})\\
    \end{split}
\end{equation}</script><p></p>

<p>如果<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-49-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>h</mi><mi>j</mi></msub><mo>&amp;#x2208;</mo><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>}</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2425" style="width: 5.523em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.583em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.333em, 1004.52em, 2.69em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-2426"><span class="msubsup" id="MathJax-Span-2427"><span style="display: inline-block; position: relative; width: 0.942em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.56em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2428" style="font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.576em;"><span class="mi" id="MathJax-Span-2429" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-2430" style="font-family: MathJax_Main; padding-left: 0.278em;">∈</span><span class="mo" id="MathJax-Span-2431" style="font-family: MathJax_Main; padding-left: 0.278em;">{</span><span class="mn" id="MathJax-Span-2432" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-2433" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-2434" style="font-family: MathJax_Main; padding-left: 0.167em;">1</span><span class="mo" id="MathJax-Span-2435" style="font-family: MathJax_Main;">}</span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.416em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>h</mi><mi>j</mi></msub><mo>∈</mo><mo fence="false" stretchy="false">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo fence="false" stretchy="false">}</mo></math></span></span><script type="math/tex" id="MathJax-Element-49">h_j \in \{0,1\}</script>，可以得到： <br>
<span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"></div><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-50-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>h</mi><mi>j</mi></msub><mo>=</mo><mn>1</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mfrac><mrow><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>W</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi><mo>&amp;#x22C5;</mo></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>+</mo><msub><mi>b</mi><mi>j</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><mn>1</mn><mo>+</mo><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>W</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi><mo>&amp;#x22C5;</mo></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>+</mo><msub><mi>b</mi><mi>j</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac><mo>=</mo><mi>s</mi><mi>i</mi><mi>g</mi><mi>m</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>W</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi><mo>&amp;#x22C5;</mo></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo>+</mo><msub><mi>b</mi><mi>j</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2436" style="width: 27.919em; display: inline-block;"><span style="display: inline-block; position: relative; width: 23.229em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.621em, 1023.13em, 3.462em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-2437"><span class="mi" id="MathJax-Span-2438" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-2439" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2440"><span style="display: inline-block; position: relative; width: 0.942em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.56em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2441" style="font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.576em;"><span class="mi" id="MathJax-Span-2442" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-2443" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-2444" style="font-family: MathJax_Main; padding-left: 0.278em;">1</span><span class="texatom" id="MathJax-Span-2445"><span class="mrow" id="MathJax-Span-2446"><span class="mo" id="MathJax-Span-2447" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-2448"><span class="mrow" id="MathJax-Span-2449"><span class="mtext" id="MathJax-Span-2450" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-2451" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2452" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mfrac" id="MathJax-Span-2453" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 8.292em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.104em, 1006.36em, 4.461em, -1000em); top: -4.775em; left: 50%; margin-left: -3.225em;"><span class="mrow" id="MathJax-Span-2454"><span class="mi" id="MathJax-Span-2455" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-2456" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mi" id="MathJax-Span-2457" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-2458" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2459"><span style="display: inline-block; position: relative; width: 1.507em; height: 0px;"><span style="position: absolute; clip: rect(3.171em, 1001.05em, 4.189em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2460" style="font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.944em;"><span class="texatom" id="MathJax-Span-2461"><span class="mrow" id="MathJax-Span-2462"><span class="mi" id="MathJax-Span-2463" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span class="mo" id="MathJax-Span-2464" style="font-size: 70.7%; font-family: MathJax_Main;">⋅</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2465"><span class="mrow" id="MathJax-Span-2466"><span class="mtext" id="MathJax-Span-2467" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-2468" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msubsup" id="MathJax-Span-2469" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.795em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.42em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2470" style="font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.429em;"><span class="mi" id="MathJax-Span-2471" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-2472" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.104em, 1008.08em, 4.461em, -1000em); top: -3.29em; left: 50%; margin-left: -4.086em;"><span class="mrow" id="MathJax-Span-2473"><span class="mn" id="MathJax-Span-2474" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-2475" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-2476" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">e</span><span class="mi" id="MathJax-Span-2477" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mi" id="MathJax-Span-2478" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-2479" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2480"><span style="display: inline-block; position: relative; width: 1.507em; height: 0px;"><span style="position: absolute; clip: rect(3.171em, 1001.05em, 4.189em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2481" style="font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.944em;"><span class="texatom" id="MathJax-Span-2482"><span class="mrow" id="MathJax-Span-2483"><span class="mi" id="MathJax-Span-2484" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span class="mo" id="MathJax-Span-2485" style="font-size: 70.7%; font-family: MathJax_Main;">⋅</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2486"><span class="mrow" id="MathJax-Span-2487"><span class="mtext" id="MathJax-Span-2488" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-2489" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msubsup" id="MathJax-Span-2490" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.795em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.42em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2491" style="font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.429em;"><span class="mi" id="MathJax-Span-2492" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-2493" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1008.29em, 1.198em, -1000em); top: -1.262em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 8.292em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span><span class="mo" id="MathJax-Span-2494" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-2495" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">s</span><span class="mi" id="MathJax-Span-2496" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-2497" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-2498" style="font-family: MathJax_Math; font-style: italic;">m</span><span class="mo" id="MathJax-Span-2499" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2500"><span style="display: inline-block; position: relative; width: 1.507em; height: 0px;"><span style="position: absolute; clip: rect(3.171em, 1001.05em, 4.189em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2501" style="font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.944em;"><span class="texatom" id="MathJax-Span-2502"><span class="mrow" id="MathJax-Span-2503"><span class="mi" id="MathJax-Span-2504" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span class="mo" id="MathJax-Span-2505" style="font-size: 70.7%; font-family: MathJax_Main;">⋅</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2506"><span class="mrow" id="MathJax-Span-2507"><span class="mtext" id="MathJax-Span-2508" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-2509" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msubsup" id="MathJax-Span-2510" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.795em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.42em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2511" style="font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.429em;"><span class="mi" id="MathJax-Span-2512" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-2513" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.28em; border-left: 0px solid; width: 0px; height: 3.16em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>p</mi><mo stretchy="false">(</mo><msub><mi>h</mi><mi>j</mi></msub><mo>=</mo><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="false">(</mo><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>⋅</mo></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>+</mo><msub><mi>b</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow><mrow><mn>1</mn><mo>+</mo><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="false">(</mo><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>⋅</mo></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>+</mo><msub><mi>b</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow></mfrac><mo>=</mo><mi>s</mi><mi>i</mi><mi>g</mi><mi>m</mi><mo stretchy="false">(</mo><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>⋅</mo></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo>+</mo><msub><mi>b</mi><mi>j</mi></msub><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-50">\begin{equation}
    p(h_j = 1|\textbf{x}) = \frac{ exp( W_{j\cdot} \textbf{x} + b_j )}{ 1 + exp( W_{j\cdot} \textbf{x} + b_j)} = sigm(W_{j\cdot} \textbf{x} + b_j)
\end{equation}</script><p></p>



<p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"></div><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-51-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>h</mi><mi>j</mi></msub><mo>=</mo><mn>0</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mn>1</mn><mo>&amp;#x2212;</mo><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>h</mi><mi>j</mi></msub><mo>=</mo><mn>1</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2514" style="width: 15.523em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.917em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.385em, 1012.82em, 2.742em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-2515"><span class="mi" id="MathJax-Span-2516" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-2517" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2518"><span style="display: inline-block; position: relative; width: 0.942em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.56em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2519" style="font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.576em;"><span class="mi" id="MathJax-Span-2520" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-2521" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-2522" style="font-family: MathJax_Main; padding-left: 0.278em;">0</span><span class="texatom" id="MathJax-Span-2523"><span class="mrow" id="MathJax-Span-2524"><span class="mo" id="MathJax-Span-2525" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-2526"><span class="mrow" id="MathJax-Span-2527"><span class="mtext" id="MathJax-Span-2528" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-2529" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2530" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-2531" style="font-family: MathJax_Main; padding-left: 0.278em;">1</span><span class="mo" id="MathJax-Span-2532" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-2533" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">p</span><span class="mo" id="MathJax-Span-2534" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2535"><span style="display: inline-block; position: relative; width: 0.942em; height: 0px;"><span style="position: absolute; clip: rect(3.16em, 1000.56em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2536" style="font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.576em;"><span class="mi" id="MathJax-Span-2537" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-2538" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-2539" style="font-family: MathJax_Main; padding-left: 0.278em;">1</span><span class="texatom" id="MathJax-Span-2540"><span class="mrow" id="MathJax-Span-2541"><span class="mo" id="MathJax-Span-2542" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-2543"><span class="mrow" id="MathJax-Span-2544"><span class="mtext" id="MathJax-Span-2545" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-2546" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.416em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>p</mi><mo stretchy="false">(</mo><msub><mi>h</mi><mi>j</mi></msub><mo>=</mo><mn>0</mn><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn><mo>−</mo><mi>p</mi><mo stretchy="false">(</mo><msub><mi>h</mi><mi>j</mi></msub><mo>=</mo><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-51">\begin{equation}
    p(h_j = 0|\textbf{x}) = 1 - p(h_j = 1|\textbf{x})
\end{equation}</script><p></p>

<p>类似的： <br>
<span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"></div><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-52-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><munder><mo>&amp;#x220F;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi></mrow></munder><mfrac><mrow><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><msub><mi>W</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x22C5;</mo><mi>j</mi></mrow></msub><msub><mi>x</mi><mi>j</mi></msub><mo>+</mo><msub><mi>c</mi><mi>j</mi></msub><msub><mi>x</mi><mi>j</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>x</mi><mo>&amp;#x2032;</mo></msup></mrow><mi>j</mi></msub></mrow></munder><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><msub><mi>W</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x22C5;</mo><mi>j</mi></mrow></msub><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>x</mi><mo>&amp;#x2032;</mo></msup></mrow><mi>j</mi></msub><mo>+</mo><msub><mi>c</mi><mi>j</mi></msub><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>x</mi><mo>&amp;#x2032;</mo></msup></mrow><mi>j</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac><mo>=</mo><munder><mo>&amp;#x220F;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi></mrow></munder><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mi>j</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2547" style="width: 28.284em; display: inline-block;"><span style="display: inline-block; position: relative; width: 23.542em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.621em, 1023.45em, 3.776em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-2548"><span class="mi" id="MathJax-Span-2549" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span class="mo" id="MathJax-Span-2550" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-2551"><span class="mrow" id="MathJax-Span-2552"><span class="mtext" id="MathJax-Span-2553" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="texatom" id="MathJax-Span-2554"><span class="mrow" id="MathJax-Span-2555"><span class="mo" id="MathJax-Span-2556" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-2557"><span class="mrow" id="MathJax-Span-2558"><span class="mtext" id="MathJax-Span-2559" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span class="mo" id="MathJax-Span-2560" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2561" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="munderover" id="MathJax-Span-2562" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.278em; height: 0px;"><span style="position: absolute; clip: rect(2.904em, 1001.22em, 4.617em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-2563" style="font-family: MathJax_Size2; vertical-align: 0em;">∏</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.387em, 1000.29em, 4.411em, -1000em); top: -2.926em; left: 0.493em;"><span class="texatom" id="MathJax-Span-2564"><span class="mrow" id="MathJax-Span-2565"><span class="mi" id="MathJax-Span-2566" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-2567" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 11.563em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.104em, 1008.27em, 4.461em, -1000em); top: -4.775em; left: 50%; margin-left: -4.181em;"><span class="mrow" id="MathJax-Span-2568"><span class="mi" id="MathJax-Span-2569" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-2570" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mi" id="MathJax-Span-2571" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-2572" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-2573"><span class="mrow" id="MathJax-Span-2574"><span class="mtext" id="MathJax-Span-2575" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span class="msubsup" id="MathJax-Span-2576"><span style="display: inline-block; position: relative; width: 1.507em; height: 0px;"><span style="position: absolute; clip: rect(3.171em, 1001.05em, 4.189em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2577" style="font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.944em;"><span class="texatom" id="MathJax-Span-2578"><span class="mrow" id="MathJax-Span-2579"><span class="mo" id="MathJax-Span-2580" style="font-size: 70.7%; font-family: MathJax_Main;">⋅</span><span class="mi" id="MathJax-Span-2581" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2582"><span style="display: inline-block; position: relative; width: 0.938em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.52em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2583" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.572em;"><span class="mi" id="MathJax-Span-2584" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-2585" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msubsup" id="MathJax-Span-2586" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.799em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2587" style="font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.433em;"><span class="mi" id="MathJax-Span-2588" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2589"><span style="display: inline-block; position: relative; width: 0.938em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.52em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2590" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.572em;"><span class="mi" id="MathJax-Span-2591" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-2592" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.104em, 1011.35em, 4.66em, -1000em); top: -3.29em; left: 50%; margin-left: -5.721em;"><span class="mrow" id="MathJax-Span-2593"><span class="munderover" id="MathJax-Span-2594"><span style="display: inline-block; position: relative; width: 1.985em; height: 0px;"><span style="position: absolute; clip: rect(3.104em, 1001em, 4.417em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-2595" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.725em; left: 1.056em;"><span class="texatom" id="MathJax-Span-2596"><span class="mrow" id="MathJax-Span-2597"><span class="msubsup" id="MathJax-Span-2598"><span style="display: inline-block; position: relative; width: 0.854em; height: 0px;"><span style="position: absolute; clip: rect(3.37em, 1000.6em, 4.174em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-2599"><span class="mrow" id="MathJax-Span-2600"><span class="msup" id="MathJax-Span-2601"><span style="display: inline-block; position: relative; width: 0.595em; height: 0px;"><span style="position: absolute; clip: rect(3.542em, 1000.37em, 4.174em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2602" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.215em; left: 0.404em;"><span class="mo" id="MathJax-Span-2603" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.904em; left: 0.595em;"><span class="mi" id="MathJax-Span-2604" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mi" id="MathJax-Span-2605" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">e</span><span class="mi" id="MathJax-Span-2606" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mi" id="MathJax-Span-2607" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-2608" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-2609"><span class="mrow" id="MathJax-Span-2610"><span class="mtext" id="MathJax-Span-2611" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span class="msubsup" id="MathJax-Span-2612"><span style="display: inline-block; position: relative; width: 1.507em; height: 0px;"><span style="position: absolute; clip: rect(3.171em, 1001.05em, 4.189em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2613" style="font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.944em;"><span class="texatom" id="MathJax-Span-2614"><span class="mrow" id="MathJax-Span-2615"><span class="mo" id="MathJax-Span-2616" style="font-size: 70.7%; font-family: MathJax_Main;">⋅</span><span class="mi" id="MathJax-Span-2617" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2618"><span style="display: inline-block; position: relative; width: 1.208em; height: 0px;"><span style="position: absolute; clip: rect(3.169em, 1000.84em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-2619"><span class="mrow" id="MathJax-Span-2620"><span class="msup" id="MathJax-Span-2621"><span style="display: inline-block; position: relative; width: 0.841em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.52em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2622" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.299em; left: 0.572em;"><span class="mo" id="MathJax-Span-2623" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.841em;"><span class="mi" id="MathJax-Span-2624" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-2625" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msubsup" id="MathJax-Span-2626" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.799em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2627" style="font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.433em;"><span class="mi" id="MathJax-Span-2628" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2629"><span style="display: inline-block; position: relative; width: 1.208em; height: 0px;"><span style="position: absolute; clip: rect(3.169em, 1000.84em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-2630"><span class="mrow" id="MathJax-Span-2631"><span class="msup" id="MathJax-Span-2632"><span style="display: inline-block; position: relative; width: 0.841em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.52em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2633" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -4.299em; left: 0.572em;"><span class="mo" id="MathJax-Span-2634" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.841em;"><span class="mi" id="MathJax-Span-2635" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-2636" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2637" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1011.56em, 1.198em, -1000em); top: -1.262em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 11.563em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span><span class="mo" id="MathJax-Span-2638" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="munderover" id="MathJax-Span-2639" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.278em; height: 0px;"><span style="position: absolute; clip: rect(2.904em, 1001.22em, 4.617em, -1000em); top: -4.01em; left: 0em;"><span class="mo" id="MathJax-Span-2640" style="font-family: MathJax_Size2; vertical-align: 0em;">∏</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.387em, 1000.29em, 4.411em, -1000em); top: -2.926em; left: 0.493em;"><span class="texatom" id="MathJax-Span-2641"><span class="mrow" id="MathJax-Span-2642"><span class="mi" id="MathJax-Span-2643" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mi" id="MathJax-Span-2644" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">p</span><span class="mo" id="MathJax-Span-2645" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2646"><span style="display: inline-block; position: relative; width: 0.938em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.52em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2647" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.572em;"><span class="mi" id="MathJax-Span-2648" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2649"><span class="mrow" id="MathJax-Span-2650"><span class="mo" id="MathJax-Span-2651" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-2652"><span class="mrow" id="MathJax-Span-2653"><span class="mtext" id="MathJax-Span-2654" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span class="mo" id="MathJax-Span-2655" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.656em; border-left: 0px solid; width: 0px; height: 3.536em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>P</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><mo stretchy="false">)</mo><mo>=</mo><munder><mo>∏</mo><mrow class="MJX-TeXAtom-ORD"><mi>j</mi></mrow></munder><mfrac><mrow><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo>⋅</mo><mi>j</mi></mrow></msub><msub><mi>x</mi><mi>j</mi></msub><mo>+</mo><msub><mi>c</mi><mi>j</mi></msub><msub><mi>x</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow><mrow><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><msub><mrow class="MJX-TeXAtom-ORD"><msup><mi>x</mi><mo>′</mo></msup></mrow><mi>j</mi></msub></mrow></munder><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo>⋅</mo><mi>j</mi></mrow></msub><msub><mrow class="MJX-TeXAtom-ORD"><msup><mi>x</mi><mo>′</mo></msup></mrow><mi>j</mi></msub><mo>+</mo><msub><mi>c</mi><mi>j</mi></msub><msub><mrow class="MJX-TeXAtom-ORD"><msup><mi>x</mi><mo>′</mo></msup></mrow><mi>j</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mfrac><mo>=</mo><munder><mo>∏</mo><mrow class="MJX-TeXAtom-ORD"><mi>j</mi></mrow></munder><mi>p</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>j</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-52">\begin{equation}
        P(\textbf{x}| \textbf{h}) = \prod_{j} \frac{ exp(\textbf{h} W_{\cdot j} x_j + c_j x_j)}{ \sum_{{x'}_j} exp(\textbf{h} W_{\cdot j} {x'}_j + c_j {x'}_j))} = \prod_{j}p(x_j|\textbf{h})
\end{equation}</script><p></p>

<p>如果<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-53-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>x</mi><mi>j</mi></msub><mo>&amp;#x2208;</mo><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>}</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2656" style="width: 5.523em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.583em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.333em, 1004.52em, 2.69em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-2657"><span class="msubsup" id="MathJax-Span-2658"><span style="display: inline-block; position: relative; width: 0.938em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.52em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2659" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.572em;"><span class="mi" id="MathJax-Span-2660" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-2661" style="font-family: MathJax_Main; padding-left: 0.278em;">∈</span><span class="mo" id="MathJax-Span-2662" style="font-family: MathJax_Main; padding-left: 0.278em;">{</span><span class="mn" id="MathJax-Span-2663" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-2664" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-2665" style="font-family: MathJax_Main; padding-left: 0.167em;">1</span><span class="mo" id="MathJax-Span-2666" style="font-family: MathJax_Main;">}</span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.416em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>x</mi><mi>j</mi></msub><mo>∈</mo><mo fence="false" stretchy="false">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo fence="false" stretchy="false">}</mo></math></span></span><script type="math/tex" id="MathJax-Element-53">x_j \in \{0,1\}</script>，可以得到： <br>
<span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"></div><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-54-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mi>j</mi></msub><mo>=</mo><mn>1</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mfrac><mrow><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><msub><mi>W</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x22C5;</mo><mi>j</mi></mrow></msub><mo>+</mo><msub><mi>c</mi><mi>j</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><mn>1</mn><mo>+</mo><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><msub><mi>W</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x22C5;</mo><mi>j</mi></mrow></msub><mo>+</mo><msub><mi>c</mi><mi>j</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac><mo>=</mo><mi>s</mi><mi>i</mi><mi>g</mi><mi>m</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>h</mtext></mrow><msub><mi>W</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x22C5;</mo><mi>j</mi></mrow></msub><mo>+</mo><msub><mi>c</mi><mi>j</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2667" style="width: 28.44em; display: inline-block;"><span style="display: inline-block; position: relative; width: 23.698em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.621em, 1023.6em, 3.462em, -1000em); top: -2.292em; left: 0em;"><span class="mrow" id="MathJax-Span-2668"><span class="mi" id="MathJax-Span-2669" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-2670" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2671"><span style="display: inline-block; position: relative; width: 0.938em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.52em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2672" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.572em;"><span class="mi" id="MathJax-Span-2673" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-2674" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-2675" style="font-family: MathJax_Main; padding-left: 0.278em;">1</span><span class="texatom" id="MathJax-Span-2676"><span class="mrow" id="MathJax-Span-2677"><span class="mo" id="MathJax-Span-2678" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-2679"><span class="mrow" id="MathJax-Span-2680"><span class="mtext" id="MathJax-Span-2681" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span class="mo" id="MathJax-Span-2682" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2683" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mfrac" id="MathJax-Span-2684" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 8.717em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.104em, 1006.39em, 4.461em, -1000em); top: -4.775em; left: 50%; margin-left: -3.243em;"><span class="mrow" id="MathJax-Span-2685"><span class="mi" id="MathJax-Span-2686" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-2687" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mi" id="MathJax-Span-2688" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-2689" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-2690"><span class="mrow" id="MathJax-Span-2691"><span class="mtext" id="MathJax-Span-2692" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span class="msubsup" id="MathJax-Span-2693"><span style="display: inline-block; position: relative; width: 1.507em; height: 0px;"><span style="position: absolute; clip: rect(3.171em, 1001.05em, 4.189em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2694" style="font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.944em;"><span class="texatom" id="MathJax-Span-2695"><span class="mrow" id="MathJax-Span-2696"><span class="mo" id="MathJax-Span-2697" style="font-size: 70.7%; font-family: MathJax_Main;">⋅</span><span class="mi" id="MathJax-Span-2698" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-2699" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msubsup" id="MathJax-Span-2700" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.799em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2701" style="font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.433em;"><span class="mi" id="MathJax-Span-2702" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-2703" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(3.104em, 1008.5em, 4.461em, -1000em); top: -3.29em; left: 50%; margin-left: -4.299em;"><span class="mrow" id="MathJax-Span-2704"><span class="mn" id="MathJax-Span-2705" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-2706" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-2707" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">e</span><span class="mi" id="MathJax-Span-2708" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mi" id="MathJax-Span-2709" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-2710" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-2711"><span class="mrow" id="MathJax-Span-2712"><span class="mtext" id="MathJax-Span-2713" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span class="msubsup" id="MathJax-Span-2714"><span style="display: inline-block; position: relative; width: 1.507em; height: 0px;"><span style="position: absolute; clip: rect(3.171em, 1001.05em, 4.189em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2715" style="font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.944em;"><span class="texatom" id="MathJax-Span-2716"><span class="mrow" id="MathJax-Span-2717"><span class="mo" id="MathJax-Span-2718" style="font-size: 70.7%; font-family: MathJax_Main;">⋅</span><span class="mi" id="MathJax-Span-2719" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-2720" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msubsup" id="MathJax-Span-2721" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.799em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2722" style="font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.433em;"><span class="mi" id="MathJax-Span-2723" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-2724" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2725" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; clip: rect(0.82em, 1008.72em, 1.198em, -1000em); top: -1.262em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 8.717em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.042em;"></span></span></span></span><span class="mo" id="MathJax-Span-2726" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-2727" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">s</span><span class="mi" id="MathJax-Span-2728" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-2729" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-2730" style="font-family: MathJax_Math; font-style: italic;">m</span><span class="mo" id="MathJax-Span-2731" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-2732"><span class="mrow" id="MathJax-Span-2733"><span class="mtext" id="MathJax-Span-2734" style="font-family: MathJax_Main; font-weight: bold;">h</span></span></span><span class="msubsup" id="MathJax-Span-2735"><span style="display: inline-block; position: relative; width: 1.507em; height: 0px;"><span style="position: absolute; clip: rect(3.171em, 1001.05em, 4.189em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2736" style="font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.944em;"><span class="texatom" id="MathJax-Span-2737"><span class="mrow" id="MathJax-Span-2738"><span class="mo" id="MathJax-Span-2739" style="font-size: 70.7%; font-family: MathJax_Main;">⋅</span><span class="mi" id="MathJax-Span-2740" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-2741" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msubsup" id="MathJax-Span-2742" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.799em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.43em, 4.178em, -1000em); top: -4.01em; left: 0em;"><span class="mi" id="MathJax-Span-2743" style="font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.433em;"><span class="mi" id="MathJax-Span-2744" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-2745" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.292em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.28em; border-left: 0px solid; width: 0px; height: 3.16em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>p</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>j</mi></msub><mo>=</mo><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo>⋅</mo><mi>j</mi></mrow></msub><mo>+</mo><msub><mi>c</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow><mrow><mn>1</mn><mo>+</mo><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo>⋅</mo><mi>j</mi></mrow></msub><mo>+</mo><msub><mi>c</mi><mi>j</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mfrac><mo>=</mo><mi>s</mi><mi>i</mi><mi>g</mi><mi>m</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">h</mtext></mrow><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mo>⋅</mo><mi>j</mi></mrow></msub><mo>+</mo><msub><mi>c</mi><mi>j</mi></msub><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-54">\begin{equation}
        p(x_j = 1| \textbf{h}) = \frac{ exp(\textbf{h} W_{\cdot j} + c_j )}{ 1 + exp(\textbf{h} W_{\cdot j} + c_j))} = sigm(\textbf{h} W_{\cdot j} + c_j)
\end{equation}</script><p></p>



<h2 id="六contrastive-divergence"><a name="t8"></a><strong>六、Contrastive Divergence:</strong></h2>

<p>&nbsp;  &nbsp;  Contrastive Divergence可以加快RBMs的训练速度，<font size="4" color="#0022ff" face="黑体">随机选择一个<strong>训练样本</strong>初始化<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-55-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mn>1</mn></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2746" style="width: 1.103em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.048em; height: 0px; font-size: 106%;"><span style="position: absolute; clip: rect(1.6em, 1001.05em, 2.508em, -1000em); top: -2.201em; left: 0em;"><span class="mrow" id="MathJax-Span-2747"><span class="msubsup" id="MathJax-Span-2748"><span style="display: inline-block; position: relative; width: 1.036em; height: 0px;"><span style="position: absolute; clip: rect(3.382em, 1000.59em, 4.14em, -1000em); top: -3.983em; left: 0em;"><span class="texatom" id="MathJax-Span-2749"><span class="mrow" id="MathJax-Span-2750"><span class="mtext" id="MathJax-Span-2751" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 3.983em;"></span></span><span style="position: absolute; top: -3.833em; left: 0.607em;"><span class="mn" id="MathJax-Span-2752" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.983em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.201em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.215em; border-left: 0px solid; width: 0px; height: 0.741em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-55">\textbf{x}_1</script>，并且每一次迭代只用<strong>一个模型样本</strong>来估计negative log-likelihood gradient</font>，而不是等到MCMC采样收敛后求期望。</p>

<p>&nbsp;  &nbsp;  k-step Contrastive Divergence（CD-k）：MCMC采样k步<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-56-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mn>1</mn></msub><mo>,</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mn>2</mn></msub><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2753" style="width: 8.023em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.667em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.639em, 1006.67em, 2.604em, -1000em); top: -2.24em; left: 0em;"><span class="mrow" id="MathJax-Span-2754"><span class="msubsup" id="MathJax-Span-2755"><span style="display: inline-block; position: relative; width: 1.036em; height: 0px;"><span style="position: absolute; clip: rect(3.41em, 1000.59em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-2756"><span class="mrow" id="MathJax-Span-2757"><span class="mtext" id="MathJax-Span-2758" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.607em;"><span class="mn" id="MathJax-Span-2759" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-2760" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2761" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.036em; height: 0px;"><span style="position: absolute; clip: rect(3.41em, 1000.59em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-2762"><span class="mrow" id="MathJax-Span-2763"><span class="mtext" id="MathJax-Span-2764" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.607em;"><span class="mn" id="MathJax-Span-2765" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span><span class="mo" id="MathJax-Span-2766" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-2767" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-2768" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-2769" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-2770" style="font-family: MathJax_Main; padding-left: 0.167em;">,</span><span class="msubsup" id="MathJax-Span-2771" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.954em; height: 0px;"><span style="position: absolute; clip: rect(3.41em, 1000.59em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-2772"><span class="mrow" id="MathJax-Span-2773"><span class="mtext" id="MathJax-Span-2774" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.607em;"><span class="texatom" id="MathJax-Span-2775"><span class="mrow" id="MathJax-Span-2776"><span class="mi" id="MathJax-Span-2777" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span class="mo" id="MathJax-Span-2778" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2779" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.312em; border-left: 0px solid; width: 0px; height: 0.907em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mn>1</mn></msub><mo>,</mo><msub><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mn>2</mn></msub><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><msub><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-56">\textbf{x}_1,\textbf{x}_2,...,\textbf{x}_{k+1}</script>， 用 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-57-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2780" style="width: 2.398em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.979em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.587em, 1001.98em, 2.552em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-2781"><span class="msubsup" id="MathJax-Span-2782"><span style="display: inline-block; position: relative; width: 1.954em; height: 0px;"><span style="position: absolute; clip: rect(3.41em, 1000.59em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-2783"><span class="mrow" id="MathJax-Span-2784"><span class="mtext" id="MathJax-Span-2785" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.607em;"><span class="texatom" id="MathJax-Span-2786"><span class="mrow" id="MathJax-Span-2787"><span class="mi" id="MathJax-Span-2788" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span class="mo" id="MathJax-Span-2789" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2790" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.312em; border-left: 0px solid; width: 0px; height: 0.907em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-57">\textbf{x}_{k+1}</script> 估计negative log-likelihood gradient。当k=1时，就能得到比较好的近似（DBN等pre-training k取1就够用了），k增大可以得到更好的效果。Contrastive Divergence的一种理解是在训练样本<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-58-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mn>1</mn></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2791" style="width: 1.253em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.042em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.587em, 1001.04em, 2.494em, -1000em); top: -2.188em; left: 0em;"><span class="mrow" id="MathJax-Span-2792"><span class="msubsup" id="MathJax-Span-2793"><span style="display: inline-block; position: relative; width: 1.036em; height: 0px;"><span style="position: absolute; clip: rect(3.41em, 1000.59em, 4.167em, -1000em); top: -4.01em; left: 0em;"><span class="texatom" id="MathJax-Span-2794"><span class="mrow" id="MathJax-Span-2795"><span class="mtext" id="MathJax-Span-2796" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span><span style="position: absolute; top: -3.86em; left: 0.607em;"><span class="mn" id="MathJax-Span-2797" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.01em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.242em; border-left: 0px solid; width: 0px; height: 0.838em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-58">\textbf{x}_1</script> 附近的局部区域内估计negative log-likelihood gradient。</p>

<p>借用一下大神Bengio的文章”Learning Deep Architectures for AI”的算法描述： <br>
</p><center><img src="https://img-blog.csdn.net/20151207175956728" alt="这里写图片描述" title=""></center><p></p>



<h3 id="persistent-cd"><a name="t9"></a><strong>Persistent CD:</strong></h3>

<p>&nbsp;  &nbsp;  CD只在附近的局部区域取Negative Sample来估计negative log-likelihood gradient，很难取到其它极值区域的样本，Persistent CD可以在一定程度上解决这个问题。Persistent CD的思想很简单，它与CD的区别仅仅在与：<font size="4" color="#0022ff" face="黑体">用上一次迭代得到的 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-59-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2798" style="width: 2.047em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.939em; height: 0px; font-size: 106%;"><span style="position: absolute; clip: rect(1.6em, 1001.94em, 2.566em, -1000em); top: -2.201em; left: 0em;"><span class="mrow" id="MathJax-Span-2799"><span class="msubsup" id="MathJax-Span-2800"><span style="display: inline-block; position: relative; width: 1.954em; height: 0px;"><span style="position: absolute; clip: rect(3.382em, 1000.59em, 4.14em, -1000em); top: -3.983em; left: 0em;"><span class="texatom" id="MathJax-Span-2801"><span class="mrow" id="MathJax-Span-2802"><span class="mtext" id="MathJax-Span-2803" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 3.983em;"></span></span><span style="position: absolute; top: -3.833em; left: 0.607em;"><span class="texatom" id="MathJax-Span-2804"><span class="mrow" id="MathJax-Span-2805"><span class="mi" id="MathJax-Span-2806" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span class="mo" id="MathJax-Span-2807" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2808" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.983em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.201em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.276em; border-left: 0px solid; width: 0px; height: 0.802em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-59">\textbf{x}_{k+1}</script>（即Negative Sample）作为这次迭代的初始值来初始化<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-60-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>x</mtext></mrow><mn>1</mn></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2809" style="width: 1.103em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.048em; height: 0px; font-size: 106%;"><span style="position: absolute; clip: rect(1.6em, 1001.05em, 2.508em, -1000em); top: -2.201em; left: 0em;"><span class="mrow" id="MathJax-Span-2810"><span class="msubsup" id="MathJax-Span-2811"><span style="display: inline-block; position: relative; width: 1.036em; height: 0px;"><span style="position: absolute; clip: rect(3.382em, 1000.59em, 4.14em, -1000em); top: -3.983em; left: 0em;"><span class="texatom" id="MathJax-Span-2812"><span class="mrow" id="MathJax-Span-2813"><span class="mtext" id="MathJax-Span-2814" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 3.983em;"></span></span><span style="position: absolute; top: -3.833em; left: 0.607em;"><span class="mn" id="MathJax-Span-2815" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.983em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.201em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.215em; border-left: 0px solid; width: 0px; height: 0.741em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-60">\textbf{x}_1</script>。</font>PS：Persistent CD是2008年Tijmen发表在ICML上的文章。</p>



<h2 id="七参考资料"><a name="t10"></a><strong>七、参考资料：</strong></h2>

<p>[1].Youtube上Hugo Larochelle的视频讲解：<a href="https://www.youtube.com/user/hugolarochelle/videos" target="_blank">https://www.youtube.com/user/hugolarochelle/videos</a></p>

<p>[2].DeepLearning tutorial：<a href="http://deeplearning.net/tutorial/rbm.html" target="_blank">http://deeplearning.net/tutorial/rbm.html</a></p>

<p>[3].LSIA：<a href="http://www.iro.umontreal.ca/~lisa/twiki/bin/view.cgi/Public/DBNEquations" target="_blank">http://www.iro.umontreal.ca/~lisa/twiki/bin/view.cgi/Public/DBNEquations</a></p>

<p>[4].Yoshua Bengio：Learning Deep Architectures for AI</p>                </div>
                                              